(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[54],{"3c942398161a09cbb4d7":function(t,e,r){"use strict";r.r(e);var n=r("64328bb588b46459132d"),a=r("275976081ce1abf67779"),s=r("47abe75ff47c370e8091"),i=r("877a6e603323418b7008"),o=r("a032c788b45e976efa61"),c=r("9b73502a4fb17676c09d"),l=r("82a5b752ca799aba4856"),d=r("9d410805f339fb056b8f"),p=r("8a3684f41d44e5d9df56"),m=r("222b3f6c82513e602ebc"),u=r("da7bfc878b0cf66154c2"),f=r("b912ecc4473ae8a2ff0b"),b=r("44f64afe8913260e06f6"),_=r("67cd898f5a9495f1e843"),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.listAriaLabel=e.props.localizationProvider.translate(_.Qb.TRANSCRIPT_TAB_TRANSCRIPT_LIST_ARIA_LABEL),e.selectedEntryAriaLabel=e.props.localizationProvider.translate(_.Qb.TRANSCRIPT_TAB_TRANSCRIPT_ENTRY_SELECTED_ARIA_LABEL),e.renderTranscriptItem=function(t){var r,n,s=(null===(n=e.props.selectedTranscript)||void 0===n?void 0:n.transcriptId)===t.transcriptId,i=e.props.l10n.formatDateTime(t.createTime,c.a.LONG_DATE,!0),o=e.props.localizationProvider.translate(_.Qb.TRANSCRIPT_TAB_TRANSCRIPT_ENTRY_ARIA_LABEL,{entryName:i});return a.createElement(l.a,{role:"listitem","aria-label":o,key:t.transcriptId,onClick:e.onClick.bind(e,t),className:f((r={},r[u.transcriptSelectorButton]=!0,r[u.selected]=s,r))},i)},e}return Object(n.__extends)(e,t),e.prototype.render=function(){return a.createElement(d.a,{direction:p.a.vertical},a.createElement(m.a,{role:"list","aria-label":this.listAriaLabel,items:this.props.associatedTranscripts,onRenderCell:this.renderTranscriptItem}))},e.prototype.onClick=function(t){this.props.selectTranscript(t),this.props.ariaLiveContext.announce(this.selectedEntryAriaLabel)},e}(a.PureComponent),h=Object(i.a)(o.a,b.a)(g),T=r("5b2d459d9e82cf3bf3bf"),v=r("486d0f083e13728083f0"),A=r("80d2fe5fad76c7d24717"),y=r("e94b560e6109d4f05f0c"),N=r("aa82b29957b8abcd1e1b"),P=r("6c9e49e3e750a4db3cb3"),D=n.__assign;function E(t,e){for(var r=[],s=2;s<arguments.length;s++)r[s-2]=arguments[s];var i=t;return i.isSlot?0===a.Children.count(r)?i(e):(r=a.Children.toArray(r),i(Object(n.__assign)(Object(n.__assign)({},e),{children:r}))):a.createElement.apply(a,Object(n.__spreadArrays)([t,e],r))}function x(t,e){void 0===e&&(e={});var r=e.defaultProp,s=void 0===r?"children":r;return function(e,r,i,o,c){if(a.isValidElement(r))return r;var l=function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];for(var a={},s=[],i=0,o=r;i<o.length;i++){var c=o[i];s.push(c&&c.className),D(a,c)}return a.className=Object(y.a)([t,s],{rtl:Object(P.a)(e)}),a}(o,c,e,function(t,e){var r,n;return"string"==typeof e||"number"==typeof e||"boolean"==typeof e?((r={})[t]=e,n=r):n=e,n}(s,r));if(i){if(i.component){var d=i.component;return a.createElement(d,Object(n.__assign)({},l))}if(i.render)return i.render(l,t)}return a.createElement(t,Object(n.__assign)({},l))}}var w=Object(N.c)(function(t){return x(t)});function S(t,e){var r={},n=t,a=function(t){if(e.hasOwnProperty(t)){var a=function(r){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];if(a.length>0)throw new Error("Any module using getSlots must use withSlots. Please see withSlots javadoc for more info.");return function(t,e,r,n,a,s){return void 0!==t.create?t.create(e,r,n,a):w(t)(e,r,n,a,s)}(e[t],r,n[t],n.slots&&n.slots[t],n._defaultStyles&&n._defaultStyles[t],n.theme)};a.isSlot=!0,r[t]=a}};for(var s in e)a(s);return r}function C(t,e){void 0===e&&(e={});var r=e.factoryOptions,s=(void 0===r?{}:r).defaultProp,i=function(r){var s,i,o,c=(s=e.displayName,i=a.useContext(v.a),o=e.fields,A.a.getSettings(o||["theme","styles","tokens"],s,i.customizations)),l=e.state;l&&(r=Object(n.__assign)(Object(n.__assign)({},r),l(r)));var d=r.theme||c.theme,p=function t(e,r){var a=[];for(var s=2;s<arguments.length;s++)a[s-2]=arguments[s];var i={};for(var o=0,c=a;o<c.length;o++){var l=c[o];l&&(l="function"==typeof l?l(e,r):l,Array.isArray(l)&&(l=t.apply(void 0,Object(n.__spreadArrays)([e,r],l))),D(i,l))}return i}(r,d,e.tokens,c.tokens,r.tokens),m=function(t,e,r){for(var n=[],a=3;a<arguments.length;a++)n[a-3]=arguments[a];return T.G.apply(void 0,n.map(function(n){return"function"==typeof n?n(t,e,r):n}))}(r,d,p,e.styles,c.styles,r.styles),u=Object(n.__assign)(Object(n.__assign)({},r),{styles:m,tokens:p,_defaultStyles:m,theme:d});return t(u)};return i.displayName=e.displayName||t.name,s&&(i.create=x(i,{defaultProp:s})),D(i,e.statics),i}var O=r("cadf351e66a0d5bfc60e"),k=C(function(t){if(0===a.Children.count(t.children))return null;t.block,t.className;var e=t.as,r=void 0===e?"span":e,s=(t.variant,t.nowrap,Object(n.__rest)(t,["block","className","as","variant","nowrap"]));return E(S(t,{root:r}).root,Object(n.__assign)({},Object(O.j)(s,O.k)))},{displayName:"Text",styles:function(t,e){var r=t.as,n=t.className,a=t.block,s=t.nowrap,i=t.variant,o=e.fonts[i||"medium"];return{root:[e.fonts.medium,{display:a?"td"===r?"table-cell":"block":"inline",fontFamily:o.fontFamily,fontSize:o.fontSize,fontWeight:o.fontWeight,color:o.color,mozOsxFontSmoothing:o.MozOsxFontSmoothing,webkitFontSmoothing:o.WebkitFontSmoothing},s&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},n]}}}),I=r("e026eb6ba07db166b8ec"),L=r("a5b2c2b80d41b1456c8c"),B=r("f1b80114f5918facb76a"),R=r("25c44098a85de94290b4"),j=r("900ce68db50bddf8b8c9"),z=function(t,e){return e.spacing.hasOwnProperty(t)?e.spacing[t]:t},W=function(t){var e=parseFloat(t),r=isNaN(e)?0:e,n=isNaN(e)?"":e.toString();return{value:r,unit:t.substring(n.toString().length)||"px"}},Q=function(t,e){if(void 0===t||"number"==typeof t||""===t)return t;var r=t.split(" ");return r.length<2?z(t,e):r.reduce(function(t,r){return z(t,e)+" "+z(r,e)})},U={start:"flex-start",end:"flex-end"},F={root:"ms-Stack",inner:"ms-Stack-inner"},M={root:"ms-StackItem"},G={start:"flex-start",end:"flex-end"},V=C(function(t){var e=t.children;return a.Children.count(e)<1?null:E(S(t,{root:"div"}).root,null,e)},{displayName:"StackItem",styles:function(t,e,r){var n=t.grow,a=t.shrink,s=t.disableShrink,i=t.align,o=t.verticalFill,c=t.order,l=t.className,d=Object(T.P)(M,e);return{root:[e.fonts.medium,d.root,{margin:r.margin,height:o?"100%":"auto",width:"auto"},n&&{flexGrow:!0===n?1:n},(s||!n&&!a)&&{flexShrink:0},a&&!s&&{flexShrink:1},i&&{alignSelf:G[i]||i},c&&{order:c},l]}}});var H,K=C(function(t){var e=t.as,r=void 0===e?"div":e,s=t.disableShrink,i=t.wrap,o=Object(n.__rest)(t,["as","disableShrink","wrap"]);Object(j.a)("Stack",t,{gap:"tokens.childrenGap",maxHeight:"tokens.maxHeight",maxWidth:"tokens.maxWidth",padding:"tokens.padding"});var c=a.Children.map(t.children,function(t,e){if(!t)return null;if((i=t)&&"object"==typeof i&&i.type&&i.type.displayName===V.displayName){var r={shrink:!s};return a.cloneElement(t,Object(n.__assign)(Object(n.__assign)({},r),t.props))}var i;return t}),l=Object(O.j)(o,O.k),d=S(t,{root:r,inner:"div"});return E(d.root,Object(n.__assign)({},l),i?E(d.inner,null,c):c)},{displayName:"Stack",styles:function(t,e,r){var a,s,i,o,c,l,d,p=t.verticalFill,m=t.horizontal,u=t.reversed,f=t.grow,b=t.wrap,_=t.horizontalAlign,g=t.verticalAlign,h=t.disableShrink,v=t.className,A=Object(T.P)(F,e),y=r&&r.childrenGap?r.childrenGap:t.gap,N=r&&r.maxHeight?r.maxHeight:t.maxHeight,P=r&&r.maxWidth?r.maxWidth:t.maxWidth,D=r&&r.padding?r.padding:t.padding,E=function(t,e){if(void 0===t||""===t)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if("number"==typeof t)return{rowGap:{value:t,unit:"px"},columnGap:{value:t,unit:"px"}};var r=t.split(" ");if(r.length>2)return{rowGap:{value:0,unit:"px"},columnGap:{value:0,unit:"px"}};if(2===r.length)return{rowGap:W(z(r[0],e)),columnGap:W(z(r[1],e))};var n=W(z(t,e));return{rowGap:n,columnGap:n}}(y,e),x=E.rowGap,w=E.columnGap,S=""+-.5*w.value+w.unit,C=""+-.5*x.value+x.unit,O={textOverflow:"ellipsis"},k={"> *:not(.ms-StackItem)":{flexShrink:h?0:1}};return b?{root:[A.root,{flexWrap:"wrap",maxWidth:P,maxHeight:N,width:"auto",overflow:"visible",height:"100%"},_&&(a={},a[m?"justifyContent":"alignItems"]=U[_]||_,a),g&&(s={},s[m?"alignItems":"justifyContent"]=U[g]||g,s),v,{display:"flex"},m&&{height:p?"100%":"auto"}],inner:[A.inner,{display:"flex",flexWrap:"wrap",marginLeft:S,marginRight:S,marginTop:C,marginBottom:C,overflow:"visible",boxSizing:"border-box",padding:Q(D,e),width:0===w.value?"100%":"calc(100% + "+w.value+w.unit+")",maxWidth:"100vw",selectors:Object(n.__assign)({"> *":Object(n.__assign)({margin:""+.5*x.value+x.unit+" "+.5*w.value+w.unit},O)},k)},_&&(i={},i[m?"justifyContent":"alignItems"]=U[_]||_,i),g&&(o={},o[m?"alignItems":"justifyContent"]=U[g]||g,o),m&&{flexDirection:u?"row-reverse":"row",height:0===x.value?"100%":"calc(100% + "+x.value+x.unit+")",selectors:{"> *":{maxWidth:0===w.value?"100%":"calc(100% - "+w.value+w.unit+")"}}},!m&&{flexDirection:u?"column-reverse":"column",height:"calc(100% + "+x.value+x.unit+")",selectors:{"> *":{maxHeight:0===x.value?"100%":"calc(100% - "+x.value+x.unit+")"}}}]}:{root:[A.root,{display:"flex",flexDirection:m?u?"row-reverse":"row":u?"column-reverse":"column",flexWrap:"nowrap",width:"auto",height:p?"100%":"auto",maxWidth:P,maxHeight:N,padding:Q(D,e),boxSizing:"border-box",selectors:Object(n.__assign)((c={"> *":O},c[u?"> *:not(:last-child)":"> *:not(:first-child)"]=[m&&{marginLeft:""+w.value+w.unit},!m&&{marginTop:""+x.value+x.unit}],c),k)},f&&{flexGrow:!0===f?1:f},_&&(l={},l[m?"justifyContent":"alignItems"]=U[_]||_,l),g&&(d={},d[m?"alignItems":"justifyContent"]=U[g]||g,d),v]}},statics:{Item:V}}),q=r("adf6e81d5ecf9ea16532"),J=r("aeefbf4359e8464c5277"),Y=r("f67a6dabd9dd73397689"),X=r("2967cf8009428a9155fe");!function(t){t.None="None",t.Text="Text",t.CallStarted="CallStarted",t.CallEnded="CallEnded",t.TranscriptStarted="TranscriptStarted",t.TranscriptEnded="TranscriptStopped",t.ParticipantJoined="ParticipantJoined",t.ParticipantLeft="ParticipantLeft"}(H||(H={}));var Z,$=r("a4da794462f5c4005bac"),tt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timestampColumn={key:"timestamp",name:"timestamp",fieldName:"timestamp",className:u.transcriptTimestamp,minWidth:60,maxWidth:60,onRender:e.renderTimestamp.bind(e)},e.profilePictureColumn={key:"key",name:"profilePicture",minWidth:30,maxWidth:30,onRender:e.renderProfilePicture.bind(e)},e.mainColumn={key:"text",name:"text",fieldName:"text",className:u.transcriptMain,minWidth:800,maxWidth:800,isMultiline:!0,onRender:e.renderMain.bind(e)},e.styles=function(){return{root:{backgroundColor:"transparent",selectors:{".ms-DetailsRow":{backgroundColor:"transparent",borderBottom:"none"},".ms-DetailsRow:hover":{backgroundColor:"transparent"}}},focusZone:void 0,headerWrapper:void 0,contentWrapper:void 0}},e}return Object(n.__extends)(e,t),e.prototype.render=function(){var t=this.props.subject?this.props.localizationProvider.translate(_.Qb.TRANSCRIPT_TAB_TITLE,{subject:this.props.subject}):"";return a.createElement(d.a,{direction:p.a.vertical},a.createElement(k,{className:u.transcriptTitle,variant:"xLarge",nowrap:!0,block:!0},t),a.createElement(I.a,Object(n.__assign)({},Object(Y.b)(this.props.currentTheme)),a.createElement(L.a,{ariaLabelForGrid:t,columns:this.props.showAvatars?[this.profilePictureColumn,this.mainColumn]:[this.timestampColumn,this.mainColumn],items:this.props.loadedTranscript,layoutMode:B.e.fixedColumns,selectionMode:R.c.none,isHeaderVisible:!1,styles:this.styles})))},e.prototype.renderTimestamp=function(t){return t.showTimestampAndAvatar?a.createElement(k,null,t.timestamp):null},e.prototype.renderMain=function(t){if(this.props.showAvatars)return t.type===H.Text&&t.showTimestampAndAvatar?a.createElement(K,{disableShrink:!0},a.createElement(K,{horizontal:!0,disableShrink:!0},a.createElement(k,{className:u.transcriptName},t.speakerDisplayName),a.createElement(k,{className:u.transcriptTimestamp},t.timestamp)),a.createElement(k,{className:u.transcriptText},t.text)):a.createElement(k,{className:u.transcriptText},t.text);if(t.type===H.Text)return a.createElement(k,{className:u.transcriptText},t.text);var e=t.type===H.ParticipantJoined||t.type===H.ParticipantLeft?X.c:X.lb;return a.createElement(K,{horizontal:!0,disableShrink:!0},a.createElement(q.a,{iconName:e,className:u.transcriptTextIcon}),a.createElement(k,{className:u.transcriptText},t.text))},e.prototype.renderProfilePicture=function(t){if(t.type!==H.Text){var e=t.type===H.ParticipantJoined||t.type===H.ParticipantLeft?X.c:X.lb;return a.createElement(q.a,{iconName:e,className:u.transcriptIcon})}return t.showTimestampAndAvatar?a.createElement($.d,{mri:t.speakerId,principalName:t.email,displayName:t.speakerDisplayName,retainInCache:!0,className:u.transcriptProfilePicture}):null},e}(a.PureComponent),et=Object(i.a)(J.a)(tt);!function(t){t.Vtt="vtt",t.Docx="docx",t.Pdf="pdf"}(Z||(Z={}));var rt=r("c9e31b10bd07e1d676f4"),nt=r("eb359d7693dd06453be6"),at=r("56e93fab5efcffbf24fb"),st=r("53075d34f004a33b5f03"),it=r("c5b9285a31a202d8d4f5"),ot=r("c9764d34b3eb6a106977"),ct=r("709c166948243d934acd"),lt=r("b0e26fa7634e6889091e"),dt=r("8183bb1c55fccc7b597d"),pt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.deleteDialogTitle=e.props.localizationProvider.translate(_.Qb.TRANSCRIPT_TAB_DELETE_DIALOG_TITLE),e.cancelButtonLabel=e.props.localizationProvider.translate(_.Qb.TRANSCRIPT_TAB_CANCEL_BUTTON_LABEL),e.deleteButtonLabel=e.props.localizationProvider.translate(_.Qb.TRANSCRIPT_TAB_DELETE_BUTTON_LABEL),e}return Object(n.__extends)(e,t),e.prototype.render=function(){return a.createElement(I.a,Object(n.__assign)({},Object(Y.b)(this.props.currentTheme)),a.createElement(ot.a,{hidden:!this.props.showDialog,onDismiss:this.props.handleDialogClose,dialogContentProps:{type:ct.a.normal,title:this.deleteDialogTitle},modalProps:{styles:{main:{maxWidth:450}},isBlocking:!1}},a.createElement(lt.a,null,a.createElement(l.a,{onClick:this.props.handleDialogClose,text:this.cancelButtonLabel,autoFocus:!0,"data-tid":"transcript-tab-delete-dialog-cancel-button"}),a.createElement(dt.a,{onClick:this.props.handleDelete,disabled:this.props.disableDeleteButton,autoFocus:!0,text:this.deleteButtonLabel,"data-tid":"transcript-tab-delete-dialog-delete-button"}))))},e}(a.PureComponent),mt=Object(i.a)(J.a)(pt),ut=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.unavailableDialogTitle=e.props.localizationProvider.translate(_.Qb.TRANSCRIPT_TAB_UNAVAILABLE_DIALOG_TITLE),e.unavailableDialogSubtext=e.props.localizationProvider.translate(_.Qb.TRANSCRIPT_TAB_UNAVAILABLE_DIALOG_SUBTEXT),e.closeButtonLabel=e.props.localizationProvider.translate(_.Qb.TRANSCRIPT_TAB_CLOSE_BUTTON_LABEL),e}return Object(n.__extends)(e,t),e.prototype.render=function(){return a.createElement(I.a,Object(n.__assign)({},Object(Y.b)(this.props.currentTheme)),a.createElement(ot.a,{hidden:!this.props.showDialog,onDismiss:this.props.handleDialogClose,dialogContentProps:{type:ct.a.normal,title:this.unavailableDialogTitle,subText:this.unavailableDialogSubtext},modalProps:{styles:{main:{maxWidth:450}},isBlocking:!1}},a.createElement(lt.a,null,a.createElement(l.a,{onClick:this.props.handleDialogClose,text:this.closeButtonLabel,autoFocus:!0,"data-tid":"transcript-tab-unavailable-dialog-close-button"}))))},e}(a.PureComponent),ft=Object(i.a)(J.a)(ut),bt=function(t){function e(){var e,r=null!==t&&t.apply(this,arguments)||this;return r.buttonLabels=((e={})[_.Qb.TRANSCRIPT_DOWNLOAD_BUTTON_LABEL]=r.props.localizationProvider.translate(_.Qb.TRANSCRIPT_DOWNLOAD_BUTTON_LABEL),e[_.Qb.TRANSCRIPT_DOWNLOAD_DOCX_BUTTON_LABEL]=r.props.localizationProvider.translate(_.Qb.TRANSCRIPT_DOWNLOAD_DOCX_BUTTON_LABEL),e[_.Qb.TRANSCRIPT_DOWNLOAD_VTT_BUTTON_LABEL]=r.props.localizationProvider.translate(_.Qb.TRANSCRIPT_DOWNLOAD_VTT_BUTTON_LABEL),e[_.Qb.TRANSCRIPT_TAB_DELETE_BUTTON_LABEL]=r.props.localizationProvider.translate(_.Qb.TRANSCRIPT_TAB_DELETE_BUTTON_LABEL),e),r.state={showDeleteDialog:!1,showUnavailableDialog:!1,isDeleteButtonDisabled:!1},r.renderQuickActionBar=function(){return a.createElement(a.Fragment,null,r.state.selectedTranscript&&a.createElement("div",{className:u.transcriptQuickActionBar,role:"region"},a.createElement(st.a,{iconProps:{iconName:X.B,className:u.transcriptActionButtonIcon},menuProps:r.getDownloadMenuProps(),className:u.transcriptActionButton,"data-tid":"transcript-tab-download-button"},r.buttonLabels[_.Qb.TRANSCRIPT_DOWNLOAD_BUTTON_LABEL]),r.props.event.isOrganizer&&a.createElement(it.ActionButton,{onClick:r.deleteTranscript,disabled:r.state.isDeleteButtonDisabled,iconProps:{iconName:X.z,className:u.transcriptActionButtonIcon},className:u.transcriptActionButton,"data-tid":"transcript-tab-delete-button"},r.buttonLabels[_.Qb.TRANSCRIPT_TAB_DELETE_BUTTON_LABEL])))},r.renderDialogs=function(){return a.createElement(a.Fragment,null,a.createElement(mt,{showDialog:r.state.showDeleteDialog,disableDeleteButton:r.state.isDeleteButtonDisabled,localizationProvider:r.props.localizationProvider,handleDelete:r.handleDeleteDialogConfirm,handleDialogClose:r.handleDeleteDialogClose}),a.createElement(ft,{showDialog:r.state.showUnavailableDialog,localizationProvider:r.props.localizationProvider,handleDialogClose:r.handleUnavailableDialogClose}))},r.getDownloadMenuProps=function(){return{items:[{key:"downloadDocx",text:r.buttonLabels[_.Qb.TRANSCRIPT_DOWNLOAD_DOCX_BUTTON_LABEL],iconProps:{iconName:"WordDocument"},data:Z.Docx,onClick:r.downloadTranscript,"data-tid":"transcript-tab-download-docx-button"},{key:"downloadVtt",text:r.buttonLabels[_.Qb.TRANSCRIPT_DOWNLOAD_VTT_BUTTON_LABEL],iconProps:{iconName:"TextDocument"},data:Z.Vtt,onClick:r.downloadTranscript,"data-tid":"transcript-tab-download-vtt-button"}]}},r.selectTranscript=function(t){r.setState({selectedTranscript:t,loadedTranscript:void 0}),r.loadTranscript(t.transcriptUrl)},r.downloadTranscript=function(t,e){var n;if((null==e?void 0:e.data)&&(null===(n=r.state.selectedTranscript)||void 0===n?void 0:n.transcriptUrl)){var a=e.data;r.props.transcriptProvider.downloadTranscript(r.state.selectedTranscript.transcriptUrl,a).then(function(){}).catch(function(t){r.setState({error:t})})}},r.deleteTranscript=function(){var t;(null===(t=r.state.selectedTranscript)||void 0===t?void 0:t.transcriptUrl)&&r.setState({showDeleteDialog:!0})},r.handleDeleteDialogConfirm=function(){var t;(null===(t=r.state.selectedTranscript)||void 0===t?void 0:t.transcriptUrl)?(r.setState({isDeleteButtonDisabled:!0}),r.props.transcriptProvider.deleteTranscript(r.state.selectedTranscript.transcriptUrl).then(function(){r.setState({associatedTranscripts:void 0,selectedTranscript:void 0,loadedTranscript:void 0,showDeleteDialog:!1,isDeleteButtonDisabled:!1}),r.loadAssociatedTranscripts()}).catch(function(t){r.setState({showDeleteDialog:!1,isDeleteButtonDisabled:!1,error:t})})):r.setState({showDeleteDialog:!1})},r.handleDeleteDialogClose=function(){r.setState({showDeleteDialog:!1})},r.handleUnavailableDialogClose=function(){r.setState({associatedTranscripts:void 0,selectedTranscript:void 0,loadedTranscript:void 0,showUnavailableDialog:!1}),r.loadAssociatedTranscripts()},r}return Object(n.__extends)(e,t),e.prototype.componentDidMount=function(){var t=this.props.transcriptProvider.getDeepLinkedTranscript();t&&this.selectTranscript(t),this.loadAssociatedTranscripts()},e.prototype.componentDidUpdate=function(){this.loadAssociatedTranscripts()},e.prototype.render=function(){var t=this,e=this.state,r=e.associatedTranscripts,i=e.loadedTranscript,o=e.showAvatars,c=e.selectedTranscript;return a.createElement("div",{className:u.transcriptPage},this.renderQuickActionBar(),a.createElement("div",{className:u.transcriptMainContainer},r&&r.length>1&&a.createElement("div",{className:u.transcriptSelectorContainer},a.createElement(h,{selectTranscript:this.selectTranscript,selectedTranscript:c,associatedTranscripts:Object(n.__spreadArrays)(r),localizationProvider:this.props.localizationProvider})),a.createElement("div",{className:u.transcriptRendererContainer},i?a.createElement(nt.a,{category:at.a.Default},function(e){var r=e.enableCallTranscriptPostMeetingSpeakerAttribution;return a.createElement(et,{loadedTranscript:i,showAvatars:!!r&&!!o,subject:t.props.event.subject,localizationProvider:t.props.localizationProvider})}):a.createElement(s.a,{size:"large"}))),this.renderDialogs())},e.prototype.loadAssociatedTranscripts=function(){var t=this;!this.state.associatedTranscripts&&this.props.event&&this.props.event.skypeTeamsDataObj&&this.props.event.skypeTeamsDataObj.cid&&(this.setState({associatedTranscripts:[]}),this.props.transcriptProvider.getAssociatedTranscripts(this.props.event.skypeTeamsDataObj.cid,this.props.event.skypeTeamsDataObj.mid).then(function(e){if(t.setState({associatedTranscripts:e||[]}),!t.state.selectedTranscript&&e&&e.length>0){var r=e[0];t.selectTranscript(r)}}).catch(function(e){t.setState({associatedTranscripts:[],error:e,showUnavailableDialog:!0})}))},e.prototype.getTranscriptEventType=function(t){return t===H.CallStarted||t===H.CallEnded?H.None:t},e.prototype.convertTranscriptEvent=function(t){return{type:this.getTranscriptEventType(t.eventType),key:t.eventId,timestamp:t.timestamp,text:"",showTimestampAndAvatar:!0,speakerId:t.userId,isOldMri:t.isOldMri}},e.prototype.convertTranscriptEntry=function(t){return{type:H.Text,key:t.entryId,timestamp:t.startTime,text:t.text,showTimestampAndAvatar:!0,speakerId:t.speakerId,isOldMri:t.isOldMri}},e.prototype.mergeTranscriptEntriesAndEvents=function(t){for(var e=t.data.entries,r=t.data.events,n=[],a=0,s=0;a<e.length&&s<r.length;)if(e[a].startTime>r[s].timestamp){var i=this.convertTranscriptEvent(r[s++]);i.type!==H.None&&n.push(i)}else n.push(this.convertTranscriptEntry(e[a++]));for(;s<r.length;){var o=this.convertTranscriptEvent(r[s++]);o.type!==H.None&&n.push(o)}for(;a<e.length;)n.push(this.convertTranscriptEntry(e[a++]));return n},e.prototype.getEventText=function(t,e){var r=this.props.localizationProvider,n="";switch(t.type){case H.TranscriptStarted:n=r.translate(_.Qb.TRANSCRIPT_STARTED,{name:e});break;case H.TranscriptEnded:n=r.translate(_.Qb.TRANSCRIPT_STOPPED,{name:e});break;case H.ParticipantJoined:n=r.translate(_.Qb.TRANSCRIPT_PARTICIPANT_JOINED,{name:e});break;case H.ParticipantLeft:n=r.translate(_.Qb.TRANSCRIPT_PARTICIPANT_LEFT,{name:e})}return n},e.prototype.resolveUser=function(t){var e=this;if(!t.speakerId)return Promise.resolve([]);var r=t.speakerId.split("@");if(r.length>1){t.speakerId=t.isOldMri?"8:orgid:"+r[1].replace(/-/g,"")+"_"+r[0].replace(/-/g,""):"8:orgid:"+r[0]}return this.props.peopleProvider.getAllPeopleProfile([t.speakerId]).then(function(r){return r&&r.length>0&&(t.email=Object(rt.a)(r[0].userPrincipalName||"")?r[0].userPrincipalName:r[0].email,t.speakerDisplayName=r[0].displayName,t.type!==H.Text&&(t.text=e.getEventText(t,t.speakerDisplayName||""))),r})},e.prototype.loadTranscript=function(t){var e=this;this.props.transcriptProvider.getTranscript(t).then(function(t){if(t&&t.data){var r=e.mergeTranscriptEntriesAndEvents(t),n=!1,a="-1",s="-1",i=r.length;r.forEach(function(t){t.type===H.Text&&t.speakerId&&(n=!0),t.timestamp=e.props.l10n.formatDateTime(t.timestamp,c.a.SHORT_TIME,!1),t.speakerId?s===t.speakerId?t.showTimestampAndAvatar=!1:s=t.speakerId:t.timestamp===a?t.showTimestampAndAvatar=!1:a=t.timestamp,e.resolveUser(t).then(function(){0==--i&&e.setState({loadedTranscript:r,showAvatars:n})}).catch(function(t){e.setState({error:t})})})}}).catch(function(t){e.setState({error:t,showUnavailableDialog:!0})})},e}(a.Component);r.d(e,"default",function(){return bt})},da7bfc878b0cf66154c2:function(t,e,r){var n=r("f179c3f94d6558690407");"string"==typeof n&&(n=[[t.i,n,""]]);var a={hmr:!0,transform:void 0};r("1e4534d1d62a11482e97")(n,a);n.locals&&(t.exports=n.locals)},f179c3f94d6558690407:function(t,e,r){(e=t.exports=r("c138e55a31f3f8960e99")(!1)).push([t.i,"/**\n * Common styles for all calendar components\n * TODO :  This is not an ideal placement for this file. This will go away when fela comes in.\n**/\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/*Font weight constants*/\n/* IF YOU CHANGE THESE PLEASE ALSO CHANGE IN models-calendar/src/constants*/\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/**\n * IMPORTANT: - Following colors are independent of colors defined in variables.scss.\n * Do not change color code for any of following color codes.\n * Please talk to calendar team if you have any doubts.\n */\n/*Font weight constants*/\n/* IF YOU CHANGE THESE PLEASE ALSO CHANGE IN models-calendar/src/constants*/\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptPage--3n2QI {\n  display: flex;\n  flex: 1 1 auto;\n  flex-direction: column;\n  height: 100%; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptQuickActionBar--237V6 {\n  padding-left: 2.3rem;\n  border-bottom: 1px solid rgba(37, 36, 36, 0.15); }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptActionButtonIcon--26WR8 {\n  margin-bottom: 1.5rem;\n  margin-right: -0.5rem; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptMainContainer--22koR {\n  display: flex;\n  flex: 1;\n  overflow: auto; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorContainer--1LfNQ {\n  width: 20rem;\n  padding: 1rem;\n  border-right: 1px solid rgba(37, 36, 36, 0.15); }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptRendererContainer--1pEVP {\n  padding: 1rem;\n  overflow: auto;\n  margin-bottom: 6rem; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8 {\n  border: none;\n  box-shadow: none;\n  width: 100%;\n  background-color: transparent;\n  text-align: left; }\n  .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__selected--DsD5K {\n    background-color: #6264a7;\n    color: white; }\n  .ms-Fabric--isFocusVisible .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8:focus {\n    outline: 0.1rem solid rgba(37, 36, 36, 0.5); }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTitle--4htik {\n  font-weight: bold;\n  padding: 1rem;\n  text-align: left;\n  font-size: 18px;\n  line-height: 24px;\n  letter-spacing: normal; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTimestamp--1dqYz,\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptName--TR0gK {\n  font-weight: normal;\n  font-size: 12px;\n  line-height: 19px;\n  text-align: left;\n  letter-spacing: normal; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTimestamp--1dqYz {\n  color: rgba(37, 36, 36, 0.65); }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptName--TR0gK {\n  margin-right: 1.5rem;\n  color: rgba(37, 36, 36, 0.75); }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptText--3iWI0 {\n  color: #252424; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptProfilePicture--2-QL1 {\n  width: 2.8rem;\n  height: 2.8rem;\n  margin-top: 0.3rem;\n  border-radius: 50%; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptIcon--1W6iw {\n  margin-top: -6px; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTextIcon--1h0km {\n  margin-top: -6px;\n  margin-left: -9px; }\n\n.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptMain--1V7ty {\n  padding-bottom: 0;\n  padding-left: 0.5rem; }\n\n.dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorContainer--1LfNQ {\n  border-right-color: rgba(255, 255, 255, 0.15); }\n\n.dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptQuickActionBar--237V6 {\n  border-bottom-color: rgba(255, 255, 255, 0.15); }\n\n.ms-Fabric--isFocusVisible .dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8:focus {\n  outline: 0.1rem solid rgba(255, 255, 255, 0.5); }\n\n.dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTimestamp--1dqYz {\n  color: rgba(255, 255, 255, 0.5); }\n\n.dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptName--TR0gK {\n  color: rgba(255, 255, 255, 0.75); }\n\n.dark .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptText--3iWI0 {\n  color: #fff; }\n\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTimestamp--1dqYz,\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptName--TR0gK,\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptText--3iWI0 {\n  color: #fff; }\n\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorContainer--1LfNQ {\n  border-right-color: #fff; }\n\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptQuickActionBar--237V6 {\n  border-bottom-color: #fff; }\n\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptActionButton--2JXbU {\n  color: #ffff00; }\n  .contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptActionButton--2JXbU:hover {\n    color: #00ebff; }\n\n.contrast .node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8.node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__selected--DsD5K {\n  background-color: #00ebff;\n  color: #201f1f; }\n",""]),e.locals={transcriptPage:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptPage--3n2QI",transcriptQuickActionBar:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptQuickActionBar--237V6",transcriptActionButtonIcon:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptActionButtonIcon--26WR8",transcriptMainContainer:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptMainContainer--22koR",transcriptSelectorContainer:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorContainer--1LfNQ",transcriptRendererContainer:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptRendererContainer--1pEVP",transcriptSelectorButton:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptSelectorButton--1Kqe8",selected:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__selected--DsD5K",transcriptTitle:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTitle--4htik",transcriptTimestamp:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTimestamp--1dqYz",transcriptName:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptName--TR0gK",transcriptText:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptText--3iWI0",transcriptProfilePicture:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptProfilePicture--2-QL1",transcriptIcon:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptIcon--1W6iw",transcriptTextIcon:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptTextIcon--1h0km",transcriptMain:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptMain--1V7ty",transcriptActionButton:"node_modules--msteams-bridges-components-transcript-dist-es-src-transcript__transcriptActionButton--2JXbU"}}}]);
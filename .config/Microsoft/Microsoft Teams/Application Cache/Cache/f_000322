function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}(this.webpackJsonp=this.webpackJsonp||[]).push([[4],{"DW+Q":function DWQ(e,t,n){"use strict";var r,i,a,o,s,c,l,u,d,p,g,m,h,f,v,b,y,S,C,O,_,T,M,A,w,I,P,j,D,E,N,k,R,U,L,F,B,G,x,H,V,z,W,q,Q,J,K,X,$,Z,Y,ee,te,ne,re,ie,ae,oe,se,ce,le,ue,de,pe,ge,me,he,fe,ve,be,ye,Se,Ce,Oe,_e,Te,Me,Ae,we,Ie,Pe,je,De,Ee,Ne,ke,Re,Ue,Le,Fe,Be,Ge,xe,He,Ve,ze,We,qe,Qe,Je,Ke,Xe,$e,Ze,Ye,et,tt,nt,rt,it,at,ot,st,ct,lt,ut,dt,pt,gt,mt,ht,ft,vt,bt,yt,St,Ct,Ot,_t,Tt,Mt,At,wt,It,Pt,jt,Dt,Et,Nt,kt,Rt,Ut,Lt,Ft,Bt,Gt,xt,Ht,Vt,zt,Wt,qt,Qt,Jt,Kt,Xt,$t,Zt,Yt,en,tn,nn,rn,an,on,sn,cn,ln,un,dn,pn,gn,mn,hn,fn,vn,bn,yn,Sn,Cn,On,_n,Tn,Mn,An,wn,In,Pn,jn,Dn,En,Nn,kn;n.d(t,"a",function(){return zt;}),function(e){e.Standard="Standard",e.Private="Private",e.Shared="Shared";}(r||(r={})),function(e){e.None="None",e.MutedTeamMember="MutedTeamMember",e.OnlyOwnersCanPost="OnlyOwnersCanPost";}(i||(i={})),function(e){e.Room="Room",e.Building="Building";}(a||(a={})),function(e){e.private="private",e.online="online",e.event="event",e.inPerson="inPerson",e.channel="channel",e.broadcast="broadcast";}(o||(o={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.BrowsingPrivately="BrowsingPrivately",e.Presenting="Presenting";}(s||(s={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.Presenting="Presenting";}(c||(c={})),function(e){e.Done="Done",e.InProcess="InProcess",e.UnknownError="UnknownError",e.ScoreTooLow="ScoreTooLow",e.TooManyCharacters="TooManyCharacters",e.NotStarted="NotStarted";}(l||(l={})),function(e){e.Standard="Standard",e.Important="Important",e.Urgent="Urgent";}(u||(u={})),function(e){e.Sent="Sent",e.sent="sent",e.Failed="Failed",e.failed="failed";}(d||(d={})),function(e){e.Email="Email",e.Call="Call",e.PSTN="PSTN",e.SMS="SMS",e.TeamsCall="TeamsCall",e.ETNP="ETNP";}(p||(p={})),function(e){e.Delivered="Delivered",e.Sending="Sending",e.Error="Error",e.Undeliverable="Undeliverable";}(g||(g={})),function(e){e.active="active",e.deleted="deleted",e.reference="reference",e.hidden="hidden";}(m||(m={})),function(e){e.p2p="p2p",e.customspo="customspo",e.aggregatefiles="aggregatefiles",e.downloads="downloads",e.teams="teams",e.recent="recent",e.personal="personal";}(h||(h={})),function(e){e.active="active",e.deleted="deleted",e.reference="reference",e.hidden="hidden";}(f||(f={})),function(e){e.Single="Single",e.Occurrence="Occurrence",e.Exception="Exception",e.RecurringMaster="RecurringMaster";}(v||(v={})),function(e){e.Done="Done",e.InProcess="InProcess",e.NotStarted="NotStarted",e.ScoreTooLow="ScoreTooLow",e.TooManyCharacters="TooManyCharacters",e.UnknownError="UnknownError",e.TranslationNotNeeded="TranslationNotNeeded",e.ShowOriginalMessage="ShowOriginalMessage",e.MessageNotFound="MessageNotFound",e.VersionNotFound="VersionNotFound",e.LanguageDetectionFailed="LanguageDetectionFailed";}(b||(b={})),function(e){e.Outgoing="Outgoing",e.Incoming="Incoming",e.Unknown="Unknown";}(y||(y={})),function(e){e.Accepted="Accepted",e.AcceptedElsewhere="AcceptedElsewhere",e.Declined="Declined",e.Missed="Missed",e.Unknown="Unknown";}(S||(S={})),function(e){e.MultiParty="MultiParty",e.TwoParty="TwoParty",e.Unknown="Unknown";}(C||(C={})),function(e){e.Default="Default",e.ScreenSharing="ScreenSharing",e.EmergencyGroupCall="EmergencyGroupCall",e.Unknown="Unknown";}(O||(O={})),function(e){e.brbfeedbackdialog="brbfeedbackdialog",e.breakoutrooms="breakoutrooms",e.broadcastqna="broadcastqna",e.broadcasts="broadcasts",e.callablechannels="callablechannels",e.calls="calls",e.callsmain="callsmain",e.callscontent="callscontent",e.callsgallery="callsgallery",e.callsgalleryandcontent="callsgalleryandcontent",e.channels="channels",e.chats="chats",e.courses="courses",e.devicesettings="devicesettings",e.extensions="extensions",e.file="file",e.galleryImages="galleryImages",e.invisionwhiteboard="invisionwhiteboard",e.licenses="licenses",e.meetings="meetings",e.messages="messages",e.email="email",e.outlookmessages="outlookmessages",e.platformapp="platformapp",e.search="search",e.shareMeetingInfo="shareMeetingInfo",e.taskmodule="taskmodule",e.teamgallery="teamgallery",e.teamjoincode="teamjoincode",e.teampicture="teampicture",e.teamrenewal="teamrenewal",e.teams="teams",e.teamsettings="teamsettings",e.transcript="transcript",e.videobackgrounds="videobackgrounds",e.voiceenrollment="voiceenrollment",e.codesnippet="codesnippet",e.faceenrollment="faceenrollment";}(_||(_={})),function(e){e.view="view",e.list="list",e.create="create",e.join="join",e.error="error",e.roster="roster",e.info="info",e.notes="notes",e.health="health",e.delete="delete";}(T||(T={})),function(e){e.Closed="Closed",e.Open="Open",e.Confirmed="Confirmed",e.Error="Error";}(M||(M={})),function(e){e.Grid="Grid",e.Audience="Audience",e.LargeGrid="LargeGrid";}(A||(A={})),function(e){e.Single="Single",e.TwoLargeLeft="TwoLargeLeft";}(w||(w={})),function(e){e.Single="Single",e.Left="Left",e.Right="Right";}(I||(I={})),function(e){e.Video="Video",e.ScreenSharing="ScreenSharing";}(P||(P={})),function(e){e.Card="Card",e.MessageExtension="MessageExtension",e.PlatformExtensionTab="PlatformExtensionTab",e.DeepLink="DeepLink";}(j||(j={})),function(e){e.Standard="Standard",e.Private="Private",e.Shared="Shared";}(D||(D={})),function(e){e.Domains="Domains",e.Members="Members",e.Anyone="Anyone";}(E||(E={})),function(e){e.Undefined="Undefined",e.User="User",e.Admin="Admin",e.Guest="Guest";}(N||(N={})),function(e){e.AnyonePost="AnyonePost",e.AnyoneWithWarning="AnyoneWithWarning",e.OwnersPost="OwnersPost";}(k||(k={})),function(e){e.Strict="Strict",e.Moderate="Moderate",e.NoRestriction="NoRestriction";}(R||(R={})),function(e){e.Team="Team",e.Edu="Edu",e.Class="Class",e.Plc="Plc",e.Staff="Staff",e.HealthcareCareCoordination="HealthcareCareCoordination";}(U||(U={})),function(e){e.None="None",e.Home="Home",e.Mobile="Mobile";}(L||(L={})),function(e){e.NotJoined="NotJoined",e.Joining="Joining",e.Joined="Joined",e.Pending="Pending";}(F||(F={})),function(e){e.None="None",e.Private="Private",e.Secret="Secret",e.Public="Public";}(B||(B={})),function(e){e.E164="E164",e.INTERNATIONAL="INTERNATIONAL",e.NATIONAL="NATIONAL",e.RFC3966="RFC3966";}(G||(G={})),function(e){e.Email="Email",e.MeetingInvite="MeetingInvite";}(x||(x={})),function(e){e.Link="Link",e.Attachment="Attachment";}(H||(H={})),function(e){e.ups="ups",e.sfb="sfb";}(V||(V={})),function(e){e.PresenceUnknown="PresenceUnknown",e.Available="Available",e.AvailableIdle="AvailableIdle",e.Away="Away",e.Busy="Busy",e.BusyIdle="BusyIdle",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Offline="Offline";}(z||(z={})),function(e){e.InACall="InACall",e.InAConferenceCall="InAConferenceCall",e.InAMeeting="InAMeeting",e.Presenting="Presenting",e.OffWork="OffWork",e.Available="Available",e.Inactive="Inactive",e.Busy="Busy",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Away="Away",e.Offline="Offline",e.UrgentInterruptionsOnly="UrgentInterruptionsOnly",e.PresenceUnknown="PresenceUnknown",e.OutOfOffice="OutOfOffice";}(W||(W={})),function(e){e.None="None",e.OnShift="OnShift",e.OffShift="OffShift";}(q||(q={})),function(e){e.Mobile="Mobile",e.Business="Business";}(Q||(Q={})),function(e){e.Anonymous="Anonymous",e.Aad="Aad",e.Msa="Msa",e.MsaLife="MsaLife",e.GFed="GFed",e.Otp="Otp";}(J||(J={})),function(e){e.Member="Member",e.Anonymous="Anonymous",e.Guest="Guest";}(K||(K={})),function(e){e.ChatDisabledDueToIB="ChatDisabledDueToIB",e.SmsChatDisabledDueToLicense="SmsChatDisabledDueToLicense",e.SmsChatDisabledDueToRNLError="SmsChatDisabledDueToRNLError",e.ChatDisabledDueToBotStatus="ChatDisabledDueToBotStatus",e.ChatDisabledDueToRecipientTeamsUpgradePolicy="ChatDisabledDueToRecipientTeamsUpgradePolicy",e.UnknownReason="UnknownReason";}(X||(X={})),function(e){e.Chat="Chat",e.PhoneChat="PhoneChat",e.Meeting="Meeting",e.SfBInteropChat="SfBInteropChat";}($||($={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast";}(Z||(Z={})),function(e){e.AcceptPending="AcceptPending",e.Accepted="Accepted",e.Blocked="Blocked";}(Y||(Y={})),function(e){e.TooManyMembers="TooManyMembers",e.ErrorFetchingData="ErrorFetchingData";}(ee||(ee={})),function(e){e.None="None",e.Organizer="Organizer",e.Tentative="Tentative",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded";}(te||(te={})),function(e){e.Required="Required",e.Optional="Optional",e.Resource="Resource",e.Organizer="Organizer",e.Room="Room";}(ne||(ne={})),function(e){e.StreamGroup="StreamGroup",e.SecurityGroup="SecurityGroup";}(re||(re={})),function(e){e.Free="Free",e.Tentative="Tentative",e.Busy="Busy",e.Oof="Oof",e.WorkingElsewhere="WorkingElsewhere",e.Unknown="Unknown";}(ie||(ie={})),function(e){e.ItemAttachment="ItemAttachment",e.FileAttachment="FileAttachment",e.ReferenceAttachment="ReferenceAttachment";}(ae||(ae={})),function(e){e.Anonymous="Anonymous",e.AllCompany="AllCompany",e.InvitationOnly="InvitationOnly";}(oe||(oe={})),function(e){e.Created="Created",e.Activated="Activated",e.Abandoned="Abandoned",e.Suspended="Suspended",e.Live="Live",e.Stopped="Stopped",e.Deleted="Deleted",e.Recreated="Recreated",e.Hidden="Hidden";}(se||(se={})),function(e){e.NotStarted="NotStarted",e.Pending="Pending",e.Available="Available",e.Deleted="Deleted";}(ce||(ce={})),function(e){e.AlwaysEnabled="AlwaysEnabled",e.AlwaysDisabled="AlwaysDisabled",e.UserOverride="UserOverride";}(le||(le={})),function(e){e.Camera="Camera",e.Microphone="Microphone",e.Speaker="Speaker";}(ue||(ue={})),function(e){e.None="None",e.Text="Text",e.StartEvent="StartEvent",e.StopEvent="StopEvent",e.ParticipantJoined="ParticipantJoined",e.ParticipantLeft="ParticipantLeft";}(de||(de={})),function(e){e.Monitor="Monitor",e.Window="Window",e.Camera="Camera";}(pe||(pe={})),function(e){e.NotControlCapable="NotControlCapable",e.Disabled="Disabled",e.NotInControl="NotInControl",e.RequestSent="RequestSent",e.InControl="InControl";}(ge||(ge={})),function(e){e.NotStarted="NotStarted",e.Starting="Starting",e.Started="Started",e.Stopping="Stopping",e.Stopped="Stopped";}(me||(me={})),function(e){e.Offline="Offline",e.InitFailed="InitFailed",e.JoinFailed="JoinFailed",e.AcceptFailed="AcceptFailed";}(he||(he={})),function(e){e.admin="admin",e.boss="boss",e.endUser="endUser";}(fe||(fe={})),function(e){e.Caller="Caller",e.SecurityDesk="SecurityDesk";}(ve||(ve={})),function(e){e.Video="Video",e.ScreenSharing="ScreenSharing";}(be||(be={})),function(e){e.Audio="Audio",e.Video="Video",e.PanoramicVideo="PanoramicVideo",e.ScreenShare="ScreenShare",e.Data="Data";}(ye||(ye={})),function(e){e.None="None",e.HoloLens="HoloLens",e.Android="Android",e.iOS="iOS",e.Other="Other";}(Se||(Se={})),function(e){e.Screen="Screen",e.App="App";}(Ce||(Ce={})),function(e){e.ppt="ppt",e.invision_whiteboard="invision_whiteboard",e.whiteboard="whiteboard";}(Oe||(Oe={})),function(e){e.upload="upload",e.recent="recent",e.channel="channel",e.attachment="attachment",e.cortana="cortana";}(_e||(_e={})),function(e){e.Audio="Audio",e.Video="Video";}(Te||(Te={})),function(e){e.AudioCaptureUltrasoundDetected="AudioCaptureUltrasoundDetected",e.AudienceViewFailed="AudienceViewFailed",e.Bmc_setLayout_command_failure="Bmc_setLayout_command_failure",e.Bmc_start_command_failure="Bmc_start_command_failure",e.Bmc_stop_command_failure="Bmc_stop_command_failure",e.BreakoutRoomAnnouncement="BreakoutRoomAnnouncement",e.BreakoutRoomInvite="BreakoutRoomInvite",e.Broadcast_captions_disabled_by_ETM="Broadcast_captions_disabled_by_ETM",e.Broadcast_concurrent_videos_limit="Broadcast_concurrent_videos_limit",e.Broadcast_end_warning="Broadcast_end_warning",e.Broadcast_ipvideo_permission="Broadcast_ipvideo_permission",e.Broadcast_ipvideo_vbss_permission="Broadcast_ipvideo_vbss_permission",e.Broadcast_noCamera="Broadcast_noCamera",e.Broadcast_preview_overflow_warning="Broadcast_preview_overflow_warning",e.Broadcast_reset_done="Broadcast_reset_done",e.Broadcast_vbss_permission="Broadcast_vbss_permission",e.BroadcastModalityDisconnected="BroadcastModalityDisconnected",e.BroadcastModalityNotReceived="BroadcastModalityNotReceived",e.BroadcastMutedProducerWarning="BroadcastMutedProducerWarning",e.BroadcastStopped="BroadcastStopped",e.ComplianceRecordingStarted="ComplianceRecordingStarted",e.ComplianceRecordingStopped="ComplianceRecordingStopped",e.ContentOnlyAlert="ContentOnlyAlert",e.ContentOnlyFromNudgeAlert="ContentOnlyFromNudgeAlert",e.ContentSharingFailed="ContentSharingFailed",e.CpuInsufficient="CpuInsufficient",e.CurrentMeetingIsXL="CurrentMeetingIsXL",e.DeviceAtCallStart="DeviceAtCallStart",e.DeviceCaptureMute="DeviceCaptureMute",e.DeviceCaptureNotFunctioning="DeviceCaptureNotFunctioning",e.DeviceCaptureNotFunctioningAudioSrvNotRunning="DeviceCaptureNotFunctioningAudioSrvNotRunning",e.DeviceCaptureNotMuteButSilent="DeviceCaptureNotMuteButSilent",e.DeviceClipping="DeviceClipping",e.DeviceHowling="DeviceHowling",e.DeviceLowSNR="DeviceLowSNR",e.DeviceMultipleEndpoints="DeviceMultipleEndpoints",e.DeviceNearEndToEchoRatio="DeviceNearEndToEchoRatio",e.DeviceRenderHowling="DeviceRenderHowling",e.DeviceRenderNotFunctioning="DeviceRenderNotFunctioning",e.DeviceRenderNotFunctioningAudioSrvNotRunning="DeviceRenderNotFunctioningAudioSrvNotRunning",e.DeviceRenderZeroVolume="DeviceRenderZeroVolume",e.DeviceSpeakWhileMuted="DeviceSpeakWhileMuted",e.EndOfMeetingAlert="EndOfMeetingAlert",e.LargeGalleryViewFailed="LargeGalleryViewFailed",e.HolographicAnnotationsError="HolographicAnnotationsError",e.ImageRenderingQualityAlert="ImageRenderingQualityAlert",e.InitiatorStartedRecording="InitiatorStartedRecording",e.InsufficientMeetingRole="InsufficientMeetingRole",e.InteropCallAlert="InteropCallAlert",e.InteropScreenshare="InteropScreenshare",e.JoinersOngoingRecording="JoinersOngoingRecording",e.LocalDeviceEcho="LocalDeviceEcho",e.MeetingRoleChanged="MeetingRoleChanged",e.MergeFailedAlert="MergeFailedAlert",e.MicMutedRemotely="MicMutedRemotely",e.NdiMeetingBroadcastCapturer="NdiMeetingBroadcastCapturer",e.NdiMeetingBroadcastStoppedCapturer="NdiMeetingBroadcastStoppedCapturer",e.NdiMeetingBroadcastParticipant="NdiMeetingBroadcastParticipant",e.NdiMeetingBroadcastStoppedParticipant="NdiMeetingBroadcastStoppedParticipant",e.NetworkQuality="NetworkQuality",e.NetworkReconnect="NetworkReconnect",e.NetworkRecvCatastrophicPoorTurnOffVideo="NetworkRecvCatastrophicPoorTurnOffVideo",e.NetworkRecvCatastrophicPstnAvailable="NetworkRecvCatastrophicPstnAvailable",e.NetworkRecvCatastrophicPstnNotAvailable="NetworkRecvCatastrophicPstnNotAvailable",e.NetworkSendCatastrophicPoorTurnOffVideo="NetworkSendCatastrophicPoorTurnOffVideo",e.NetworkSendCatastrophicPstnAvailable="NetworkSendCatastrophicPstnAvailable",e.NetworkSendCatastrophicPstnNotAvailable="NetworkSendCatastrophicPstnNotAvailable",e.NoAvailableMicrophone="NoAvailableMicrophone",e.NoAvailableSpeakers="NoAvailableSpeakers",e.OverflowRoomCreated="OverflowRoomCreated",e.ParticipantsRecordingStarted="ParticipantsRecordingStarted",e.PptPrivateViewingFailed="PptPrivateViewingFailed",e.PptSharingStolen="PptSharingStolen",e.PptUnsupportedUpload="PptUnsupportedUpload",e.RaiseHandsOperationFailure="RaiseHandsOperationFailure",e.RecordingAndTranscriptFailed="RecordingAndTranscriptFailed",e.RecordingAndTranscriptPending="RecordingAndTranscriptPending",e.RecordingAndTranscriptStarted="RecordingAndTranscriptStarted",e.RecordingAndTranscriptStartedByOthers="RecordingAndTranscriptStartedByOthers",e.RecordingAndTranscriptStopFailed="RecordingAndTranscriptStopFailed",e.RecordingAndTranscriptStopped="RecordingAndTranscriptStopped",e.RecordingDisabled="RecordingDisabled",e.RecordingFailed="RecordingFailed",e.RecordingFailedTranscriptPending="RecordingFailedTranscriptPending",e.RecordingFailedTranscriptStarted="RecordingFailedTranscriptStarted",e.RecordingPPT="RecordingPPT",e.RecordingStartedTranscriptPending="RecordingStartedTranscriptPending",e.RecordingStopped="RecordingStopped",e.RecordingWhiteboard="RecordingWhiteboard",e.RemoteDeviceEcho="RemoteDeviceEcho",e.RigelAutoExitMeetingAlert="RigelAutoExitMeetingAlert",e.RigelDisplayDisconnected="RigelDisplayDisconnected",e.RigelParticipantsInLobby="RigelParticipantsInLobby",e.ScreenshareRecordingDisabled="ScreenshareRecordingDisabled",e.ScreensharingCallEscalatedToAudio="ScreensharingCallEscalatedToAudio",e.ScreensharingCallEscalatedToAudioFailed="ScreensharingCallEscalatedToAudioFailed",e.ScreenSharingNotSupported="ScreenSharingNotSupported",e.ScreenSharingRenderingError="ScreenSharingRenderingError",e.ScreenSharingWindowMinimizedPopUpAlert="ScreenSharingWindowMinimizedPopUpAlert",e.SharedWindowMinimized="SharedWindowMinimized",e.SharingControlRequestDenied="SharingControlRequestDenied",e.SharingControlRequestRevoked="SharingControlRequestRevoked",e.SharingDropped="SharingDropped",e.SharingStolen="SharingStolen",e.NewAudioDevicePluggedInAlert="NewAudioDevicePluggedInAlert",e.NewVideoDevicePluggedInAlert="NewVideoDevicePluggedInAlert",e.AudioDeviceSelectionChangedAlert="AudioDeviceSelectionChangedAlert",e.ActiveAudioDevicePluggedOutAlert="ActiveAudioDevicePluggedOutAlert",e.ActiveVideoDevicePluggedOutAlert="ActiveVideoDevicePluggedOutAlert",e.SpeakerAndMicUnmuted="SpeakerAndMicUnmuted",e.SpotlightStatusChanged="SpotlightStatusChanged",e.SystemAudioDevicesNotMatch="SystemAudioDevicesNotMatch",e.SystemAudioDriverInstallationFailed="SystemAudioDriverInstallationFailed",e.SystemAudioDriverInstallationSucceeded="SystemAudioDriverInstallationSucceeded",e.SystemAudioNoDevice="SystemAudioNoDevice",e.SystemAudioUnsupportedSharing="SystemAudioUnsupportedSharing",e.TranscriptFailedRecordingPending="TranscriptFailedRecordingPending",e.TranscriptFailedRecordingStarted="TranscriptFailedRecordingStarted",e.TranscriptStarted="TranscriptStarted",e.TranscriptStartedByOthers="TranscriptStartedByOthers",e.TranscriptStartedRecordingPending="TranscriptStartedRecordingPending",e.TranscriptStartFailed="TranscriptStartFailed",e.TranscriptStopFailed="TranscriptStopFailed",e.TranscriptStopped="TranscriptStopped",e.UserHandLoweredByPresenter="UserHandLoweredByPresenter",e.VideoCaptureDeviceFreeze="VideoCaptureDeviceFreeze",e.VideoCaptureFreezeRecovered="VideoCaptureFreezeRecovered",e.VideoCapturePermissionDenied="VideoCapturePermissionDenied",e.VideoCapturerDeviceStartFailed="VideoCapturerDeviceStartFailed",e.VideoCapturerDeviceStartFailureLackSystemRes="VideoCapturerDeviceStartFailureLackSystemRes",e.VideoCapturerDeviceStartFailureMFResConflict="VideoCapturerDeviceStartFailureMFResConflict",e.VideoCapturerDeviceStartTimedOut="VideoCapturerDeviceStartTimedOut",e.VoiceCollectionFailed="VoiceCollectionFailed",e.VoiceCollectionStarted="VoiceCollectionStarted",e.VoiceCollectionStopped="VoiceCollectionStopped";}(Me||(Me={})),function(e){e.Info="Info",e.Warning="Warning",e.Error="Error";}(Ae||(Ae={})),function(e){e.AcceptBreakoutRoomInvite="AcceptBreakoutRoomInvite",e.BroadcastLearnMore="BroadcastLearnMore",e.BroadcastModalityReconnect="BroadcastModalityReconnect",e.DeclineBreakoutRoomInvite="DeclineBreakoutRoomInvite",e.DownloadApp="DownloadApp",e.MuteSpeakerAndMicAudio="MuteSpeakerAndMicAudio",e.NdiPrivacyPolicyCapturer="NdiPrivacyPolicyCapturer",e.NdiPrivacyPolicyParticipant="NdiPrivacyPolicyParticipant",e.OpenAudioEscalationDialog="OpenAudioEscalationDialog",e.SwitchDevice="SwitchDevice",e.OpenDeviceSettings="OpenDeviceSettings",e.OpenLearnMoreLink="OpenLearnMoreLink",e.OpenMeetingInfo="OpenMeetingInfo",e.OpenPrivacyPolicyLink="OpenPrivacyPolicyLink",e.OptOutFromVoiceCollection="OptOutFromVoiceCollection",e.PstnDialInManually="PstnDialInManually",e.PstnDialOutManually="PstnDialOutManually",e.RejoinAsGuest="RejoinAsGuest",e.ShowPstnDialog="ShowPstnDialog",e.StartChromeExtensionInstallation="StartChromeExtensionInstallation",e.StartScreenSharingOnCall="StartScreenSharingOnCall",e.SwitchMicrophone="SwitchMicrophone",e.TakePptSharingControl="TakePptSharingControl",e.UnmuteMicAudio="UnmuteMicAudio",e.UnmuteSpeakers="UnmuteSpeakers",e.StartMeeting="StartMeeting",e.EnableScreenshareRecording="EnableScreenshareRecording",e.DisableIncomingAndOutgoingVideo="DisableIncomingAndOutgoingVideo",e.Cancel="Cancel";}(we||(we={})),function(e){e.SearchSuggestions="SearchSuggestions",e.SearchResults="SearchResults",e.AddToChat="AddToChat",e.AddToTeam="AddToTeam",e.NewChat="NewChat",e.Transfer="Transfer",e.AddToCall="AddToCall",e.CallRouting="CallRouting",e.CallForwardGroupSelection="CallForwardGroupSelection",e.DelegationSelection="DelegationSelection",e.PresenceSettings="PresenceSettings",e.AddToMeeting="AddToMeeting",e.MeetingSchedule="MeetingSchedule",e.AddToSpeedDialOrContacts="AddToSpeedDialOrContacts",e.AtMention="AtMention",e.OrgChart="OrgChart",e.PriorityContactsSelection="PriorityContactsSelection",e.TaggedContactsSelection="TaggedContactsSelection",e.StatusNote="StatusNote",e.VoicemailTransferTarget="VoicemailTransferTarget",e.SearchExpoDisplays="SearchExpoDisplays",e.AllFalse="AllFalse",e.AllTrue="AllTrue";}(Ie||(Ie={})),function(e){e.Quality="Quality",e.ShortDurationHangup="ShortDurationHangup",e.EffectiveMeeting="EffectiveMeeting",e.EffectiveMeetingV2="EffectiveMeetingV2";}(Pe||(Pe={})),function(e){e.Audio="Audio",e.AttendeeAudio="AttendeeAudio",e.Video="Video",e.ScreenSharing="ScreenSharing",e.Broadcast="Broadcast",e.ScreenshareFromChat="ScreenshareFromChat",e.AttendeeGeneral="AttendeeGeneral",e.AttendeeCaptions="AttendeeCaptions",e.CallClosedCaptions="CallClosedCaptions",e.EffectiveMeeting="EffectiveMeeting",e.Other="Other";}(je||(je={})),function(e){e.P2P="P2P",e.GroupCall="GroupCall",e.Meeting="Meeting",e.ScreenshareFromChat="ScreenshareFromChat",e.PSTN="PSTN",e.SfB="SfB";}(De||(De={})),function(e){e.Team="Team",e.SharedLine="SharedLine",e.ServerHold="ServerHold";}(Ee||(Ee={})),function(e){e.QuickStart="QuickStart",e.BYOE="BYOE",e.QuickStartPushToStream="QuickStartPushToStream",e.Slowlane="Slowlane",e.Overflow="Overflow";}(Ne||(Ne={})),function(e){e.Producer="Producer",e.Contributor="Contributor",e.Attendee="Attendee",e.None="None";}(ke||(ke={})),function(e){e.EmptyState="EmptyState",e.InvalidQsp="InvalidQsp",e.NotOrganizer="NotOrganizer",e.MissingQsp="MissingQsp",e.PartialChange="PartialChange",e.Unknown="Unknown";}(Re||(Re={})),function(e){e.List="List",e.Boolean="Boolean";}(Ue||(Ue={})),function(e){e.eq="eq";}(Le||(Le={})),function(e){e.PresenterSelection="PresenterSelection";}(Fe||(Fe={})),function(e){e.OngoingCall="OngoingCall",e.Meeting="Meeting",e.OneToOneCall="OneToOneCall",e.GroupCall="GroupCall";}(Be||(Be={})),function(e){e.Url="Url",e.Text="Text";}(Ge||(Ge={})),function(e){e.PROGRESS="PROGRESS",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.CONFLICT="CONFLICT",e.COMPLETE="COMPLETE";}(xe||(xe={})),function(e){e.TEAMS="TEAMS",e.SHAREPOINT="SHAREPOINT";}(He||(He={})),function(e){e.File="File",e.Folder="Folder";}(Ve||(Ve={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat";}(ze||(ze={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Messaging="Messaging",e.Connector="Connector";}(We||(We={})),function(e){e.NotInstalled="NotInstalled",e.Installed="Installed",e.InstalledAndFavorited="InstalledAndFavorited",e.InstalledAndHidden="InstalledAndHidden",e.InstalledAndPermanent="InstalledAndPermanent",e.InstalledAndDeprecated="InstalledAndDeprecated",e.Featured="Featured";}(qe||(qe={})),function(e){e.Unknown="Unknown",e.SidePanel="SidePanel",e.Stage="Stage";}(Qe||(Qe={})),function(e){e.Compose="Compose",e.Commandbox="Commandbox",e.Message="Message";}(Je||(Je={})),function(e){e.Query="Query",e.Action="Action";}(Ke||(Ke={})),function(e){e.Text="Text",e.Textarea="Textarea",e.Number="Number",e.Date="Date",e.Time="Time",e.Toggle="Toggle",e.Choiceset="Choiceset";}(Xe||(Xe={})),function(e){e.pdf="pdf",e.xlsx="xlsx",e.docx="docx",e.pptx="pptx",e.vsdx="vsdx",e.one="one";}($e||($e={})),function(e){e.QueryByThread="QueryByThread",e.QueryByApp="QueryByApp";}(Ze||(Ze={})),function(e){e.None="None",e.Disabled="Disabled",e.Pending="Pending",e.Waiting="Waiting",e.Started="Started",e.Stopped="Stopped",e.Failed="Failed";}(Ye||(Ye={})),function(e){e.NotSupported="NotSupported",e.Unavailable="Unavailable",e.Available="Available";}(et||(et={})),function(e){e.Off="Off",e.BackgroundBlur="BackgroundBlur",e.WhiteboardZoom="WhiteboardZoom",e.WhiteboardCleanup="WhiteboardCleanup",e.WhiteboardZoomAndCleanup="WhiteboardZoomAndCleanup";}(tt||(tt={})),function(e){e.Unknown="Unknown",e.Available="Available",e.NotAvailable="NotAvailable";}(nt||(nt={})),function(e){e.MeetingsUserParticipatesIn="MeetingsUserParticipatesIn",e.MeetingsUserIsInvitedTo="MeetingsUserIsInvitedTo",e.MeetingsManuallyUnmuted="MeetingsManuallyUnmuted";}(rt||(rt={})),function(e){e.callingAndMeeting="callingAndMeeting";}(it||(it={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.NONE="NONE",e.SUCCESS="SUCCESS",e.FAIL="FAIL";}(at||(at={})),function(e){e.StringAuthResult="StringAuthResult",e.JsonAuthResult="JsonAuthResult";}(ot||(ot={})),function(e){e.list="list",e.grid="grid";}(st||(st={})),function(e){e.result="result",e.auth="auth",e.config="config",e.message="message",e.botMessagePreview="botMessagePreview";}(ct||(ct={})),function(e){e.normal="normal",e.high="high",e.urgent="urgent";}(lt||(lt={})),function(e){e.aadUser="aadUser",e.onPremiseAadUser="onPremiseAadUser",e.anonymousGuest="anonymousGuest",e.federatedUser="federatedUser";}(ut||(ut={})),function(e){e.aadApplication="aadApplication",e.bot="bot",e.tenantBot="tenantBot",e.office365Connector="office365Connector",e.webhook="webhook";}(dt||(dt={})),function(e){e.team="team",e.channel="channel";}(pt||(pt={})),function(e){e.html="html",e.text="text";}(gt||(gt={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry";}(mt||(mt={})),function(e){e.NoMatch="NoMatch",e.MatchButNotInstalled="MatchButNotInstalled",e.MatchButNeedAuthOrConfig="MatchButNeedAuthOrConfig",e.MatchAndPendingFetch="MatchAndPendingFetch",e.HasResult="HasResult",e.Failed="Failed";}(ht||(ht={})),function(e){e.Thumbnail="Thumbnail",e.Card="Card",e.Permission="Permission";}(ft||(ft={})),function(e){e.NoCache="NoCache";}(vt||(vt={})),function(e){e.message="message",e.compose="compose",e.commandBox="commandBox";}(bt||(bt={})),function(e){e.default="default",e.dark="dark",e.highContrast="highContrast";}(yt||(yt={})),function(e){e.NotAvailable="NotAvailable",e.Green="Green",e.Amber="Amber",e.Red="Red";}(St||(St={})),function(e){e.TeamSummariesAvailable="TeamSummariesAvailable",e.NoTeamsAvailable="NoTeamsAvailable",e.CourseSyncInProgress="CourseSyncInProgress",e.DefaultError="DefaultError";}(Ct||(Ct={})),function(e){e.Custom="Custom",e.Favorites="Favorites",e.SfBFavorites="SfBFavorites",e.Tagged="Tagged",e.OtherContacts="OtherContacts",e.TflContacts="TflContacts",e.TflBlocked="TflBlocked";}(Ot||(Ot={})),function(e){e.Exchange="Exchange",e.BuddyList="BuddyList",e.MiddleTier="MiddleTier";}(_t||(_t={})),function(e){e.Principal="Principal",e.Manager="Manager",e.Peer="Peer",e.InOrg="InOrg";}(Tt||(Tt={})),function(e){e.NotInstalled="NotInstalled",e.InProgress="InProgress",e.Installed="Installed",e.UpdateAvailable="UpdateAvailable",e.MustUpdate="MustUpdate";}(Mt||(Mt={})),function(e){e.Opening="Opening",e.OpeningFailed="OpeningFailed",e.Closing="Closing",e.ClosingFailed="ClosingFailed";}(At||(At={})),function(e){e.Info="Info",e.Error="Error";}(wt||(wt={})),function(e){e.Single="Single",e.Occurrence="Occurrence",e.Exception="Exception",e.RecurringMaster="RecurringMaster";}(It||(It={})),function(e){e.Free="Free",e.Tentative="Tentative",e.Busy="Busy",e.Oof="Oof",e.WorkingElsewhere="WorkingElsewhere",e.Unknown="Unknown";}(Pt||(Pt={})),function(e){e.Producer="Producer",e.Contributor="Contributor",e.Attendee="Attendee",e.None="None";}(jt||(jt={})),function(e){e.show="show",e.hide="hide",e.toggle="toggle";}(Dt||(Dt={})),function(e){e.none="none",e.flush="flush",e.forceFlush="forceFlush",e.new="new",e.extend="extend";}(Et||(Et={})),function(e){e.NotStarted="NotStarted",e.Started="Started",e.Starting="Starting",e.Stopped="Stopped",e.Stopping="Stopping";}(Nt||(Nt={})),function(e){e.Camera="Camera",e.Microphone="Microphone",e.Speaker="Speaker";}(kt||(kt={})),function(e){e.QuickStart="QuickStart",e.BYOE="BYOE",e.QuickStartPushToStream="QuickStartPushToStream",e.Overflow="Overflow";}(Rt||(Rt={})),function(e){e.Ring="Ring",e.Mute="Mute",e.Banner="Banner";}(Ut||(Ut={})),function(e){e.Voicemail="Voicemail",e.SingleTarget="SingleTarget",e.MyDelegates="MyDelegates",e.DoNothing="DoNothing",e.Group="Group";}(Lt||(Lt={})),function(e){e.Immediate="Immediate",e.Simultaneous="Simultaneous",e.Unanswered="Unanswered";}(Ft||(Ft={})),function(e){e.CreateAndDeleteTab="CreateAndDeleteTab",e.CreateAndUpdateChannel="CreateAndUpdateChannel",e.EditMessagesEnabled="EditMessagesEnabled",e.DeleteMessagesEnabled="DeleteMessagesEnabled",e.AdminDeleteEnabled="AdminDeleteEnabled",e.InstallAndUninstallApps="InstallAndUninstallApps",e.UploadCustomApp="UploadCustomApp",e.DeleteChannel="DeleteChannel",e.CreatePrivateChannel="CreatePrivateChannel",e.UpdateConnectors="UpdateConnectors",e.GeneralChannelPosting="GeneralChannelPosting",e.TeamMention="TeamMention",e.ChannelMention="ChannelMention",e.GiphyEnabled="GiphyEnabled",e.GiphyRating="GiphyRating",e.StickersEnabled="StickersEnabled",e.CustomMemesEnabled="CustomMemesEnabled",e.AddAndRemoveDisplayContent="AddAndRemoveDisplayContent";}(Bt||(Bt={})),function(e){e.WhoBotTab="WhoBotTab";}(Gt||(Gt={})),function(e){e.Block="Block",e.Unblock="Unblock";}(xt||(xt={})),function(e){e.Excellent="Excellent",e.Good="Good",e.Fair="Fair",e.Poor="Poor",e.Unknown="Unknown";}(Ht||(Ht={})),function(e){e.AttendeeAvailabilityOnly="AttendeeAvailabilityOnly",e.SuggestedTimesOnly="SuggestedTimesOnly",e.Both="Both";}(Vt||(Vt={})),function(e){e.Create="Create",e.Update="Update";}(zt||(zt={})),function(e){e.Create="Create",e.Update="Update";}(Wt||(Wt={})),function(e){e.like="like",e.star="star",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry",e.acks="acks";}(qt||(qt={})),function(e){e.add="add",e.remove="remove";}(Qt||(Qt={})),function(e){e.All="All",e.Presenters="Presenters",e.Attendees="Attendees";}(Jt||(Jt={})),function(e){e.Hold="Hold",e.Resume="Resume",e.Transfer="Transfer",e.ConsultativeTransfer="ConsultativeTransfer";}(Kt||(Kt={})),function(e){e.Chat="Chat",e.TeamsCall="TeamsCall";}(Xt||(Xt={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause";}($t||($t={})),function(e){e.MediaPaused="MediaPaused",e.MediaPlayed="MediaPlayed",e.MediaStopped="MediaStopped",e.MediaSeeked="MediaSeeked";}(Zt||(Zt={})),function(e){e.Scheduled="Scheduled",e.Broadcast="Broadcast";}(Yt||(Yt={})),function(e){e.None="None",e.Gallery="Gallery",e.Content="Content",e.ContentWithGallery="ContentWithGallery";}(en||(en={})),function(e){e.edit="edit",e.send="send";}(tn||(tn={})),function(e){e.List="List",e.Table="Table";}(nn||(nn={})),function(e){e.Connected="Connected",e.Disconnected="Disconnected",e.NotFound="NotFound";}(rn||(rn={})),function(e){e.Col="Col",e.Row="Row";}(an||(an={})),function(e){e.Unknown="Unknown",e.Acquire="Acquire",e.Renew="Renew",e.Release="Release";}(on||(on={})),function(e){e.None="None",e.Bullets="Bullets",e.Numbers="Numbers",e.Checkboxes="Checkboxes";}(sn||(sn={})),function(e){e.Done="Done",e.Error="Error",e.ErrorTooManyCharacters="ErrorTooManyCharacters",e.InProcess="InProcess";}(cn||(cn={})),function(e){e.CallGroup="CallGroup",e.Calls="Calls",e.Devices="Devices";}(ln||(ln={})),function(e){e.personalFileSite="personalFileSite",e.userPersonalSettings="userPersonalSettings",e.firstLoginInformation="firstLoginInformation",e.readReceiptsEnabled="readReceiptsEnabled";}(un||(un={})),function(e){e.IMAGE="IMAGE",e.DOCUMENT="DOCUMENT";}(dn||(dn={})),function(e){e.Pause="Pause",e.Resume="Resume",e.Goto="Goto",e.Cards="Cards";}(pn||(pn={})),function(e){e.confirm="confirm",e.revert="revert",e.dismiss="dismiss";}(gn||(gn={})),function(e){e.CourseSyncInProgress="CourseSyncInProgress",e.EducatorRolePermissionError="EducatorRolePermissionError",e.TeamCreationPermissionError="TeamCreationPermissionError",e.NoUniqueSdsProfileError="NoUniqueSdsProfileError",e.UnsupportedLmsError="UnsupportedLmsError",e.AccountMismatchError="AccountMismatchError",e.DefaultError="DefaultError";}(mn||(mn={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.BrowsingPrivately="BrowsingPrivately",e.Presenting="Presenting",e.Starting="Starting",e.Joining="Joining";}(hn||(hn={})),function(e){e.Next="Next",e.Prev="Prev",e.GoTo="GoTo";}(fn||(fn={})),function(e){e.None="None",e.Pending="Pending",e.Recording="Recording",e.Paused="Paused",e.Stopping="Stopping",e.Failed="Failed",e.Disabled="Disabled";}(vn||(vn={})),function(e){e.None="None",e.Started="Started",e.Failed="Failed";}(bn||(bn={})),function(e){e.None="None",e.Started="Started",e.Stopped="Stopped",e.Pending="Pending",e.Failed="Failed";}(yn||(yn={})),function(e){e.Idle="Idle",e.AdHoc="AdHoc",e.Incoming="Incoming",e.InACall="InACall",e.CQF="CQF",e.Cortana="Cortana";}(Sn||(Sn={})),function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced";}(Cn||(Cn={})),function(e){e.Open="Open",e.Close="Close",e.Result="Result",e.Cancel="Cancel";}(On||(On={})),function(e){e.NoOne="NoOne",e.Me="Me",e.AnotherUser="AnotherUser";}(_n||(_n={})),function(e){e.None="None",e.Started="Started",e.Stopped="Stopped",e.Pending="Pending",e.Failed="Failed";}(Tn||(Tn={})),function(e){e.Error="Error",e.Started="Started",e.Captured="Captured",e.Processed="Processed",e.Stopped="Stopped",e.Updated="Updated";}(Mn||(Mn={})),function(e){e.Add="Add",e.Remove="Remove",e.Update="Update";}(An||(An={})),function(e){e.Ready="Ready",e.Listening="Listening",e.Thinking="Thinking",e.Speaking="Speaking";}(wn||(wn={})),function(e){e.DataChannel="DataChannel",e.AnnotationReady="AnnotationReady",e.ClientInForeground="ClientInForeground",e.AnnotationLimit="AnnotationLimit",e.Tracking="Tracking";}(In||(In={})),function(e){e.PROGRESS="PROGRESS",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.COMPLETE="COMPLETE";}(Pn||(Pn={})),function(e){e.hold="hold",e.active="active";}(jn||(jn={})),function(e){e.Undefined="Undefined",e.Success="Success",e.NoNgcEndpoint="NoNgcEndpoint",e.NetworkError="NetworkError",e.MediaDroppedError="MediaDroppedError",e.BadRequest="BadRequest",e.CallEstablishmentTimeout="CallEstablishmentTimeout",e.CallSetupError="CallSetupError",e.NoPermission="NoPermission",e.Missed="Missed",e.Declined="Declined",e.Busy="Busy",e.Cancelled="Cancelled",e.Dropped="Dropped",e.PstnInsufficientFunds="PstnInsufficientFunds",e.PstnSkypeoutAccountBlocked="PstnSkypeoutAccountBlocked",e.PstnCouldNotConnectToSkypeProxy="PstnCouldNotConnectToSkypeProxy",e.PstnBlockedByUs="PstnBlockedByUs",e.PstnBlockedRegulatoryIndia="PstnBlockedRegulatoryIndia",e.PstnInvalidNumber="PstnInvalidNumber",e.PstnNumberForbidden="PstnNumberForbidden",e.PstnCallTerminated="PstnCallTerminated",e.PstnNumberUnavailable="PstnNumberUnavailable",e.PstnEmergencyCallDenied="PstnEmergencyCallDenied",e.CallNotFound="CallNotFound",e.LocalError="LocalError",e.NotAcceptableHere="NotAcceptableHere",e.CallForwarded="CallForwarded",e.CallForwardedToVoicemail="CallForwardedToVoicemail",e.SkypeTokenError="SkypeTokenError",e.CallAccepted="CallAccepted",e.LocalHttpStackError="LocalHttpStackError",e.UnknownError="UnknownError",e.PstnNoSubscriptionCover="PstnNoSubscriptionCover",e.SessionNotFound="SessionNotFound",e.SessionTimedOut="SessionTimedOut",e.PstnCreditExpired="PstnCreditExpired",e.PstnCreditExpiredButEnough="PstnCreditExpiredButEnough",e.RetargetNotSupported="RetargetNotSupported",e.EnterprisePstnInternalError="EnterprisePstnInternalError",e.EnterprisePstnUnavailable="EnterprisePstnUnavailable",e.EnterprisePstnForbidden="EnterprisePstnForbidden",e.EnterprisePstnInvalidNumber="EnterprisePstnInvalidNumber",e.EnterprisePstnMiscError="EnterprisePstnMiscError",e.Kicked="Kicked",e.NetworkRequestTimeoutError="NetworkRequestTimeoutError",e.CallDoesNotExist="CallDoesNotExist",e.MediaSetupFailure="MediaSetupFailure",e.ServiceUnavailable="ServiceUnavailable",e.SignalingError="SignalingError",e.ConversationEstablishmentFailed="ConversationEstablishmentFailed",e.TemporarilyUnavailable="TemporarilyUnavailable",e.CannotConnectToNetworkError="CannotConnectToNetworkError",e.MediaRelayWhiteListingIssue="MediaRelayWhiteListingIssue",e.NoSignalingFromPeer="NoSignalingFromPeer",e.DeniedInLobby="DeniedInLobby",e.TimedOutInLobby="TimedOutInLobby",e.CallFailedConflict="CallFailedConflict",e.DevicePermissionDenied="DevicePermissionDenied",e.ConfParticipantCountLimitReached="ConfParticipantCountLimitReached",e.ActionNotAllowed="ActionNotAllowed",e.Abandoned="Abandoned",e.ForbiddenDueToPolicy="ForbiddenDueToPolicy",e.InsufficientCapabilitiesForCallee="InsufficientCapabilitiesForCallee",e.UserBlocked="UserBlocked",e.AccessDenied="AccessDenied",e.AnonymousJoinDisabledByPolicy="AnonymousJoinDisabledByPolicy",e.NoLobbyForBroadcastJoin="NoLobbyForBroadcastJoin",e.NotAllowedDueToInformationBarrier="NotAllowedDueToInformationBarrier",e.BroadcastLimitReached="BroadcastLimitReached",e.TeamParkPolicyDisabled="TeamParkPolicyDisabled",e.B2bJoinDisabledByPolicy="B2bJoinDisabledByPolicy",e.LocationBasedRoutingError="LocationBasedRoutingError",e.ConfLobbyParticipantCountLimitReached="ConfLobbyParticipantCountLimitReached";}(Dn||(Dn={})),function(e){e.Success="Success",e.Failed="Failed";}(En||(En={})),function(e){e.organization="organization";}(Nn||(Nn={})),function(e){e.List="List",e.Grid="Grid",e.Object="Object";}(kn||(kn={}));},O9iK:function O9iK(e,t){},PpGX:function PpGX(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chat"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isDisabled"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"isRead"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"chatType"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"members"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"objectId"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"displayName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"givenName"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"email"},arguments:[],directives:[]}]}}]}}]}}],loc:{start:0,end:220}};n.loc.source={body:"query chat($convId: ID!) {\n  chat(convId: $convId) {\n    id\n    title\n    isDisabled\n    isOneOnOne\n    isRead\n    chatType\n    members {\n      id\n      objectId\n      displayName\n      givenName\n      email\n    }\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var r={};function i(e,t){for(var n=0;n<e.definitions.length;n++){var r=e.definitions[n];if(r.name&&r.name.value==t)return r;}}n.definitions.forEach(function(e){if(e.name){var t=new Set();!function e(t,n){if("FragmentSpread"===t.kind)n.add(t.name.value);else if("VariableDefinition"===t.kind){var r=t.type;"NamedType"===r.kind&&n.add(r.name.value);}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,n);}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,n);}),t.definitions&&t.definitions.forEach(function(t){e(t,n);});}(e,t),r[e.name.value]=t;}}),e.exports=n,e.exports.chat=function(e,t){var n={kind:e.kind,definitions:[i(e,t)]};e.hasOwnProperty("loc")&&(n.loc=e.loc);var a=r[t]||new Set(),o=new Set(),s=new Set();for(a.forEach(function(e){s.add(e);});s.size>0;){var c=s;s=new Set(),c.forEach(function(e){o.has(e)||(o.add(e),(r[e]||new Set()).forEach(function(e){s.add(e);}));});}return o.forEach(function(t){var r=i(e,t);r&&n.definitions.push(r);}),n;}(n,"chat");},XPgi:function XPgi(e,t){},zqWZ:function zqWZ(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"DataSource",function(){return pn;});var i,a=n("+7/b"),o=n("svWY"),s=n("Mo3Q"),c=n("PpGX");!function(e){e[e.Value=0]="Value",e[e.Error=1]="Error";}(i||(i={}));var l=n("W1yN"),u=function(){function e(e,t,n){if(void 0===e&&(e=100),this.newScenario=t,e<0)throw new TypeError("BufferLimit has to be > 0");this._isComplete=!1,this._values=[],this._promiseResolutionFunctions=[],this._bufferLimit=e,this._overflowScenario=null,this._droppedEvents=0,this._operationName=n;}return e.prototype.next=function(e){this._push({type:i.Value,value:e});},e.prototype.error=function(e){this._push({type:i.Error,error:e});},e.prototype.complete=function(){for(this._isComplete=!0;this._promiseResolutionFunctions.length>0;){this._promiseResolutionFunctions.shift().resolve({done:!0});}},e.prototype.nextPromise=function(){var e=this;if(this._overflowScenario&&this._values.length<this._bufferLimit&&(this._overflowScenario.stop({size:this._droppedEvents}),this._overflowScenario=null,this._droppedEvents=0),this._values.length>0){var t=this._values.shift(),n=t.type,r=t.value,a=t.error;return n===i.Error?Promise.reject(a):Promise.resolve({done:!1,value:r});}return this._isComplete?Promise.resolve({done:!0}):new Promise(function(t,n){e._promiseResolutionFunctions.push({resolve:t,reject:n});});},e.prototype._push=function(e){if(this._promiseResolutionFunctions.length>0){var t=this._promiseResolutionFunctions.shift(),n=t.resolve,r=t.reject;e.type===i.Error?r(e.error):n({done:!1,value:e.value});}else{if(this._values.length>this._bufferLimit-1)throw this._droppedEvents+=1,!this._overflowScenario&&this.newScenario&&(this._overflowScenario=this.newScenario(l.a.OnAsyncIterableObserverOverflow),this._overflowScenario.appendEventData({operationName:this._operationName})),new Error("AsyncIterableObserver buffer is full, all future events will be dropped");this._values.push(e);}},e;}();function d(e,t,n,r){return Object(a.__asyncGenerator)(this,arguments,function(){var i,o,s;return Object(a.__generator)(this,function(c){switch(c.label){case 0:i=new u(t,n,r),o=e.subscribe(i),c.label=1;case 1:return c.trys.push([1,,8,9]),[4,Object(a.__await)(i.nextPromise())];case 2:s=c.sent(),c.label=3;case 3:return!s||s.done?[3,7]:[4,Object(a.__await)(s.value)];case 4:return[4,c.sent()];case 5:return c.sent(),[4,Object(a.__await)(i.nextPromise())];case 6:return s=c.sent(),[3,3];case 7:return[3,9];case 8:return o.unsubscribe(),[7];case 9:return[2];}});});}var p=n("zQSw"),g=n("3J71"),m=n("CVLn"),h=(n("s7wg"),n("IoEE")),f=n("z4q9"),v=n("e4hD"),b=n("YZyc"),y=n("g5XK");var S=function S(e,t){return void 0===t&&(t=!1),e.type===v.e.Chat||e.type===v.e.PhoneChat||e.type===v.e.OneOnOne||!t&&C(e);},C=function C(e){return e.type===v.e.Meeting;};var O,_,T=function T(e){return!!e&&(Object(o.endsWith)(e,v.u)||Object(o.startsWith)(e,v.v));},M=function M(e){return!(!e.properties||!e.properties[v.d.Alerts])&&"true"!==e.properties[v.d.Alerts].toLowerCase();},A=n("FaER"),w=n("vJjW"),I=n("ifNO"),P=function P(e){return"incoming"===e?h.a.CallDirection.Incoming:"outgoing"===e?h.a.CallDirection.Outgoing:h.a.CallDirection.Unknown;},j=function j(e){switch(e){case"missed":return h.a.CallLogCallState.Missed;case"accepted":return h.a.CallLogCallState.Accepted;case"declined":return h.a.CallLogCallState.Declined;case"acceptedElsewhere":return h.a.CallLogCallState.AcceptedElsewhere;default:return h.a.CallLogCallState.Unknown;}},D=function D(e){return"twoParty"===e?h.a.CallLogCallType.TwoParty:"multiParty"===e?h.a.CallLogCallType.MultiParty:h.a.CallLogCallType.Unknown;},E=function E(e){switch(e){case"default":return h.a.CallLogSessionType.Default;case"screenSharing":case"ScreenSharing":return h.a.CallLogSessionType.ScreenSharing;case"emergencyGroupCall":return h.a.CallLogSessionType.EmergencyGroupCall;default:return h.a.CallLogSessionType.Unknown;}},N=function N(e){return Object(a.__assign)({type:"default"},e);},k=function k(e){return{type:e.type,onBehalfOf:e.onBehalfOf&&Object(a.__assign)({type:"default"},e.onBehalfOf),details:e.details&&Object(a.__assign)({type:"default"},e.details)};},R=function R(e,t){if(e)try{var n=JSON.parse(e),r=n.applicationContent,i=n.callDirection,a=n.callId,o=n.callState,s=n.callType,c=n.connectTime,l=n.endTime,u=n.messageId,d=n.originatorParticipant,p=n.participantList,g=n.sessionType,m=n.sharedCorrelationId,h=n.startTime,f=n.targetParticipant,v=n.threadId;return{applicationContent:r&&k(r),callDirection:P(i),callId:a,callState:j(o),callType:D(s),connectTime:c,endTime:l,messageId:u,originatorParticipant:d&&N(d),participantList:p?p.map(N):[],startTime:h,targetParticipant:f&&N(f),threadId:v,sessionType:E(g),sharedCorrelationId:null!=m?m:""};}catch(e){t.newLogger("Call History Helper").log("UnhandledException in message transformation: "+e);}};!function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent";}(O||(O={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent";}(_||(_={}));var U=function U(e){return F(e)===h.a.MessageImportance.Important;},L=function L(e){return _[e]||_.Standard;},F=function F(e){switch(e){case _.Important:case O.Important:return h.a.MessageImportance.Important;case _.Urgent:case O.Urgent:return h.a.MessageImportance.Urgent;case _.Standard:case O.Standard:default:return h.a.MessageImportance.Standard;}},B=n("lMlv"),G=function G(e){return e&&e.startsWith(B.a.Pstn);},x=function x(e){var t=e.slice(B.a.Pstn.length),n=t.indexOf("_");return-1!==n&&(t=t.slice(0,n)),t;},H="unknown_user_from_index_db",V="BOT",z="Guest",W="ADVoiceApp",q="Group",Q="SkypeConsumer",J="TFLUser",K="TFLOffNetwork",X={team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"};var $=function $(e){var t=e.mri,n=e.objectId,r={__typename:"User",id:t||n,objectId:n,mri:t,displayName:e.displayName,givenName:e.givenName,surname:e.surname,type:e.type,jobTitle:e.jobTitle,userPrincipalName:e.userPrincipalName,email:e.email,tenantId:e.tenantId,sipProxyAddress:e.sipProxyAddress,mobile:e.mobile,telephoneNumber:e.telephoneNumber};if(r=ee(e,r),e.featureSettings&&(r=Object(a.__assign)(Object(a.__assign)({},r),{featureSettings:e.featureSettings})),r=Z(e,r),r=Y(e,r),function(e){var t=e;return void 0!==t.isFederated||void 0!==t.isAnonymousB2bUser;}(e)){var i=e.isFederated,o=e.fetchErrorCode,s=e.isAnonymousB2bUser;r=Object(a.__assign)(Object(a.__assign)({},r),{isFederated:i,fetchErrorCode:o,isAnonymousB2bUser:s});}return ne(r);},Z=function Z(e,t){return e.isBlocked&&(t=Object(a.__assign)(Object(a.__assign)({},t),{isBlocked:e.isBlocked})),e.cid&&(t=Object(a.__assign)(Object(a.__assign)({},t),{cid:e.cid})),e.phonesInfo&&(t=Object(a.__assign)(Object(a.__assign)({},t),{phonesInfo:e.phonesInfo})),e.emailsInfo&&(t=Object(a.__assign)(Object(a.__assign)({},t),{emailsInfo:e.emailsInfo})),t;},Y=function Y(e,t){return(function(e){return void 0!==e.userType;}(e)||function(e){var t=e;return t.type?t.type===V:Object(f.e)(e.mri);}(e))&&(t=Object(a.__assign)(Object(a.__assign)({},t),{userType:e.userType,description:e.description,isUnified:e.isUnified,securityEnabled:e.securityEnabled,featureSettings:e.featureSettings,imageUri:e.imageUri,userLocation:e.userLocation})),t;},ee=function ee(e,t){var n=e.phones;return n&&(t=Object(a.__assign)(Object(a.__assign)({},t),{phones:n.map(function(e){return te(e);})})),t;},te=function te(e){return{number:e.number,type:e.type};},ne=function ne(e){var t=e.mri;if(G(t)&&!e.displayName){var n=x(t);return Object(a.__assign)(Object(a.__assign)({},e),{displayName:n,givenName:n});}return e.displayName||(e.displayName="Unknown User"),e;},re=A.a,ie=new Map([["sms",h.a.EscalationModality.SMS],["email",h.a.EscalationModality.Email],["call",h.a.EscalationModality.Call],["teamscall",h.a.EscalationModality.TeamsCall],["etnp",h.a.EscalationModality.ETNP]]),ae=new Set(["RichText/Media_CallRecording","Event/Call"]),oe=function oe(e){return e&&e.emotions?e.emotions.map(function(e){return{key:e.key,users:e.users.map(function(e){var t=e.mri,n=e.time,r=e.value;return{id:re(t),time:n,value:r};})};}):null;},se=function se(e){return e&&e.escalations?JSON.parse(e.escalations).map(function(e){var t=e.key,n=e.users;return{key:ie.get(t),users:n.map(function(e){var t=e.mri,n=e.time,r=e.value;return{mri:re(t),time:n,value:r};})};}):null;},ce=function ce(e,t){return e&&e.mentions?ue(e.mentions,t):null;},le=function le(e,t){return e&&e.onbehalfof?ue(e.onbehalfof,t):null;},ue=function ue(e,t){var n="string"==typeof e?JSON.parse(e):e;return n?n.map(function(e){var n=e.itemid,r=e.mri,i=e.displayName,a=e.mentionType;return{id:t+"_"+n,userId:r,itemId:n,displayName:i,mentionType:a};}):null;},de=function de(e){if(!e||!e.files)return null;try{var t=JSON.parse(null==e?void 0:e.files);return(t=t.filter(function(e){return"deeplink"===e.type;})).map(function(e){var t=e.id,n=e.title,r=e.fileInfo,i=e.channelId;return{id:t,title:n,state:e.state,serverRelativeUrl:r.serverRelativeUrl,channelId:i,siteUrl:r.siteUrl,objectUrl:r.fileUrl};});}catch(e){return null;}},pe=function pe(e){if(!e||!e.files)return null;try{var t=JSON.parse(e.files);return t=t.filter(function(e){return"deeplink"!==e.type;}),Object(o.map)(t,function(e){return ge(e);});}catch(e){return null;}},ge=function ge(e){var t=["http","https"],n=e.filePreview,r=e.chicletBreadcrumbs,i=e.fileInfo,o=e.anchorFileId,s=e.progressComplete,c=e.isUploadError,l=e.fileChicletState,u=i.shareUrl,d=i.shareId,p=i.itemId,g=n||{},m=null==l?void 0:l.serviceName,f=me(e,2),v=f.id,b=f.baseUrl,y=f.objectUrl,S=f.type,C=f.title,O=f.state,_="active"!==O&&"hidden"!==O;return Object(a.__assign)({id:v,itemId:p,chicletBreadcrumbs:r,baseUrl:Object(w.b)(b,t),objectUrl:Object(w.b)(y,t),shareId:d,shareUrl:u,type:S,title:C,fileId:v,isReferencedFile:_,anchorFileId:o,progressComplete:s&&parseInt(s,10)||null,serviceName:m&&h.a.FileViewServiceName[m],state:O&&h.a.FileChicletState[O],hasUploadFailed:c},g);},me=function me(e,t){var n,r,i=e.version,a=e.id,o=e.baseUrl,s=e.objectUrl,c=e.type,l=e.title,u=e.state;if(i!==t&&(a=e.itemid,l=e.fileName,c=e.fileType,s=(n=e.fileInfo).fileUrl,o=n.siteUrl,u=null===(r=e.fileChicletState)||void 0===r?void 0:r.state),"string"!=typeof a)throw Object(I.a)("ChatHelpers",g.c.Undefined,"toFiles",{id:a,version:i,type:c},"File id is missing");return{id:a,baseUrl:o,objectUrl:s,type:c,title:l,state:u};},he=function he(e){return JSON.stringify(Object(o.map)(e,function(e){var t=e.id,n=e.itemId,r=e.baseUrl,i=e.type,a=e.title,o=e.objectUrl,s=e.previewUrl,c=e.shareUrl,l=e.shareId,u=e.state,d=e.chicletBreadcrumbs,p=e.serviceName,g=e.previewHeight,m=e.previewWidth,h=e.progressComplete;return{itemid:t,fileName:a,fileType:i,fileInfo:{itemId:n,fileUrl:o,siteUrl:r,serverRelativeUrl:"",shareUrl:c,shareId:l},fileChicletState:{serviceName:p,state:u},"@type":"http://schema.skype.com/File",version:2,id:t,baseUrl:r,objectUrl:o,type:i,title:a,state:u,chicletBreadcrumbs:d,providerData:{code:null,type:0},botFileProperties:{},isUploadError:e.hasUploadFailed,progressComplete:h,filePreview:{previewUrl:s,previewHeight:g,previewWidth:m}};}));},fe=function fe(e){return e&&JSON.stringify(Object(o.map)(e,function(e){var t=e.content,n=Object(a.__rest)(e,["content"]);return Object(a.__assign)(Object(a.__assign)({},n),{content:JSON.parse(t)});}));},ve=function ve(e,t){if(!e||!e.links)return{urlPreview:null,embeddedLinks:null};try{var n=["http","https"],r=JSON.parse(e.links),i=[],a=[];return r.forEach(function(e){be(e,i,n),ye(e,a,n);}),{urlPreview:a.length>0?a[0]:null,embeddedLinks:i};}catch(e){return t.newLogger("Chat Helper").log("UnhandledException in message transformation: "+e),{urlPreview:null,embeddedLinks:null};}},be=function be(e,t,n){var r=e.url,i=e.fileShareUrlMeta,a=e.title,o=e.description,s=Object(w.b)(r,n);i&&t.push({objectUrl:s,title:a,description:o,fileShareUrlMeta:i});},ye=function ye(e,t,n){var r=e.url,i=e.preview,a=e.previewenabled,o=i||{},s=o.previewurl,c=o.previewmeta,l=o.title,u=o.description,d=Object(w.b)(r,n);t.push({url:d,thumbnail:Object(w.b)(s,n),title:l,description:u,previewEnabled:a,thumbnailMeta:c?{width:c.width,height:c.height}:null});},Se=function Se(e,t){if(!t||!t.cards)return null;try{return JSON.parse(t.cards).map(function(e){var t=e.appIcon,n=e.appId,r=e.appName,i=e.cardClientId,a=e.content,o=e.contentType,s=e.locale;return{appIcon:t,appId:n,appName:r,cardClientId:i,content:JSON.stringify(a),contentType:o,locale:s};});}catch(t){return e.newLogger("Chat Helper").log("UnhandledException in toCards: "+t),null;}},Ce=function Ce(e,t,n,r){var i=r&&r.policyViolation,a=r&&r.genericStreamMetadata;if(!i&&!a)return null;var o={};if("string"==typeof i)try{i=JSON.parse(i);}catch(n){e.newLogger("Chat Helper").log("Exception in parsing PolicyViolation in message: "+t+". Error: "+n);}i&&(o.policyViolation=i);var s=a&&a.policyTip;if("string"==typeof a)try{s=JSON.parse(a).policyTip;}catch(n){e.newLogger("Chat Helper").log("Exception in parsing policy tip in message: "+t+". Error: "+n);}return s&&(o.dlpData={id:t,content:n,policyTip:s}),o;},Oe=function Oe(e,t){if(!t||!t.meeting)return null;try{var n=JSON.parse(t.meeting);return{organizerId:n.organizerId,tenantId:n.tenantId,itemId:n.itemid,meetingTitle:n.meetingtitle,scheduledMeetingInfo:n.scheduledmeetinginfo};}catch(t){return e.newLogger("Chat Helper").log("UnhandledException in toMeeting: "+t),null;}},_e=function _e(e,t,n,r){var i=t||n;if(i)return i;if(r&&ae.has(e)){var a=r.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return a&&a[1]||null;}return null;},Te=function Te(e,t){return"-1"===e?t:e;},Me=function Me(e,t,n){var r=e.id,i=e.content,o=e.originalarrivaltime,s=e.imdisplayname,c=e.from,l=e.messagetype,u=e.properties,d=e.skypeguid,p=e.callId,g=e.clientmessageid,m=e.version,f=e.userHasStarred;return r&&Object(a.__assign)(Object(a.__assign)({__typename:"Message",id:Te(r,g),content:i,originalArrivalTime:o,imDisplayName:s,from:re(c),messageType:je(t,l,u),isImportant:U(u&&u.importance),importance:F(u&&u.importance),interopDeliveryState:u&&u.deliveryState&&u.deliveryState.state,smsDeliveryReports:u&&u.smsDeliveryReports?u.smsDeliveryReports:null,emotions:oe(u),announcement:Ie(u),escalations:se(u),mentions:ce(u,r),onBehalfOf:le(u,r),cards:Se(t,u),files:pe(u),deeplinks:de(u)},ve(u,t)),{deleteTime:u&&u.deletetime,editTime:u&&u.edittime,status:n||h.a.MessageStatus.Delivered,dlpContext:Ce(t,r,i,u),meeting:Oe(t,u),callId:_e(l,p,d||u&&u.skypeguid,i),clientMessageId:g,version:m,callLog:u&&R(u["call-log"],t),userHasSaved:f})||void 0;},Ae=function Ae(e,t){var n=e.id,r=e.from,i=e.messageType,s=e.properties,c=e.version,l=Object(a.__rest)(e,["id","from","messageType","properties","version"]);if(!n)return null;try{return Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({__typename:"Message",id:n,from:r,messageType:je(t,i,s),version:Object(o.isNumber)(c)?c.toString():void 0,isImportant:U(s&&s.importance),importance:F(s&&s.importance),interopDeliveryState:s&&s.deliveryState&&s.deliveryState.state,smsDeliveryReports:(null==s?void 0:s.smsDeliveryReports)||null,emotions:oe(s),announcement:Ie(s),escalations:se(s),mentions:ce(s,n),onBehalfOf:le(s,n),cards:Se(t,s),files:pe(s),deeplinks:de(s)},ve(s,t)),{deleteTime:s&&s.deletetime,editTime:s&&s.edittime,status:h.a.MessageStatus.Delivered,dlpContext:Ce(t,n,l.content,s),meeting:Oe(t,s),callId:s&&s.skypeguid,callLog:s&&R(s["call-log"],t)}),l);}catch(e){return t.newLogger("Chat Helper").log("UnhandledException in message transformation: "+e),Object(a.__assign)({id:n,from:r,messageType:je(t,i,s),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null},l);}},we=function we(e){var t=e.originalArrivalTime,n=e.timeStamp,r=e.clientMessageId;return{originalArrivalTime:new Date(t).toISOString(),timeStamp:new Date(n).toISOString(),clientMessageId:r};},Ie=function Ie(e){var t={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e)return t;var n="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!n||0===n.length)return t;var r=n.find(function(e){return"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType;});if(!r)return t;var i=Pe(r);return{title:e.title?e.title:"",originalImageUrl:i.originalImageUrl,croppedImageUrl:i.croppedImageUrl,colorTheme:i.colorTheme};},Pe=function Pe(e){var t=Object(o.get)(e,"content.imageData.origImage.src",null),n=Object(o.get)(e,"content.imageData.croppedImage.src",null),r=Object(o.get)(e,"content.imageData.colorTheme",null)||Object(o.get)(e,"content.colorTheme",null);return{originalImageUrl:t=void 0===t?null:t,croppedImageUrl:n=void 0===n?null:n,colorTheme:r=void 0===r?null:r};},je=function je(e,t,n){return t===v.l.HTML&&De(e,n)?v.l.Collaborate:t;},De=function De(e,t){var n=Se(e,t);if(!n)return!1;var r=Object(o.find)(n,function(e){return"application/vnd.microsoft.card.fluid"===e.contentType;});return!!r&&!!JSON.parse(r.content).componentUrl;},Ee=function Ee(e,t){if(Object(o.isEmpty)(t))return null;var n=t.split(";"),r=n[0],i=n[1],s=n[2];return Object(a.__assign)({id:e},we({originalArrivalTime:parseInt(r,10),timeStamp:parseInt(i,10),clientMessageId:s}));},Ne=function Ne(e,t,n){var r=t&&t[v.d.SmartReplies];return r&&"string"==typeof r?ke(e,r,n):null;},ke=function ke(e,t,n){try{var r=JSON.parse(t);return Re(e,r);}catch(e){return n.newLogger("Chat Helper").log("Exception in parsing quick reply augmentation. Error: "+e),null;}},Re=function Re(e,t){var n=t&&t.suggestedActivities&&t.suggestedActivities.find(function(e){return"suggestion"===e.type&&e.from&&e.from.id===v.A;});if(!(n&&n.replyToId&&n.timestamp&&n.suggestedActions.actions))return null;var r=n.suggestedActions.actions.map(function(e){return{channelDataId:e.channelData&&e.channelData.id,timestamp:e.channelData&&e.channelData.utcTime,value:e.value};}).filter(function(e){return e.channelDataId&&e.timestamp&&e.value;});return r&&0!==r.length?{convId:e,timestamp:n.timestamp,replyMessageId:n.replyToId,suggestions:r}:null;},Ue=function Ue(e){switch(e){case b.j.None:return h.a.MeetingType.Unknown;case b.j.Adhoc:return h.a.MeetingType.Adhoc;case b.j.Scheduled:return h.a.MeetingType.Scheduled;case b.j.Recurring:return h.a.MeetingType.Recurring;case b.j.Broadcast:return h.a.MeetingType.Broadcast;}},Le=function Le(e){return e&&e.map(function(e){return{id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime};})||null;};var Fe=function Fe(e,t,n,r){try{var i=e.members;return function(e,t,n,r){var i=e.id,o=e.lastMessage,s=e.properties,c=e.threadProperties,l=Ee(i,s[v.d.ConsumptionHorizonBookmark]);return Object(a.__assign)(Object(a.__assign)({},e),{id:i,chatSubType:Ve(c.threadType),chatType:We(c.threadType),consumptionHorizon:Ee(i,s[v.d.ConsumptionHorizon]),consumptionHorizonBookmark:l,smartReplySuggestions:Ne(i,s,n),creator:c[v.C.Creator],isUserMember:Xe(t,r),isDisabled:Ke(c.isDisabled),isLastMessageFromMe:c.isLastMessageFromMe,isMuted:M(e),isOneOnOne:Je(c[v.C.P2PChatUniqueRosterThread]),isRead:c.isRead,lastMessage:o&&Me(o,n),meetingInformation:$e(i,c[v.C.Meeting]),members:t,tenantId:c[v.C.TenantId],title:c.topic,type:null,userConsumptionHorizon:l,interopConversationStatus:Qe(s[v.d.InteropConversationStatus])});}(e,i&&i.length?i.map(function(e){return e.id in t?t[e.id]:function(e){return $(Object(a.__assign)(Object(a.__assign)({},e),{mri:e.id,objectId:"",type:"",userPrincipalName:"",isMuted:e.isReader}));}(e);}):[],n,r);}catch(t){return n.newLogger("Chat Helper").log("UnhandledException in toConversationSchemaFromSkypeConversationLocal transformation: "+t),Object(a.__assign)(Object(a.__assign)({},e),{id:e.id,isUserMember:!1,members:[],type:null});}},Be=function Be(e,t,n){var r=e.id,i=e.members,s=e.consumptionHorizon,c=e.userConsumptionHorizon,l=e.lastMessage,u=e.creator,d=e.meetingInformation,p=e.isDisabled,g=e.isMuted,m=e.isLastMessageFromMe,f=e.isRead,v=e.isOneOnOne,b=e.chatType,y=(e.createdAt,e.interopConversationStatus),S=e.quickReplyAugmentation,C=Object(a.__rest)(e,["id","members","consumptionHorizon","userConsumptionHorizon","lastMessage","creator","meetingInformation","isDisabled","isMuted","isLastMessageFromMe","isRead","isOneOnOne","chatType","createdAt","interopConversationStatus","quickReplyAugmentation"]);try{var O=Object(o.map)(i,$),_=d&&{id:r,subject:d.subject,startTime:d.startTime,endTime:d.endTime,meetingType:d.meetingType?Ue(d.meetingType):h.a.MeetingType.Unknown};return Object(a.__assign)(Object(a.__assign)({__typename:"Conversation"},C),{id:r,consumptionHorizon:s&&Object(a.__assign)({__typename:"ConsumptionHorizon",id:r},we(s)),consumptionHorizonBookmark:c&&Object(a.__assign)({__typename:"ConsumptionHorizonBookmark",id:r},we(c)),userConsumptionHorizon:c&&Object(a.__assign)({__typename:"ConsumptionHorizonBookmark",id:r},we(c)),lastMessage:l&&Ae(l,t),members:O,creator:u,meetingInformation:_,isDisabled:!!p,isMuted:g,isUserMember:Xe(O,n),isLastMessageFromMe:!!m,isRead:f,isOneOnOne:!!v,chatType:We(b),interopConversationStatus:Qe(y),smartReplySuggestions:S&&Re(r,S)});}catch(e){return t.newLogger("Chat Helper").log("UnhandledException in conversation object transformation: "+e),Object(a.__assign)(Object(a.__assign)({},C),{id:r,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,members:[],creator:null,meetingInformation:null,chatType:null});}},Ge=function Ge(e){var t=e.notificationCount,n=e.chatCount;return{notificationCount:t,chatCount:n.teamsChats+n.sfbGatewayChats+n.federatedChats};};function xe(e){return JSON.stringify(Object(o.map)(e,function(e){var t=e.mentionType,n=e.displayName;return{"@type":"http://schema.skype.com/Mention",itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n};}));}var He,Ve=function Ve(e){if(e)return"space"===e||"topic"===e?b.c.Channel:"meeting"===e?b.c.Meeting:b.c.None;},ze=new Map([["chat",h.a.ChatType.Chat],["phonechat",h.a.ChatType.PhoneChat],["meeting",h.a.ChatType.Meeting],["sfbinteropchat",h.a.ChatType.SfBInteropChat]]),We=function We(e){var t=null;return null==e||void 0===(t=ze.get(e))&&(t=null),t;},qe=new Map([["AcceptPending",h.a.InteropConversationStatus.AcceptPending],["Accepted",h.a.InteropConversationStatus.Accepted],["Blocked",h.a.InteropConversationStatus.Blocked]]),Qe=function Qe(e){return e&&qe.get(e)||null;},Je=function Je(e){switch(_typeof(e)){case"string":e="true"===e.toLowerCase();case"boolean":return e;default:return!1;}},Ke=function Ke(e){return Object(o.isString)(e)?"true"===e.toLowerCase():e||!1;},Xe=function Xe(e,t){return!(!(null==t?void 0:t.id)||!e)&&e.some(function(e){return e.id===t.id;});},$e=function $e(e,t){if(t){var n=JSON.parse(t);if(Object.keys(t).length)return Object(a.__assign)(Object(a.__assign)({id:e},n),{meetingType:n.meetingType?Ue(b.j[n.meetingType]):h.a.MeetingType.Unknown});}},Ze=function Ze(e,t,n){var r=oe(n.properties);return!!r&&r.some(function(n){return n.key===e&&!!n.users&&n.users.some(function(e){return e.id===t;});});},Ye=function Ye(e,t){if(e&&e.messagetype===v.c.MemberConsumptionHorizonUpdate){var n=e.conversationid||Object(A.a)(e.conversationLink),r=JSON.parse(e.content);return{__typename:"ConsumptionHorizonUpdate",convId:n,memberConsumptionHorizon:{id:r.user,originalArrivalTime:r.consumptionhorizon,messageVisibilityTime:r.messageVisibilityTime}};}return Object(a.__assign)({__typename:"NewMessage"},function(e,t){var n=Me(e,t);if(!n)throw Object(I.a)("ChatHelpers",g.c.Undefined,"toNewMessageSchema",{resource:e},"Bad shaped NewMessage");var r=null;if(e&&e.conversationLink){var i=Object(f.d)(e);r=i===n.id?null:i;}return{convId:e.conversationid||Object(f.c)(e),replyChainId:r,threadType:e.threadtype,threadTopic:e.threadtopic,message:n};}(e,t));},et=function et(e,t,n){return Object(a.__awaiter)(void 0,void 0,Promise,function(){var r,i,o,s,c,l;return Object(a.__generator)(this,function(u){switch(u.label){case 0:return r=e.id||"",i=e.properties,o=Object(f.a)(e.members,i,[]).members,s=$e(r,i&&i.meeting),o?[4,t(o)]:[3,2];case 1:return l=u.sent(),[3,3];case 2:l=[],u.label=3;case 3:return c=l,[2,{__typename:"ThreadUpdate",conversation:Object(a.__assign)(Object(a.__assign)({id:r,title:i&&i.topic,isOneOnOne:i&&Je(i.uniquerosterthread),isUserMember:Xe(c,n),members:c},s&&{meetingInformation:Object(a.__assign)({id:r},s)}),{chatType:i&&We(i.threadType)})}];}});});},tt=function tt(e){return e&&e.historyHiddenTime||null;},nt=function nt(e){return!!e&&!!e[v.d.Alerts]&&"true"!==e[v.d.Alerts].trim().toLowerCase();},rt=function rt(e,t,n,r){var i=e.resourceType,o=e.resource;return Object(a.__awaiter)(void 0,void 0,Promise,function(){var e,s,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:switch(a.trys.push([0,10,,11]),i){case"NewMessage":return[3,1];case"MessageUpdate":return[3,2];case"ThreadUpdate":return[3,3];case"ConversationUpdate":return[3,5];case"ResolveConversationLie":return[3,6];case"DiscardConversation":return[3,7];}return[3,8];case 1:return e=Ye(o,n),[3,9];case 2:return e=function(e,t){var n;return{__typename:"MessageUpdate",message:Me(e,t),threadType:null===(n=e.properties)||void 0===n?void 0:n.threadType};}(o,n),[3,9];case 3:return[4,et(o,t,r)];case 4:return e=a.sent(),[3,9];case 5:return e=function(e,t){var n=e.properties,r=e.threadProperties,i=e.lastMessage,a=e.isRetentionHorizonSet,o=n&&n.consumptionhorizon||null,s=n&&(n.userConsumptionHorizon||n.consumptionHorizonBookmark)||null,c=e.id||"",l=Ee(c,s);return{__typename:"ConversationUpdate",conversation:{id:c,isUserMember:!1,isDisabled:Ke(r&&r.isDisabled),title:r&&r.topic,consumptionHorizon:Ee(c,o),consumptionHorizonBookmark:l,userConsumptionHorizon:l,smartReplySuggestions:Ne(c,n,t),chatType:r&&We(r.threadType),chatSubType:r&&Ve(r.threadType),lastMessage:Me(i,t),members:[],interopConversationStatus:n&&Qe(n.interopconversationstatus)||null,isRetentionHorizonSet:a,isMuted:nt(n),chatHistoryHiddenTime:tt(n)}};}(o,n),[3,9];case 6:return e={__typename:i,lieConvId:(s=o).id,realConvId:s.realConvId},[3,9];case 7:return e={__typename:i,convId:(s=o).id},[3,9];case 8:return[3,9];case 9:return[3,11];case 10:return c=a.sent(),n.newLogger("ChatHelpers").warn("Error processing chat service event: "+c),[3,11];case 11:return[2,e];}});});};!function(e){e.SfBGatewayChat="@sfb.unq.gbl.spaces",e.OnPremFederatedGatewayChat="@sfbonprem.unq.gbl.spaces",e.FederatedGatewayChat="@fed.unq.gbl.spaces";}(He||(He={}));var it=function it(e){return!!e&&e.endsWith(He.SfBGatewayChat);},at=function at(e){return!!e&&(e.includes(":fed:preview")||e.endsWith(He.FederatedGatewayChat)||e.endsWith(He.OnPremFederatedGatewayChat));},ot=function ot(e,t){return Object(o.filter)(e,Object(o.omit)(t,"__typename"));},st=function st(e){return!!e&&-1!==e.indexOf("preview-");},ct=n("VxlM"),lt=n("DW+Q"),ut=n("f4tu"),dt=n("pybt"),pt=n("8FIh"),gt=n("cvjv"),mt=n("PCsB"),ht=new ut.d(1e4);function ft(e,t,n){return Object(a.__asyncGenerator)(this,arguments,function(){var r;return Object(a.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,8,,10]),[4,Object(a.__await)(n())];case 1:return r=i.sent(),[4,Object(a.__await)(bt({chatService:e,chatServiceEndpointProvider:t,userId:r,delay:new ut.b(2e3,2,12e4)}))];case 2:return[4,a.__await.apply(void 0,[i.sent()])];case 3:return[4,i.sent()];case 4:return i.sent(),[4,Object(a.__await)(Object(dt.a)(12e4))];case 5:return i.sent(),[4,Object(a.__await)("")];case 6:return[4,i.sent()];case 7:return i.sent(),[3,10];case 8:return i.sent(),[4,Object(a.__await)(Object(dt.a)(ht.next()))];case 9:return i.sent(),[3,10];case 10:return[3,0];case 11:return[2];}});});}var vt,bt=Object(pt.a)(function(e){var t=e.chatServiceEndpointProvider,n=e.userId;return Object(gt.a)(t.postActiveEndpoint(n),3e4);},function(e,t){var n=t.delay;return Object(a.__awaiter)(void 0,void 0,void 0,function(){return Object(a.__generator)(this,function(t){if(e.context===g.d.RequireStatus&&Object(mt.a)(Object(I.d)(e,"status",0))||e.context===g.d.Timed||e instanceof TypeError)throw e;return[2,Object(dt.a)(n.next())];});});}),yt=n("jN5E");function St(e,t){function n(e){if(!Object(o.isArray)(e)&&!Object(o.isObject)(e)||Object(o.isDate)(e))return e;var n={};Object(o.forOwn)(e,function(e,r){n[r]=St(e,t);});var r=n,i=t;r[i];return Object(a.__rest)(r,["symbol"==_typeof(i)?i:i+""]);}return Object(o.isArray)(e)?e.map(n):n(e);}!function(e){e.mention="http://schema.skype.com/Mention",e.inputExtension="http://schema.skype.com/InputExtension",e.amsVideo="http://schema.skype.com/AMSVideo",e.amsImage="http://schema.skype.com/AMSImage",e.emoji="http://schema.skype.com/Emoji",e.live="http://schema.skype.com/Live",e.giphy="http://schema.skype.com/Giphy",e.filesHyperlink="http://schema.skype.com/HyperLink/Files",e.hyperLink="http://schema.skype.com/HyperLink",e.reply="http://schema.skype.com/Reply",e.fluidLink="http://schema.skype.com/FluidLink";}(vt||(vt={}));function Ct(e,t){return JSON.stringify(Object(a.__spreadArrays)(function(e){return Object(o.map)(Object(o.compact)(e),function(e,t){return{"@type":vt.hyperLink,itemid:t.toString(),url:e.url,previewenabled:e.previewEnabled,preview:{previewurl:e.thumbnail,previewmeta:e.thumbnailMeta,title:e.title,description:e.description}};});}(e),function(e){return e=St(e,"__typename"),Object(o.map)(Object(o.compact)(e),function(e){return{"@type":vt.hyperLink,title:e.title,description:e.description,fileShareUrlMeta:e.fileShareUrlMeta,url:e.fileShareUrlMeta&&e.fileShareUrlMeta.shareUrl};});}(t)));}function Ot(e,t){return Object(a.__awaiter)(this,void 0,Promise,function(){var n,r,i,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=Object(o.uniqBy)(e,function(e){return e.id;}),r=Object(o.chunk)(n.map(function(e){return e.id;}),t.MAX_PEOPLE_MRI_LIMIT),[4,Promise.all(r.map(function(e){return t.getPeopleProfilesByMris(e);}))];case 1:return i=a.sent(),s=[],i.forEach(function(e){s=s.concat(Array.from(e.values(),$));}),[2,s];}});});}var _t=function _t(e,t,n,r,i,o){return Object(a.__awaiter)(void 0,void 0,Promise,function(){return Object(a.__generator)(this,function(a){return[2,i?Tt(e,i,n,r,o):Mt(e,t,n,o)];});});};function Tt(e,t,n,r,i){return Object(a.__awaiter)(this,void 0,Promise,function(){var o,s;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,t.getConversation(e)];case 1:return(o=a.sent())?[4,At([o],r)]:[2,{id:e,members:[]}];case 2:return s=a.sent(),[2,Fe(o,s,n,i)];}});});}var Mt=function Mt(e,t,n,r){return Object(a.__awaiter)(void 0,void 0,Promise,function(){var i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,t.getChat(e)];case 1:return i=a.sent(),[2,Be(i,n,r)];}});});},At=function At(e,t){return Object(a.__awaiter)(void 0,void 0,Promise,function(){var n,r,i;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return n=[],e.forEach(function(e){return e.members&&e.members.forEach(function(e){n.push(e);});}),[4,Ot(n,t)];case 1:return r=a.sent(),i={},r.forEach(function(e){i[e.id]=e;}),[2,i];}});});},wt=function wt(e,t,n,r,i){return Object(a.__awaiter)(void 0,void 0,Promise,function(){var o,s,c,l,u,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return o=e.event,"LongPollEventPublisher"!==(s=e.source)?[3,2]:(l=o).resource&&l.resource.messagetype===v.c.MemberConsumptionHorizonUpdate?[4,rt(l,t,n,i)]:[2,void 0];case 1:return c=a.sent(),[3,4];case 2:return"ConversationManager"!==s?[3,4]:[4,At([u=o],r)];case 3:d=a.sent(),c={__typename:"ConversationUpdate",conversation:Fe(u,d,n,i)},a.label=4;case 4:return[2,c];}});});},It=function It(e,t,n,r,i){return Object(a.__awaiter)(void 0,void 0,Promise,function(){var o,s,c,l,u,d,p,g;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,n.getChat(e)];case 1:if(o=a.sent(),s=o&&o.members,c=o&&o.isOneOnOne,l=r.newLogger("Chat Resolvers"),u=new m.a(i),!(c||s&&s.length<=u.maxRosterSizeInGroupChatChatServiceLimit))return[3,6];a.label=2;case 2:return a.trys.push([2,4,,5]),[4,t.getMembersConsumptionHorizon(e)];case 3:return d=a.sent(),[3,5];case 4:return p=a.sent(),l.error("fail to fetch consumption horizon data from server because: "+p),[3,5];case 5:return[3,7];case 6:l.log("chat "+e+" is not supported for read receipt."),a.label=7;case 7:return g=d&&d.consumptionhorizons,[2,Le(g)];}});});},Pt=function Pt(e){return e?e.map(function(e){return{id:e.id,title:e.title,channelId:e.channelId,siteUrl:e.siteUrl,serverRelativeUrl:e.serverRelativeUrl,objectUrl:e.objectUrl,state:e.state,__typename:"DeepLink"};}):null;},jt=function jt(e,t,n){return Object(a.__awaiter)(void 0,void 0,Promise,function(){var r,i,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return r=[],e.forEach(function(e){return r.push({id:e});}),i=2,[4,Ot(r,t)];case 1:return o=a.sent(),[2,{__typename:"Conversation",id:v.m.SkypeSpacesThread+"preview-"+Object(yt.v4)(),title:n,members:o,isDisabled:!1,isOneOnOne:e.length===i,isRead:!1,chatType:h.a.ChatType.Chat,type:h.a.ChatType.Chat}];}});});},Dt=function Dt(e,t,n,r){return void 0===r&&(r=""),Object(a.__awaiter)(void 0,void 0,Promise,function(){var i;return Object(a.__generator)(this,function(o){return i=t&&1===t.length?{uniquerosterthread:!0,fixedRoster:!0}:{},[2,e.createThread(n,r,Object(a.__assign)({threadType:"chat",chatFilesIndexId:2},i))];});});},Et=function Et(e,t){var n=e.content,r=e.messageType,i=e.clientMessageId,s=e.files,c=e.deeplinks,l=e.importance,u=e.computed;void 0===t&&(t={});var d,p=void 0===u?{}:u,g=p.mentions,m=p.urlPreview,f=p.embeddedLinks,v=Object(o.map)(g,function(e){e.__typename;var t=e.userId,n=Object(a.__rest)(e,["__typename","userId"]);return Object(a.__assign)(Object(a.__assign)({},n),{userId:t,id:t});}),b=Object(o.map)(s,function(e){e.__typename;var t=e.chicletBreadcrumbs,n=Object(a.__rest)(e,["__typename","chicletBreadcrumbs"]);return Object(a.__assign)({previewUrl:"",previewWidth:null,previewHeight:null,chicletBreadcrumbs:t?{__typename:"ChicletBreadcrumbs",sourceChannelName:t.sourceChannelName||null,sourceTeamName:t.sourceTeamName||null}:null},n);}),y=function(e){return e?Object(a.__assign)(Object(a.__assign)({},e),{thumbnailMeta:e.thumbnailMeta?Object(a.__assign)(Object(a.__assign)({},e.thumbnailMeta),{__typename:"ImageMeta"}):null,__typename:"UrlPreview"}):null;}(m),S=(d=f)?d.map(function(e){var t=e.fileShareUrlMeta?Object(a.__assign)(Object(a.__assign)({},e.fileShareUrlMeta),{__typename:"FileShareUrlMeta"}):null;return Object(a.__assign)(Object(a.__assign)({},e),{__typename:"EmbeddedLink",fileShareUrlMeta:t});}):null;return Object(a.__assign)({content:n,contentType:"text",messageType:r,clientMessageId:i,isImportant:l===h.a.MessageImportance.Important,status:h.a.MessageStatus.Delivered,mentions:v,files:b,deeplinks:Pt(c),urlPreview:y,embeddedLinks:S,emotions:null},t);},Nt="ChatResolvers",kt=207,Rt=206,Ut=40318;function Lt(e){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,e.getUser()];case 1:return[2,t.sent().profile.oid];}});});}function Ft(e,t,n,r,i){return Object(a.__awaiter)(this,void 0,Promise,function(){var o,s,c,l,u,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(o=[],s=i.newLogger("Chat Resolvers"),c=r.get(p.a.Messaging).enableInformationBarrierInMW,l=new m.a(n).enableInformationBarrier,!(c&&l)||e!==kt)return[2,o];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,t.json()];case 2:return(u=a.sent())&&u.multipleStatus&&u.multipleStatus.forEach(function(e){e&&e.statusCode===Rt&&e.statusSubCode===Ut&&o.push({id:e.id});}),[2,o];case 3:return d=a.sent(),s.error("fail to check for IB rejected users: "+d),[2,o];case 4:return[2];}});});}function Bt(e,t,n,r,i){return Object(a.__awaiter)(this,void 0,Promise,function(){var o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,Ft(e,t,n,r,i)];case 1:return[2,(o=a.sent())&&o.length>0];}});});}var Gt={Query:{chats:function chats(e,t,n){var r=t.first,i=t.after,o=n.getCSAService,s=n.conversationManager,c=n.getPeopleService,l=n.loggerFactory,u=n.user;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,d,p,g,m,h,f,v,b;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e=[],t=null,n=null,s?[4,s.getConversations(function(e){return S(e);})]:[3,4];case 1:return d=a.sent(),g=At,m=[d],[4,c()];case 2:return[4,g.apply(void 0,m.concat([a.sent()]))];case 3:return p=a.sent(),e=d.map(function(e){return function(e,t,n,r){return{node:Fe(e,t,n,r),cursor:e.id};}(e,p,l,u);}),n=!1,[3,8];case 4:return a.trys.push([4,7,,8]),[4,o()];case 5:return[4,a.sent().getChats(r,i)];case 6:return h=a.sent(),f=h.items,v=h.continuationToken,t=v,e=f.map(function(e){return function(e,t,n){return{node:Be(e,t,n),cursor:e.createdAt||e.id};}(e,l,u);}),n=!!t,[3,8];case 7:return b=a.sent(),l.newLogger("Chats Resolver").error("Unable to resolve chats: ",b),[2,Promise.reject(b)];case 8:return[2,{edges:e,pageInfo:{endCursor:t,hasNextPage:n}}];}});});},messages:function messages(e,t,n){var r=t.convId,i=t.cursor,o=n.getCSAService,s=n.loggerFactory;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return st(r)?[2,{messages:[]}]:[3,1];case 1:return[4,o()];case 2:return[4,a.sent().getMessages(r,i)];case 3:return e=a.sent(),t=e.messages,n=e.messageToken,[2,{messages:t.map(function(e){return Ae(e,s);}).sort(function(e,t){var n=new Date(e.originalArrivalTime);return new Date(t.originalArrivalTime).valueOf()-n.valueOf();}),cursor:n,dataSource:"network"}];}});});},message:function message(e,t,n){var r=t.convId,i=t.messageId,o=n.getCSAService,s=n.loggerFactory;return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,o()];case 1:return[4,t.sent().getMessage(r,i)];case 2:return e=t.sent(),[2,{message:Ae(e,s)}];}});});},chat:function chat(e,t,n){var r=t.convId,i=n.conversationManager,o=n.getCSAService,s=n.getPeopleService,c=n.loggerFactory,l=n.user;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return[4,o()];case 1:return e=n.sent(),[4,s()];case 2:return t=n.sent(),[2,_t(r,e,c,t,i,l)];}});});},chatWithUser:function chatWithUser(e,t,n){var r=t.userId,i=t.createLieIfNotFound,o=n.getCSAService,s=n.discover,c=n.getPeopleService,l=n.loggerFactory,u=n.user;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,d,p,m,h,f,v;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,s.skypeid()];case 1:return e=a.sent(),t=Object(ct.a)(e,r),n=null,[4,o()];case 2:d=a.sent(),a.label=3;case 3:return a.trys.push([3,6,,7]),p=_t,m=[t,d,l],[4,c()];case 4:return[4,p.apply(void 0,m.concat([a.sent(),void 0,u]))];case 5:return n=a.sent(),[3,7];case 6:if(h=a.sent(),!Object(I.h)(h,g.d.RequireStatus,g.c.RemoteOperationFailed,{requiredStatus:g.h.OK,status:g.h.NOT_FOUND}))throw h;return[3,7];case 7:return n||!i?[3,10]:(f=jt,v=[[e,r]],[4,c()]);case 8:return[4,f.apply(void 0,v.concat([a.sent()]))];case 9:n=a.sent(),a.label=10;case 10:return[2,n];}});});},chatsWithUsers:function chatsWithUsers(e,t,n){var r=t.userIds,i=t.filters,o=t.partialMatch,s=t.topicName,l=t.createLieIfNotFound,u=n.cache,d=n.getCSAService,p=n.getPeopleService,g=n.loggerFactory,m=n.user;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,h,f;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e=[],[4,d()];case 1:return[4,a.sent().getChatsWithUsers(r,!!o)];case 2:return(t=a.sent())&&(e=ot(t.map(function(e){return Be(e,g,m);}),i||{}),s&&(e=e.filter(function(e){return e.title===s;}))),0===e.length&&l?(h=jt,f=[r],[4,p()]):[3,5];case 3:return[4,h.apply(void 0,f.concat([a.sent(),s]))];case 4:n=a.sent(),u.writeQuery({query:c,variables:{convId:n.id},data:{chat:n}}),e.push(n),a.label=5;case 5:return[2,e];}});});},unreadCounts:function unreadCounts(e,t,n){var r=n.getCSAService;return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,r()];case 1:return[4,e.sent().getBadges()];case 2:return[2,e.sent().map(Ge)[0]];}});});},chatsByTitle:function chatsByTitle(e,t,n){var r=t.title,i=t.filters,o=n.getCSAService,s=n.loggerFactory,c=n.user;return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,o()];case 1:return[4,t.sent().getChatsByTitle(r)];case 2:return[2,(e=t.sent())?ot(e.map(function(e){return Be(e,s,c);}),i||{}):[]];}});});},membersConsumptionHorizon:function membersConsumptionHorizon(e,t,n){var r=t.convId,i=n.getChatService,o=n.getCSAService,s=n.loggerFactory,c=n.settingsService;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return[4,o()];case 1:return e=n.sent(),[4,i()];case 2:return t=n.sent(),[2,It(r,t,e,s,c)];}});});},searchUsersByConversation:function searchUsersByConversation(e,t,n){var r=t.convId,i=t.searchQuery,s=t.searchExactMatches,c=n.conversationManager,l=n.getCSAService,u=n.discover,d=n.getPeopleService,p=n.loggerFactory,g=n.user;return Object(a.__awaiter)(this,void 0,Promise,function(){var e,t,n,m,h,f,v,b,y,S,C;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(!r)throw new Error("ConvId null not supported");return[4,l()];case 1:return e=a.sent(),n=_t,m=[r,e,p],[4,d()];case 2:return[4,n.apply(void 0,m.concat([a.sent(),c,g]))];case 3:if(!(t=a.sent()))throw new Error("Conversation could not be found, convId - "+r);if(h=t.members,i){if(f=i.indexOf("@"),2,v=-1!==f,b=i.substring(f).replace(" "," ").replace(/^@/,""),h.length<=2&&!v)return[2,[]];b&&(y=Object(o.escapeRegExp)(b),S=!v&&s?new RegExp("(?:^|\\W)"+y+"(?:$|\\W)","i"):new RegExp("((?:^|\\b|\\.)"+y+")","i"),h=Object(o.filter)(h,function(e){return!Object(o.isNil)(e)&&!Object(o.isNil)(e.displayName)&&S.test(e.displayName)||!Object(o.isNil)(e.email)&&S.test(e.email);}));}return[4,u.skypeid()];case 4:return C=a.sent(),h=Object(o.filter)(h,function(e){return e.id!==C;}),5,[2,h=Object(o.take)(h,5)];}});});}},Mutation:{sendMessage:function sendMessage(e,t,n){var r=t.convId,i=t.message,s=t.action,c=n.authenticationService,l=n.discover,u=n.getChatService,d=n.getPeopleService;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,p,g,m,h,f,v,b,y,S,C,O,_,M,A,w,I,P,j;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[4,Promise.all([c.getUser(),l.skypeid()])];case 1:return e=a.sent(),t=e[0].profile.name,n=e[1],[4,u()];case 2:return p=a.sent(),function(e){return it(e)||at(e)||T(e);}(r)?[4,p.getThread(r)]:[3,7];case 3:return f=a.sent(),[4,l.skypeid()];case 4:return v=a.sent(),y=Ot,S=[f.members],[4,d()];case 5:return[4,y.apply(void 0,S.concat([a.sent()]))];case 6:b=a.sent(),C=Object(o.find)(b,function(e){return e.mri===v;}),m=C&&C.sipProxyAddress,O=Object(o.find)(b,function(e){return e.mri!==v;}),h=O&&O.sipProxyAddress,g="receiverSfB",i.messageType="Text",a.label=7;case 7:switch(_=function(e,t,n){void 0===n&&(n={fromSipUri:void 0,toSipUri:void 0,interopType:void 0});var r=e.content,i=e.importance,a=e.subject,o=e.files,s=e.computed,c=void 0===s?{}:s,l=e.id,u=e.messageType,d=e.clientMessageId,p=c,g=p.urlPreview,m=p.mentions,h=p.cards,f=p.embeddedLinks;return{id:l,messagetype:u,contenttype:"text",content:r,imdisplayname:t,clientmessageid:d,amsreferences:c.amsReferences,fromSipUri:n&&n.fromSipUri||void 0,toSipUri:n&&n.toSipUri||void 0,properties:{importance:L(i),subject:a,cards:fe(h),links:Ct(g?[g]:[],f||[]),mentions:xe(m),files:he(o),policyViolation:e.policyViolation,interopType:n&&n.interopType}};}(i,t,{fromSipUri:m,toSipUri:h,interopType:g}),s){case lt.a.Create:return[3,8];case lt.a.Update:return[3,10];}return[3,12];case 8:return[4,p.postMessageToConversation(r,_)];case 9:return A=a.sent(),P=A.id,w=A.originalarrivaltime,M=Et(i,{id:P,originalArrivalTime:new Date(w).toISOString(),from:n,imDisplayName:n}),[3,13];case 10:return[4,p.updateMessageInConversation(r,_)];case 11:return a.sent(),P=(I=i).id,j=I.originalArrivalTime,M=Et(i,{id:P,originalArrivalTime:j,editTime:new Date().toISOString(),from:n,imDisplayName:n}),[3,13];case 12:throw new RangeError("Invalid action type for sendMessage");case 13:return[2,M];}});});},createChat:function createChat(e,t,n){var r=t.userIds,i=t.topicName;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,s,c,l,u,d,p,g,m,h,f,v,b,y,S,C,O,_;return Object(a.__generator)(this,function(T){switch(T.label){case 0:return e=n.coreSettings,t=n.getChatService,s=n.getCSAService,c=n.discover,l=n.getPeopleService,u=n.loggerFactory,d=n.settingsService,p=n.user,[4,c.skypeid()];case 1:return g=T.sent(),m=function(e,t){return t&&Object(o.remove)(t,function(t){return t===e;}),t&&Object(a.__spreadArrays)([{id:e,role:"Admin"}],t.map(function(e){return{id:e,role:"Admin"};}));}(g,r),[4,t()];case 2:return h=T.sent(),[4,Dt(h,r,m,i||"")];case 3:return f=T.sent(),v=f.threadId,b=f.status,y=f.responseBody,[4,Bt(b,y,d,e,u)];case 4:return S=T.sent(),[4,s()];case 5:return C=T.sent(),O=_t,_=[v,C,u],[4,l()];case 6:return[4,O.apply(void 0,_.concat([T.sent(),void 0,p]))];case 7:return[2,{conversation:T.sent(),hasIBPolicyRejectedUsers:S}];}});});},addMembersToConversation:function addMembersToConversation(e,t,n){var r=t.convId,i=t.members,s=t.shareHistoryTime,c=n.coreSettings,l=n.getChatService,u=n.getPeopleService,d=n.loggerFactory,p=n.settingsService;return Object(a.__awaiter)(this,void 0,Promise,function(){var e,t,n,g,m;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return[],e=!1,st(r)?[3,4]:(!Object(o.isNil)(s)&&s>0&&(864e5,s=Date.now()-864e5*s),[4,l()]);case 1:return[4,a.sent().addMembersToThread(r,i,Object(o.isNil)(s)?void 0:s)];case 2:return[4,Ft((t=a.sent()).status,t.body,p,c,d)];case 3:n=a.sent(),e=n&&n.length>0,Object(o.pullAllBy)(i,n,"id"),a.label=4;case 4:return g=Ot,m=[i],[4,u()];case 5:return[4,g.apply(void 0,m.concat([a.sent()]))];case 6:return[2,{users:a.sent(),hasIBPolicyRejectedUsers:e}];}});});},removeMemberFromConversation:function removeMemberFromConversation(e,t,n){var r=t.convId,i=t.userId,o=n.getChatService;return Object(a.__awaiter)(this,void 0,Promise,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,o()];case 1:return[4,e.sent().removeMemberFromThread(r,i)];case 2:return e.sent(),[2,i];}});});},updateMessageEmotion:function updateMessageEmotion(e,t,n){var r=t.convId,i=t.messageId,o=t.key,s=t.action,c=n.discover,l=n.getChatService;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return[4,c.skypeid()];case 1:return e=n.sent(),[4,l()];case 2:if(t=n.sent(),!o)return[2,s===h.a.EmotionAction.remove?{id:""}:{id:e}];switch(s){case h.a.EmotionAction.add:return[3,3];case h.a.EmotionAction.remove:return[3,5];}return[3,7];case 3:return[4,t.addMessageEmotion(r,i,o)];case 4:return n.sent(),[2,{id:e}];case 5:return[4,t.removeMessageEmotion(r,i,o)];case 6:return n.sent(),[2,{id:""}];case 7:throw Object(I.a)(Nt,g.c.NotImplemented,"updateMessageEmotion",{action:s});}});});},saveMessage:function saveMessage(e,t,n){var r=t.convId,i=t.messageId,o=n.discover,s=n.getChatService;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,c,l,u,d,p,m,f;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e=h.a.EmotionKey.star,[4,o.skypeid()];case 1:return t=a.sent(),[4,s()];case 2:return[4,(n=a.sent()).getConversationMessage(r,i)];case 3:if(c=a.sent(),Ze(e,t,c))throw Object(I.a)(Nt,g.c.AlreadyPresent,"saveMessage");return[4,n.addMessageEmotion(r,i,e)];case 4:a.sent(),a.label=5;case 5:return a.trys.push([5,7,,9]),l=function(e){var t=e.id,n=e.conversationid,r=e.imdisplayname,i=e.from,a=e.composetime;return t&&{"@type":"http://schema.skype.com/StarredMessage",mri:re(i),imdisplayname:r,messageId:t,parentMessageId:t,threadId:n,isUnresolvedEmailUser:!1,originalComposeTime:a};}(c),u=c.messagetype,d=c.content,p=c.imdisplayname,m={messagetype:u,content:d,imdisplayname:p,properties:{starred:l}},[4,n.postMessageToConversation("48:starred",m)];case 6:return a.sent(),[3,9];case 7:return f=a.sent(),[4,n.removeMessageEmotion(r,i,e)];case 8:throw a.sent(),f;case 9:return[2,{id:t}];}});});},unsaveMessage:function unsaveMessage(e,t,n){var r=t.convId,i=t.messageId,o=n.getChatService,s=n.getCSAService,c=n.discover;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,l,u,d,p;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e=h.a.EmotionKey.star,[4,c.skypeid()];case 1:return t=a.sent(),[4,o()];case 2:return[4,(n=a.sent()).getConversationMessage(r,i)];case 3:if(l=a.sent(),!Ze(e,t,l))throw Object(I.a)(Nt,g.c.NotPresent,"unsaveMessage");return[4,n.removeMessageEmotion(r,i,e)];case 4:a.sent(),a.label=5;case 5:return a.trys.push([5,10,,12]),[4,s()];case 6:return[4,a.sent().getMessages("48:starred")];case 7:return u=a.sent().messages,(d=function(e,t,n){var r=n.find(function(n){try{var r=JSON.parse((n.properties||{}).starred),i=r&&"http://schema.skype.com/StarredMessage"===r["@type"]&&r.threadId===t?r.messageId:void 0;return e===i;}catch(e){return!1;}});return r&&r.id;}(i,r,u))?[4,n.markStarredMessageAsDeleted(d)]:[3,9];case 8:a.sent(),a.label=9;case 9:return[3,12];case 10:return p=a.sent(),[4,n.addMessageEmotion(r,i,e)];case 11:throw a.sent(),p;case 12:return[2,null];}});});},deleteMessage:function deleteMessage(e,t,n){var r=t.convId,i=t.messageId,o=n.getChatService;return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,o()];case 1:return[4,e.sent().deleteMessage(r,i)];case 2:return e.sent(),[2,{id:i}];}});});},undeleteMessage:function undeleteMessage(e,t,n){var r=t.convId,i=t.messageId,o=n.getChatService;return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,o()];case 1:return[4,e.sent().undeleteMessage(r,i)];case 2:return e.sent(),[2,{id:i}];}});});},sendTypingIndicator:function sendTypingIndicator(e,t,n){var r=t.convId,i=n.getChatService;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e={messagetype:"Control/Typing",contenttype:"Application/Message",content:""},[4,i()];case 1:return[4,a.sent().postMessageToConversation(r,e)];case 2:return t=a.sent(),n=t.id,o=t.originalarrivaltime,[2,{id:n,originalArrivalTime:new Date(o).toISOString(),content:e.content,contentType:e.contenttype,messageType:e.messagetype,isImportant:!1,clientMessageId:e.clientmessageid}];}});});},setConsumptionHorizon:function setConsumptionHorizon(e,t,n){var r=t.convId,i=t.message,o=i.originalArrivalTime,s=i.clientMessageId,c=n.getChatService;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n;return Object(a.__generator)(this,function(i){switch(i.label){case 0:e=Date.now(),t=new Date(o||"").valueOf()+";"+e+";"+s,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,c()];case 2:return[4,i.sent().setConversationConsumptionHorizon(r,t)];case 3:return i.sent(),[3,5];case 4:return n=i.sent(),[2,Promise.reject(n)];case 5:return[2,{id:r,timeStamp:new Date(e).toISOString(),originalArrivalTime:o,clientMessageId:s}];}});});},setConsumptionHorizonBookmark:function setConsumptionHorizonBookmark(e,t,n){var r=t.convId,i=t.message,o=i.originalArrivalTime,s=i.clientMessageId,c=n.getChatService;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,l;return Object(a.__generator)(this,function(a){switch(a.label){case 0:e=Date.now(),t=new Date(o||""),n="0"===o?"0":""+(t.valueOf()-1),i=n+";"+e+";"+s,a.label=1;case 1:return a.trys.push([1,4,,5]),[4,c()];case 2:return[4,a.sent().setConversationConsumptionHorizon(r,i,!0)];case 3:return a.sent(),[3,5];case 4:return l=a.sent(),[2,Promise.reject(l)];case 5:return[2,{id:r,timeStamp:new Date(e).toISOString(),originalArrivalTime:"0"===n?"0":new Date(t.valueOf()-1).toISOString(),clientMessageId:s}];}});});},updateMessageLinks:function updateMessageLinks(e,t,n){var r=t.convId,i=t.messageId,o=t.links,s=n.getChatService;return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,s()];case 1:return[4,e.sent().updateMessageLinks(r,i,{links:o})];case 2:return e.sent(),[2,!0];}});});}},Subscription:{chatServiceEvent:{subscribe:function subscribe(e,t,n){var r=t.conversationId,i=n.authenticationService,o=n.conversationManager,c=n.getChatService,l=n.getChatServiceEndpointProvider,u=n.getPeopleService,p=n.getStatefulLongPoll,m=n.loggerFactory,h=n.longPollEventPublisher,f=n.user;return Object(a.__asyncGenerator)(this,arguments,function(){var e,t,n,v,b,y,S,C,O,_,T,M,A,w,P,j,D,E,N,k,R,U,L=this;return Object(a.__generator)(this,function(F){switch(F.label){case 0:return e=function e(_e2){return Object(a.__awaiter)(L,void 0,void 0,function(){var t,n;return Object(a.__generator)(this,function(r){switch(r.label){case 0:return t=Ot,n=[_e2],[4,u()];case 1:return[2,t.apply(void 0,n.concat([r.sent()]))];}});});},[4,Object(a.__await)(c())];case 1:if(t=F.sent(),!o||!h)return[3,18];n=o,A=new s(function(e){n.subscribe(function(t){e.next({event:t,source:"ConversationManager"});}),h.observable.subscribe(function(t){e.next({event:t,source:"LongPollEventPublisher"});});}),F.label=2;case 2:F.trys.push([2,11,12,17]),v=Object(a.__asyncValues)(d(A)),F.label=3;case 3:return[4,Object(a.__await)(v.next())];case 4:return(b=F.sent()).done?[3,10]:(y=b.value,S=wt,C=[y,e,m],[4,Object(a.__await)(u())]);case 5:return[4,a.__await.apply(void 0,[S.apply(void 0,C.concat([F.sent(),f]))])];case 6:return(D=F.sent())?[4,Object(a.__await)({chatServiceEvent:D})]:[3,9];case 7:return[4,F.sent()];case 8:F.sent(),F.label=9;case 9:return[3,3];case 10:return[3,17];case 11:return O=F.sent(),N={error:O},[3,17];case 12:return F.trys.push([12,,15,16]),b&&!b.done&&(k=v.return)?[4,Object(a.__await)(k.call(v))]:[3,14];case 13:F.sent(),F.label=14;case 14:return[3,16];case 15:if(N)throw N.error;return[7];case 16:return[7];case 17:return[3,36];case 18:return[4,Object(a.__await)(l?l():Promise.resolve(void 0))];case 19:return _=F.sent(),[4,Object(a.__await)(p?p():Promise.resolve(void 0))];case 20:if(T=F.sent(),!_||!T)throw Object(I.a)(Nt,g.c.NotPresent,"chatServiceEvent");return[4,Object(a.__await)(Lt(i))];case 21:M=F.sent(),A=T.poll({chatService:t,chatServiceEndpointProvider:_,currentUserId:M,sendActiveTimeoutParam:!1}),F.label=22;case 22:F.trys.push([22,30,31,36]),w=Object(a.__asyncValues)(d(A)),F.label=23;case 23:return[4,Object(a.__await)(w.next())];case 24:return(P=F.sent()).done?[3,29]:(j=P.value,[4,Object(a.__await)(rt(j,e,m,f))]);case 25:if(!(D=F.sent()))return[3,28];if(r){if(("ThreadUpdate"===D.__typename||"ConversationUpdate"===D.__typename)&&D.conversation.id!==r)return[3,28];if("NewMessage"===D.__typename&&D.convId!==r)return[3,28];}return[4,Object(a.__await)({chatServiceEvent:D})];case 26:return[4,F.sent()];case 27:F.sent(),F.label=28;case 28:return[3,23];case 29:return[3,36];case 30:return E=F.sent(),R={error:E},[3,36];case 31:return F.trys.push([31,,34,35]),P&&!P.done&&(U=w.return)?[4,Object(a.__await)(U.call(w))]:[3,33];case 32:F.sent(),F.label=33;case 33:return[3,35];case 34:if(R)throw R.error;return[7];case 35:return[7];case 36:return[2];}});});}},chatServicePostActiveEvent:{subscribe:function subscribe(e,t,n){var r=n.authenticationService,i=n.getChatServiceEndpointProvider,o=n.getChatService;return Object(a.__asyncGenerator)(this,arguments,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:return[4,Object(a.__await)(o())];case 1:return e=n.sent(),[4,Object(a.__await)(i())];case 2:return t=n.sent(),[5,Object(a.__values)(Object(a.__asyncDelegator)(Object(a.__asyncValues)(ft(e,t,function(){return Lt(r);}))))];case 3:return[4,a.__await.apply(void 0,[n.sent()])];case 4:return n.sent(),[2];}});});}}}},xt=n("Dxz4"),Ht=n("lBu+"),Vt=n("nedL"),zt=n("vtvO"),Wt=n("BP+w");var qt,Qt,Jt,Kt=function(){function e(e,t,n){this.onBatchReady=e,this.batchingIntervalInMs=t,this.maxBatchRequests=n,this.intervalId=null,this.queue=[];}return e.prototype.submit=function(e){var t=function(){var e={};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n;}),e;}();return this.queue.push({request:e,deferred:t}),this.maxBatchRequests&&this.queue.length>=this.maxBatchRequests?(this.stop(),this.processQueue()):this.start(),t.promise;},e.prototype.start=function(){var e=this;this.intervalId||(this.intervalId=Object(Wt.a)().setInterval(function(){return e.processQueue();},this.batchingIntervalInMs));},e.prototype.stop=function(){this.intervalId&&(Object(Wt.a)().clearInterval(this.intervalId),this.intervalId=null);},e.prototype.processQueue=function(){var e=this,t=this.queue.length;if(t>0){var n=this.queue.splice(0,t);this.onBatchReady(n.map(function(e){return e.request;})).then(function(t){return e.processBatchResults(n,t);}).catch(function(t){return e.processBatchError(n,t);});}else this.stop();},e.prototype.processBatchResults=function(e,t){Object(o.zipWith)(e,t,function(e,t){t instanceof Error?e.deferred.reject(t):e.deferred.resolve(t);});},e.prototype.processBatchError=function(e,t){Object(o.each)(e,function(e){e.deferred.reject(t);});},e;}();!function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchPeopleFilter="searchPeopleFilter",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.escalateMessage="escalateMessage",e.allFalse="allFalse",e.allTrue="allTrue",e.custom="custom";}(qt||(qt={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.CallQandAA="CallQandAA",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags";}(Qt||(Qt={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache";}(Jt||(Jt={}));var Xt=n("ozJ0"),$t=n("9oEN"),Zt=function(){function e(){}return e.prototype.initialize=function(e){this.logger=e,this.logger.debug("Event Logging-Service initialized");},e.getInstance=function(){return this.instance;},e.prototype.event=function(e,t){Object($t.b)(Xt.a.Tracking,e,t);},e.prototype.customEvent=function(e,t,n){Object($t.b)(e,t,n);},e.instance=new e(),e;}();var Yt,en,tn=n("F/li"),nn=[Qt.AADTenant,Qt.Guest,Qt.Federated,Qt.FederatedConsumer,Qt.Bot,Qt.DisabledUser,Qt.DL,Qt.ModernGroup,Qt.PersonalContact,Qt.UserDefinedGroup,Qt.Pstn,Qt.CallQandAA,Qt.Room,Qt.TeamTags],rn=(Qt.AADTenant,Qt.Guest,Qt.Federated,Qt.FederatedConsumer,Qt.Bot,Qt.DisabledUser,Qt.DL,Qt.ModernGroup,Qt.PersonalContact,Qt.UserDefinedGroup,Qt.Pstn,(Yt={})[qt.callForwardGroupSelection]=[],Yt[qt.allTrue]=nn,Yt[qt.searchSuggestions]=nn,Yt[qt.searchResults]=[Qt.AADTenant,Qt.Guest,Qt.Federated,Qt.FederatedConsumer,Qt.Bot,Qt.DisabledUser,Qt.ModernGroup,Qt.PersonalContact,Qt.UserDefinedGroup,Qt.Pstn,Qt.CallQandAA],Yt[qt.addToTeam]=[Qt.AADTenant,Qt.Guest,Qt.Federated,Qt.FederatedConsumer,Qt.Bot,Qt.DisabledUser,Qt.Pstn],Yt[qt.newChat]=[Qt.AADTenant,Qt.Guest,Qt.Federated,Qt.FederatedConsumer,Qt.Bot,Qt.DisabledUser,Qt.ModernGroup,Qt.UserDefinedGroup,Qt.TeamTags,Qt.Room],Yt[qt.transfer]=[Qt.AADTenant,Qt.Guest,Qt.DisabledUser,Qt.DL,Qt.ModernGroup,Qt.PersonalContact,Qt.UserDefinedGroup,Qt.Pstn,Qt.CallQandAA],Yt[qt.addToCall]=[Qt.AADTenant,Qt.Guest,Qt.Bot,Qt.DisabledUser,Qt.UserDefinedGroup,Qt.Pstn],Yt[qt.addToChat]=[Qt.AADTenant,Qt.DL,Qt.Guest,Qt.Federated,Qt.FederatedConsumer,Qt.DisabledUser,Qt.TeamTags],Yt[qt.searchPeopleFilter]=[Qt.AADTenant,Qt.Guest,Qt.Federated,Qt.FederatedConsumer,Qt.Bot,Qt.DisabledUser,Qt.Pstn,Qt.TeamTags],Yt[qt.callRouting]=[Qt.AADTenant,Qt.Guest,Qt.Bot,Qt.DisabledUser,Qt.DL,Qt.PersonalContact,Qt.UserDefinedGroup,Qt.Pstn,Qt.CallQandAA],Yt[qt.delegationSelection]=[Qt.AADTenant],Yt[qt.presenceSettings]=[Qt.AADTenant,Qt.Guest,Qt.Federated,Qt.FederatedConsumer,Qt.PersonalContact,Qt.Pstn],Yt[qt.addToMeeting]=[Qt.AADTenant,Qt.Guest,Qt.Federated,Qt.FederatedConsumer,Qt.Bot,Qt.DisabledUser,Qt.DL,Qt.ModernGroup,Qt.PersonalContact,Qt.UserDefinedGroup,Qt.Pstn],Yt[qt.meetingSchedule]=[Qt.AADTenant,Qt.Guest,Qt.Federated,Qt.DL,Qt.ModernGroup,Qt.PersonalContact,Qt.Pstn],Yt[qt.addToSpeedDialOrContacts]=[Qt.AADTenant,Qt.Guest,Qt.Federated,Qt.FederatedConsumer,Qt.Bot,Qt.DisabledUser,Qt.PersonalContact,Qt.Pstn,Qt.CallQandAA],Yt[qt.atMention]=[Qt.AADTenant,Qt.Guest,Qt.Bot,Qt.Pstn],Yt[qt.orgChart]=[Qt.AADTenant,Qt.Guest,Qt.Pstn],Yt[qt.priorityContactsSelection]=[Qt.AADTenant,Qt.Federated,Qt.FederatedConsumer,Qt.Pstn],Yt[qt.taggedContactsSelection]=[Qt.AADTenant,Qt.Guest,Qt.DL,Qt.PersonalContact],Yt[qt.shareToTeams]=[Qt.AADTenant,Qt.Guest,Qt.Federated,Qt.FederatedConsumer,Qt.DisabledUser,Qt.PersonalContact,Qt.UserDefinedGroup],Yt[qt.escalateMessage]=[Qt.AADTenant],Yt[qt.allFalse]=[],Yt[qt.custom]=[],Yt),an=function an(e,t){return Object(o.flatten)(e.filter(function(e){var n=e[0];e[1];return n===t;}).map(function(e){e[0];return e[1];}));},on=((en={})[Jt.Substrate]=[Qt.AADTenant],en[Jt.AAD]=[Qt.Guest],en[Jt.IndexedDb]=[Qt.Federated,Qt.FederatedConsumer,Qt.Bot,Qt.Pstn],en[Jt.MiddleTier]=[],en[Jt.TopNCache]=[],function(){function e(e,t){this.includeFeatures=e,this.name=t,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeAADTenant=Object(o.includes)(e,Qt.AADTenant),this.includeGuest=Object(o.includes)(e,Qt.Guest),this.includeFederated=Object(o.includes)(e,Qt.Federated),this.includeFederatedConsumer=Object(o.includes)(e,Qt.FederatedConsumer),this.includeBot=Object(o.includes)(e,Qt.Bot),this.includeDisabledUser=Object(o.includes)(e,Qt.DisabledUser),this.includeDL=Object(o.includes)(e,Qt.DL),this.includeModernGroup=Object(o.includes)(e,Qt.ModernGroup),this.includePersonalContact=Object(o.includes)(e,Qt.PersonalContact),this.includeUserDefinedGroup=Object(o.includes)(e,Qt.UserDefinedGroup),this.includePstn=Object(o.includes)(e,Qt.Pstn),this.includeCallQandAA=Object(o.includes)(e,Qt.CallQandAA),this.includeRoom=Object(o.includes)(e,Qt.Room),this.includeTeamTags=Object(o.includes)(e,Qt.TeamTags);}return e.fromName=function(t,n){if(void 0===n&&(n=[]),!(t in rn))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");var r=an(n,!0),i=an(n,!1);return new e(o.without.apply(null,Object(a.__spreadArrays)([Object(o.concat)(rn[t],r)],i)),t);},e.createFrom=function(t,n,r){return new e(n||t.includeFeatures,r||t.name);},e.includesAll=function(e,t){return Object(o.every)(t,function(t){return Object(o.includes)(e.includeFeatures,t);});},e.includesAny=function(e,t){return Object(o.some)(t,function(t){return Object(o.includes)(e.includeFeatures,t);});},e;}()),sn=tn.c*tn.d*16,cn=2*tn.a*tn.b*tn.c*tn.d,ln=function(){function e(){}return e.isUnknownUser=function(e){return"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email;},e.getRequestCount=function(e){return e&&e.requestCount||e.$$requestCount||0;},e.sanitizeUserProfileObject=function(e){if(!e)throw new Error("Invalid user profile object passed");var t=Object(a.__assign)({isSelf:void 0,managerLevel:void 0},e);t.isSelf,t.managerLevel,t.userClassification;return Object(a.__rest)(t,["isSelf","managerLevel","userClassification"]);},e.getCacheExpiryCallbackForUser=function(e,t){return void 0===t&&(t=null),function(n){if(n.isAnonymousUser)return 0;var r=n.skypeTeamsInfo&&n.skypeTeamsInfo.isSkypeTeamsUser;return e.enableNonTeamsUserShortCacheExpiry&&!r?sn:t||cn;};},e.sendTelemetryForIndexDBUnknownUser=function(e,t){var n,r;(e=Object(o.map)(e,function(e){return e.includes("temp_fed:")?"UnresolvedFederationUserMriLogText":e;}))&&e.length>0&&(n=H,r={errors:JSON.stringify([{unknownUserMris:e,callerInfo:t}])},Zt.getInstance().event(n,r));},e.isEnoughProfileInfoInCache=function(t,n){return t&&!e.isUnknownUser(t)&&(!n||n&&!Object(o.isUndefined)(t.isShortProfile)&&!t.isShortProfile);},e.addDescription=function(e,t){if(void 0===t&&(t=!1),!e.description&&!this.isBot(e)){var n=e.userPrincipalName.substr(0,e.userPrincipalName.indexOf("@")).toUpperCase();e.description=e.jobTitle?"("+n+") "+e.jobTitle:e.userType===z||t?e.email||e.userPrincipalName:n;}},e.addGuestIndicator=function(e,t){var n=t?t("Guest"):"Guest",r=e.guestlessDisplayName.indexOf(n);r>-1?e.guestlessDisplayName=e.guestlessDisplayName.substring(0,r).trimRight():(e.displayName=e.displayName+" "+n,e.givenName&&(e.guestGivenName=e.givenName+" "+n),e.surname&&(e.guestSurname=e.surname+" "+n));},e.addUserTypeInfo=function(e){e.type&&"ADUser"===e.type||"User"===e.objectType?(e.type=X.person,e.$$subType="ADUser"):e.type&&(e.$$subType=e.type);},e.addSkypeTeamsInfo=function(e,t){if(e){e.skypeTeamsInfo=e.skypeTeamsInfo||{isSkypeTeamsUser:!0};var n=t.sfb.testUsers,r=!n||n.indexOf(e.userPrincipalName)<0;e.skypeTeamsInfo.isSkypeTeamsUser=!!e.skypeTeamsInfo.isSkypeTeamsUser&&r;}},e.applyFeatureFlagSettings=function(e,t){var n=e.includeFeatures;switch(e.name){case qt.addToMeeting:case qt.meetingSchedule:t.enableFederatedUsersInMeetings||(n=Object(o.difference)(n,[Qt.Federated])),t.enableBotsInScheduledMeetings&&(n=Object(o.difference)(n,[Qt.Bot]));break;case qt.addToChat:t.enableFederatedUsersInAddToChat||(n=Object(o.difference)(n,[Qt.Federated])),t.enableDLsInAddToChat||(n=Object(o.difference)(n,[Qt.DL]));break;case qt.addToTeam:t.enableFederatedUsersInAddToTeam||(n=Object(o.difference)(n,[Qt.Federated]));break;case qt.addToSpeedDialOrContacts:t.enableFederatedUsersInAddToSpeedDialOrContacts||(n=Object(o.difference)(n,[Qt.Federated]));}return on.createFrom(e,n);},e.filterSearchResults=function(t,n,r){var i=n;return(t=e.applyFeatureFlagSettings(t,r)).includeFederated||(i=i.filter(function(t){return!e.isFederatedUser(t);})),t.includeGuest||(i=i.filter(function(t){return!e.isGuestUser(t);})),t.includeBot||(i=i.filter(function(t){return!e.isBot(t);})),t.includeDL||(i=i.filter(function(t){return!e.isDistributionList(t);})),t.includePstn||(i=i.filter(function(t){return!e.isPSTNUser(t);})),t.includeAADTenant||(i=i.filter(function(t){return!e.isInTenantUser(t);})),t.includeCallQandAA||(i=i.filter(function(t){return!e.isCallQorAAUser(t);})),i;},e.isFederatedUser=function(e){return!!e.isFederated;},e.isGuestUser=function(e){return e.type===z||e.userType===z;},e.isTFLUser=function(e){return e.type===J;},e.isInTenantUser=function(t){return!(t.type!==X.person&&"ADUser"!==t.type||e.isGuestUser(t)||t.isFederated);},e.isBot=function(e){var t;return(null===(t=e.type)||void 0===t?void 0:t.toUpperCase())===V;},e.isDistributionList=function(e){return e.type===q&&e.objectType===q;},e.isPSTNUser=function(e){return e.mri&&0===e.mri.indexOf("4:");},e.isSfcUser=function(e){return e.type===Q;},e.isCallQorAAUser=function(e){return e.type===W;},e.isTFLOffNetworkUser=function(e){return e.type===K;},e;}(),un=function(){function e(e){var t=this;this.send=e,this.MAX_PEOPLE_EMAIL_LIMIT=999,this.USERS_FETCH_URL_FORMAT="beta/users/fetch?isMailAddress={isMailAddress}&enableGuest=true&skypeTeamsInfo={skypeTeamsInfo}&canBeSmtpAddress={canBeSmtpAddress}",this.USERS_SEARCH_URL="beta/users/search",this.USERS_SEARCH_URL_V2="beta/users/searchV2",this.GET_USER_URL_FORMAT="beta/users/{upn}/?throwIfNotFound=false&isMailAddress={isMailAddress}&enableGuest=true",this.GET_GROUP_USER_URL_FORMAT="beta/teams/{officeGroupId}/officeGroup",this.PROCESSING_INTERVAL=50,this.MAX_BATCH_REQUESTS=500,this.MAX_PEOPLE_MRI_LIMIT=999,this.batchQueueMri=new Kt(function(e){return t.onBatchQueueMriReady(e);},this.PROCESSING_INTERVAL,this.MAX_BATCH_REQUESTS),this.batchQueueEmail=new Kt(function(e){return t.onBatchQueueEmailReady(e);},this.PROCESSING_INTERVAL,this.MAX_BATCH_REQUESTS);}return e.prototype.getPeopleProfilesByMri=function(e){if(!e)return Promise.reject("Invalid mri");var t=e;if(G(t)){var n=x(t);return Promise.resolve(this.generatePstnProfile(t,n));}return this.batchQueueMri.submit(e);},e.prototype.generatePstnProfile=function(e,t){return{mri:e,displayName:t,givenName:t,surname:"",userPrincipalName:e,accountEnabled:!1};},e.prototype.getPeopleProfilesByEmail=function(e){return e?this.batchQueueEmail.submit(e):Promise.reject("Invalid email");},e.prototype.getPeopleProfilesByMris=function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n=!1),Object(a.__awaiter)(this,void 0,Promise,function(){var r,i,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e.length>this.MAX_PEOPLE_MRI_LIMIT)throw Object(I.a)("PeopleService",g.c.MaxLimitReached,"getPeopleProfilesByMris",void 0,"Max allowed mriList size = "+this.MAX_PEOPLE_MRI_LIMIT);return r=this.USERS_FETCH_URL_FORMAT.replace("{isMailAddress}","false").replace("{skypeTeamsInfo}",t?"true":"false").replace("{canBeSmtpAddress}",n?"true":"false"),[4,this.post(r,e,"getPeopleProfilesByMris")];case 1:return i=a.sent(),o=new Map(),i&&i.map(function(e){return o.set(e.mri,e);}),[2,o];}});});},e.prototype.getPeopleProfilesByEmails=function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n=!1),Object(a.__awaiter)(this,void 0,Promise,function(){var r,i,o;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e.length>this.MAX_PEOPLE_EMAIL_LIMIT)throw Object(I.a)("PeopleService",g.c.MaxLimitReached,"getPeopleProfilesByEmails",void 0,"Max allowed emailList size = "+this.MAX_PEOPLE_EMAIL_LIMIT);return r=this.USERS_FETCH_URL_FORMAT.replace("{isMailAddress}","true").replace("{skypeTeamsInfo}",t?"true":"false").replace("{canBeSmtpAddress}",n?"true":"false"),[4,this.post(r,e,"getPeopleProfilesByEmails")];case 1:return i=a.sent(),o=new Map(),i&&i.map(function(e){return o.set(e.mail,e);}),[2,o];}});});},e.prototype.searchUsers=function(e,t,n,r,i,o,s){return void 0===r&&(r=on.fromName(qt.allTrue)),void 0===i&&(i=!0),void 0===o&&(o=!0),Object(a.__awaiter)(this,void 0,Promise,function(){var c,l,u,d,g;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return e.trim()?(c=Object(Vt.stringify)({includeDLs:r.includeDL,includeBots:r.includeBot,useGraphRelevance:i,skypeTeamsInfo:o,source:s}),l=n.get(p.a.Search).enablePeopleSearchV2,u=(l?this.USERS_SEARCH_URL_V2:this.USERS_SEARCH_URL)+"?"+c,[4,this.post(u,e,"searchUsers")]):[2,Promise.resolve([])];case 1:return d=a.sent(),g=new m.a(t),[2,ln.filterSearchResults(r,d,g)];}});});},e.prototype.getUser=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!0),Object(a.__awaiter)(this,void 0,Promise,function(){var r;return Object(a.__generator)(this,function(i){return r=this.GET_USER_URL_FORMAT.replace("{upn}",e).replace("{isMailAddress}",t?"true":"false").replace("{skypeTeamsInfo}",n?"true":"false"),[2,this.get(r,"getUser")];});});},e.prototype.getOfficeGroup=function(e){return Object(a.__awaiter)(this,void 0,Promise,function(){var t,n;return Object(a.__generator)(this,function(r){switch(r.label){case 0:return t=this.GET_GROUP_USER_URL_FORMAT.replace("{officeGroupId}",e),[4,this.getRaw(t,"getOfficeGroup").then(function(e){return e.body.json();})];case 1:return n=r.sent(),[2,Promise.resolve(n)];}});});},e.prototype.onBatchQueueMriReady=function(e){return this.getPeopleProfilesByMris(e).then(function(t){return e.map(function(e){return t.get(e);});});},e.prototype.onBatchQueueEmailReady=function(e){return this.getPeopleProfilesByEmails(e).then(function(t){return e.map(function(e){return t.get(e);});});},e.prototype.postRaw=function(e,t,n){return this.send({url:e,method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json;charset=UTF-8"},serviceName:zt.a.MiddleTier,apiName:n});},e.prototype.post=function(e,t,n){return this.postRaw(e,t,n).then(function(e){return e.body.json();}).then(function(e){return e.value;});},e.prototype.getRaw=function(e,t){return this.send({url:e,method:"GET",serviceName:zt.a.MiddleTier,apiName:t});},e.prototype.get=function(e,t){return this.getRaw(e,t).then(function(e){return e.body.json();}).then(function(e){return e.value;});},e;}();function dn(e,t,n,r,i,a,o,s,c,l,u,d){var g=new xt.a(t.bind(o,p.b.Gtm.chatService),i,l),m=new Ht.a(e,l,i,o,d),h=new un(t.bind(o,p.b.Gtm.middleTier));return{authenticationService:e,conversationManager:s,coreSettings:i,discover:n,getChatService:function getChatService(){return Promise.resolve(g);},getCSAService:function getCSAService(){return Promise.resolve(m);},getPeopleService:function getPeopleService(){return Promise.resolve(h);},loggerFactory:a,longPollEventPublisher:c,settingsService:r,user:u};}var pn,gn,mn,hn=n("O9iK");!function(e){e.inMemory="inMemory",e.indexedDB="indexedDB",e.network="network";}(pn||(pn={})),function(e){e[e.Sync=1]="Sync",e[e.LongPoll=2]="LongPoll",e[e.SfB=3]="SfB",e[e.SyncRelated=4]="SyncRelated",e[e.Local=5]="Local",e[e.CSAReplyChain=6]="CSAReplyChain",e[e.DeltaSync=7]="DeltaSync";}(gn||(gn={})),function(e){e[e.Sending=0]="Sending",e[e.Delivered=1]="Delivered",e[e.Received=2]="Received",e[e.Error=3]="Error",e[e.Deleted=4]="Deleted";}(mn||(mn={}));var fn,vn,bn=function(){function e(t){this.id=t.id,this.conversationId=t.conversationId,this.parentMessageId=t.parentMessageId,this.clientMessageId=t.clientMessageId,this.sequenceId=t.sequenceId||0,this.version=t.version,this.type=t.type||"",this.contentType=t.contentType||"",this.activityType=t.activityType||"",this.messageType=t.messageType,this.clientArrivalTime=t.clientArrivalTime,this.originalArrivalTime=t.originalArrivalTime,this.imDisplayName=t.imDisplayName,this.creator=t.creator,this.skypeGuid=t.skypeGuid,this.properties=t.properties||{},this.source=t.source,this._content=t.content,this._isSanitized=t.isSanitized,this.translation=t.translation,this.state=t.state,this.searchKey=e.createSearchKey(t.conversationId,t.id),this.dedupeKey=t.dedupeKey||this.creator+"_"+(this.clientMessageId||this.id),this.originalNonLieMessage=t.originalNonLieMessage;}return e.createSearchKey=function(e,t){return e+"_"+t;},e.FromChatServiceMessage=function(t,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=mn.Delivered);var s=Object(a.__assign)(Object(a.__assign)({},t),{conversationId:e.getConversationId(t),parentMessageId:e.getParentMessageId(t),clientMessageId:t.clientmessageid||"",sequenceId:t.sequenceId||0,imDisplayName:t.imdisplayname||"",creator:Object(o.last)(Object(o.split)(t.from,"/"))||"",messageType:t.messagetype,contentType:t.contenttype||"",activityType:t.activitytype||"",skypeGuid:t.skypeguid,originalArrivalTime:e.getOriginalArrivaTimeUtc(t.originalarrivaltime),source:n,clientArrivalTime:Date.now(),dedupeKey:"",searchKey:e.createSearchKey(e.getConversationId(t),t.id),state:i,isSanitized:r});return new e(s);},e.shouldUseExistingMessage=function(e,t){return(!e.isClientLie||!t.isClientLie||e.state!==mn.Sending||t.state!==mn.Error)&&!(e.sequenceId<t.sequenceId)&&e.version>=t.version;},e.FromCSAMessage=function(t){var n=Object(a.__assign)(Object(a.__assign)({},t),{conversationId:t.containerId,originalArrivalTime:e.getOriginalArrivaTimeUtc(t.originalArrivalTime),parentMessageId:t.parentMessageId||t.id,sequenceId:t.sequenceId||0,source:gn.CSAReplyChain,creator:t.from,version:t.version.toString(),clientArrivalTime:Date.now(),dedupeKey:"",searchKey:e.createSearchKey(t.containerId,t.id),isSanitized:!1,state:mn.Delivered});return new e(n);},e.isClientLieId=function(t){return t===e.ClientLieId||Object(o.startsWith)(t,e.ClientLiePrefix);},e.getParentMessageId=function(t){var n=Object(o.flow)(function(e){return Object(o.split)(e,"/");},function(e){return Object(o.last)(e);},function(e){return Object(o.split)(e,"=");},function(e){return Object(o.nth)(e,1);})(t.conversationLink);return n=n||t.id,e.isClientLieId(n)?e.ClientLieId:n;},e.getConversationId=function(e){return Object(o.flow)(function(e){return Object(o.split)(e,"/");},function(e){return Object(o.last)(e);},function(e){return Object(o.split)(e,";");},function(e){return Object(o.first)(e);})(e.conversationLink)||"";},e.getOriginalArrivaTimeUtc=function(e){return e?new Date(e).getTime():-1;},Object.defineProperty(e.prototype,"key",{get:function get(){return this.dedupeKey;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSanitized",{get:function get(){return this._isSanitized;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function get(){return this._content;},enumerable:!0,configurable:!0}),e.prototype.sanitizeContent=function(e){if(this.shouldSkipSanitization())this._isSanitized=!0;else{var t=this.content;this.messageType!==v.l.HTML||this.isGatewayChatMessage||(t="<div>"+t+"</div>"),t=(t=e.sanitizeHtml(t)).replace(/}}/g,"}<span>}</span>"),this._content=t,this._isSanitized=!0;}},Object.defineProperty(e.prototype,"isEdited",{get:function get(){return!!this.properties[v.k.EditTime];},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editedTime",{get:function get(){return this.isEdited?Number(this.properties[v.k.EditTime]):void 0;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDeleted",{get:function get(){return!!this.properties[v.k.DeleteTime];},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deletedTime",{get:function get(){return this.isDeleted?Number(this.properties[v.k.DeleteTime]):void 0;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClientLie",{get:function get(){return this.id===e.ClientLieId;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEditClientLie",{get:function get(){return this.isEdited&&this.source===gn.Local;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGatewayChatMessage",{get:function get(){return e=this.conversationId,t=Object(o.endsWith)(e,v.g)||Object(o.endsWith)(e,v.f)||Object(o.startsWith)(e,v.n),n=e.endsWith(v.t),r=T(e),t||n||r;var e,t,n,r;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSystemMessage",{get:function get(){return Object(o.includes)(v.B,this.messageType);},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRootMessage",{get:function get(){return this.id===this.parentMessageId;},enumerable:!0,configurable:!0}),e.prototype.isSentByUser=function(e){return this.creator===e;},e.prototype.toDBSchema=function(){return{id:this.id,dedupeKey:this.dedupeKey,conversationId:this.conversationId,parentMessageId:this.parentMessageId,clientMessageId:this.clientMessageId,sequenceId:this.sequenceId,version:this.version,searchKey:this.searchKey,type:this.type,contentType:this.contentType,activityType:this.activityType,messageType:this.messageType,clientArrivalTime:this.clientArrivalTime,originalArrivalTime:this.originalArrivalTime,imDisplayName:this.imDisplayName,creator:this.creator,content:this.content,source:this.source,properties:this.properties,skypeGuid:this.skypeGuid,translation:this.translation,isSanitized:this.isSanitized,originalNonLieMessage:this.originalNonLieMessage,state:this.state};},e.prototype.toLegacySchema=function(){var t=this.content,n=this.messageType,r=!1;this.isSanitized&&n===v.l.Text&&(t="<div>"+Object(o.escape)(t)+"</div>",n=v.l.HTML,r=!0);var i=e.isClientLieId(this.parentMessageId)?""+e.ClientLiePrefix+this.clientMessageId:this.parentMessageId,a="conversation/"+this.conversationId+";messageid="+i,s=this.source===gn.DeltaSync?gn.Sync:this.source;return{content:t,messagetype:n,contenttype:this.contentType,activitytype:this.activityType,clientmessageid:this.clientMessageId,sequenceId:this.sequenceId,imdisplayname:this.imDisplayName,properties:this.properties,id:this.id,type:this.type,composetime:new Date(this.originalArrivalTime).toISOString(),originalarrivaltime:new Date(this.originalArrivalTime).toISOString(),from:"worker/"+this.creator,conversationLink:a,version:this.version,threadtype:"",skypeguid:this.skypeGuid,clientArrivalTime:new Date(this.clientArrivalTime).toISOString(),source:s,isSanitized:this.isSanitized,isPlainTextConvertedToHtml:r,state:this.state};},e.prototype.revertEditLieToOriginalMessage=function(){return!!this.originalNonLieMessage&&(this._content=this.originalNonLieMessage.content,this.translation=this.originalNonLieMessage.translation,this.properties[v.k.EditTime]=this.originalNonLieMessage.editTimeProperty,this.state=mn.Delivered,!0);},e.prototype.resolveEditLieContent=function(){return this.originalNonLieMessage=void 0,this.state=mn.Delivered,!0;},e.prototype.copyExistingEditClientLie=function(e){this.originalNonLieMessage=e.originalNonLieMessage,this._content=e.content,this.translation=e.translation,this.state=e.state,this.properties[v.k.EditTime]=e.properties[v.k.EditTime];},e.prototype.shouldSkipSanitization=function(){return Object(o.isEmpty)(this.content)||this.isSanitized||this.isSystemMessage||this.messageType===v.l.Text||this.messageType===v.l.Call||this.messageType===v.l.CallRecording;},e.ClientLieId="-1",e.ClientLiePrefix="clientId_",e;}(),yn=function(){function e(t){var n=this;if(this.latestDeliveryTime=0,this.messageMap={},this.messageSearchKeys=[],Object(o.isEmpty)(t))throw new Error("Empty Object - cannot create a replychain");if(e.isDBSchema(t))this.replyChainId=t.replyChainId,this.conversationId=t.conversationId,this.latestDeliveryTime=t.latestDeliveryTime,this.messageSearchKeys=t.messageSearchKeys,this.lastUpdatedBy=t.lastUpdatedBy,Object(o.forEach)(t.messageMap,function(e,t){n.messageMap[t]=new bn(e);});else{var r=t.messages;if(Object(o.isEmpty)(r))throw new Error("Must pass at least one message to build a reply chain");this.replyChainId=r[0].parentMessageId,this.conversationId=r[0].conversationId,r=Object(o.sortBy)(r,function(e){return e.originalArrivalTime;}),this.messageMap=Object(o.keyBy)(r,function(e){return e.key;}),this.lastUpdatedBy=t.source,this.updateSearchKeysAndLatestDeliveryTime();}}return e.isDBSchema=function(e){return"replyChainId"in e&&"conversationId"in e;},e.fromSkypeMessages=function(t,n){if(Object(o.isEmpty)(t))throw new Error("SkypeReplyChainCDL - fromSkypeMessages: Need at least one message to create a SkypeReplyChain");return Object(o.flow)(function(e){return Object(o.map)(e,function(e){return bn.FromChatServiceMessage(e,n,!1,e.state);});},function(e){return Object(o.groupBy)(e,function(e){return e.parentMessageId;});},function(t){return Object(o.map)(t,function(t){return new e({messages:t,source:n});});})(t);},e.fromCSAReplyChain=function(t){if(Object(o.isEmpty)(t))throw new Error("SkypeReplyChainCDL - fromCSAReplyChain: CSA replychain is empty");var n=gn.CSAReplyChain,r=Object(o.flow)(function(e){return Object(o.map)(e,function(e){return bn.FromCSAMessage(e);});},function(e){return Object(o.groupBy)(e,function(e){return e.parentMessageId;});},function(t){return Object(o.map)(t,function(t){return new e({messages:t,source:n});});})(t.messages);return Object(o.first)(r);},e.getClientLieDBKey=function(e){return[e,bn.ClientLieId];},e.getClientLieKey=function(t){return e.getClientLieDBKey(t).toString();},e.isRootPresent=function(e){return Object(o.some)(e.messageMap,function(t){return t.id===e.replyChainId;});},Object.defineProperty(e.prototype,"id",{get:function get(){return this.replyChainId;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function get(){return this.dbKey.toString();},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dbKey",{get:function get(){return[this.conversationId,this.replyChainId];},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClientLieReplyChain",{get:function get(){return this.id===bn.ClientLieId;},enumerable:!0,configurable:!0}),e.prototype.sanitizeContent=function(e){Object(o.forEach)(this.messageMap,function(t){return t.sanitizeContent(e);});},Object.defineProperty(e.prototype,"messages",{get:function get(){return Object(o.values)(this.messageMap);},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSanitized",{get:function get(){return Object(o.every)(this.messages,function(e){return e.isSanitized;});},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"earliestMessage",{get:function get(){return this.hasMessages()?Object(o.minBy)(this.messages,function(e){return e.originalArrivalTime;}):void 0;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latestMessage",{get:function get(){return this.hasMessages()?Object(o.maxBy)(this.messages,function(e){return e.originalArrivalTime;}):void 0;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentMessage",{get:function get(){return this.hasMessages()?Object(o.find)(this.messages,function(e){return e.id===e.parentMessageId;}):void 0;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"messageCount",{get:function get(){return Object(o.size)(this.messageMap);},enumerable:!0,configurable:!0}),e.prototype.hasMessage=function(e){return e in this.messageMap;},e.prototype.hasMessages=function(){return this.messageCount>0;},e.prototype.getMessage=function(e){return this.messageMap[e];},e.prototype.merge=function(e){var t=this,n=[];return Object(o.forEach)(e.messageMap,function(e,r){var i=t.messageMap[r],a=t.mergeMessages(i,e);a!==i&&(n.push(a.id),t.messageMap[r]=a);}),this.updateSearchKeysAndLatestDeliveryTime(),this.lastUpdatedBy=e.lastUpdatedBy,{replyChain:this,updatedMessageIds:n};},e.prototype.deleteMessages=function(e){var t=this,n=0;return Object(o.forEach)(Object(o.keys)(this.messageMap),function(r){e(t.messageMap[r])&&(delete t.messageMap[r],n++);}),n>0&&this.updateSearchKeysAndLatestDeliveryTime(),n;},e.prototype.toDBSchema=function(){var e={};return Object(o.forEach)(this.messageMap,function(t,n){e[n]=t.toDBSchema();}),{conversationId:this.conversationId,replyChainId:this.replyChainId,latestDeliveryTime:this.latestDeliveryTime,messageMap:e,messageSearchKeys:this.messageSearchKeys,lastUpdatedBy:this.lastUpdatedBy};},e.prototype.toLegacySchema=function(){var e=Object(o.map)(this.messages,function(e){return e.toLegacySchema();});return{conversationId:this.conversationId,replyChainId:this.replyChainId,latestDeliveryTime:this.latestDeliveryTime,messages:e};},e.prototype.tryResolveClientLie=function(e){if(!this.isClientLieReplyChain||!e.isRootMessage||!this.hasMessage(e.key))return!1;var t=Object(o.sortBy)(this.messages,function(e){return e.originalArrivalTime;}),n=Object(o.findIndex)(t,function(t){return t.key===e.key;});return Object(o.forEach)(t,function(t,r){Object(o.set)(t,"originalArrivalTime",e.originalArrivalTime+r-n);}),this.deleteMessages(function(t){return t.key===e.key;}),!0;},e.prototype.revertEditClientLie=function(e){var t=this.getMessage(e.key);return!(!t||!t.isEditClientLie)&&t.revertEditLieToOriginalMessage();},e.prototype.resolveEditClientLie=function(e){var t=this.getMessage(e.key);return!(!t||!t.isEditClientLie)&&t.resolveEditLieContent();},e.prototype.updateSearchKeysAndLatestDeliveryTime=function(){this.messageSearchKeys=Object(o.map)(this.messageMap,function(e){return e.searchKey;});var e=this.latestMessage,t=this.getLatestNonDeletedMessage();this.latestDeliveryTime=t?t.originalArrivalTime:e?e.originalArrivalTime:0;},e.prototype.getLatestNonDeletedMessage=function(){return this.hasMessages()?Object(o.maxBy)(Object(o.filter)(this.messageMap,function(e){return!e.isDeleted;}),function(e){return e.originalArrivalTime;}):void 0;},e.prototype.mergeMessages=function(e,t){return e?bn.shouldUseExistingMessage(e,t)?e:(t.isDeleted||t.isEdited||(t.translation=e.translation),t.isEditClientLie&&e.isEditClientLie&&e.originalNonLieMessage?t.originalNonLieMessage=e.originalNonLieMessage:t.isEditClientLie?t.originalNonLieMessage={content:e.content,translation:e.translation,editTimeProperty:e.properties[v.k.EditTime]}:e.isEditClientLie&&e.originalNonLieMessage&&t.copyExistingEditClientLie(e),t):t;},e;}();!function(e){e.LoadAll="LOAD_ALL",e.LoadNone="LOAD_NONE",e.Custom="CUSTOM";}(fn||(fn={})),function(e){e.CleanupInactive="CLEANUP_INACTIVE";}(vn||(vn={}));var Sn;!function(e){e.latestDeliveryTimeByConversationId="latestDeliveryTimeByConversationId",e.byMessageSearchKeys="byMessageSearchKeys";}(Sn||(Sn={}));fn.LoadAll,fn.LoadAll;var Cn,On=function(){function e(e){var t=this;this._subscriptionObservers=[],this.storeObservables={},e.forEach(function(e){t.storeObservables[e.name]={subscriptionObservers:[],observable:new s(function(n){t.storeObservables[e.name].subscriptionObservers.push(n),t.replayEventsForNewSubscriber(e.name,n);}),isDone:!1,lastError:void 0,nextStatesSeen:[],dependentOn:e.dependentOn};}),this._observable=new s(function(e){t._subscriptionObservers.push(e);});}return e.prototype.subscribe=function(e,t,n,r){return this.checkStoreName(e),this.storeObservables[e].observable.subscribe({next:t,error:n,complete:r});},e.prototype.changeState=function(e,t,n){this.checkStoreName(e);var r=this.storeObservables[e].subscriptionObservers;if(r&&r.length&&r.forEach(function(e){e.next(t);}),this.storeObservables[e].nextStatesSeen.push(t),t===n)this.complete(e);else{var i=!0;Object(o.forEach)(this.storeObservables,function(e){var n=Object(o.last)(e.nextStatesSeen);(void 0===n||n<t)&&(i=!1);}),i&&Object(o.forEach)(this._subscriptionObservers,function(e){return e.next(t);});}},e.prototype.getDependentStore=function(e){return this.storeObservables[e]&&this.storeObservables[e].dependentOn;},Object.defineProperty(e.prototype,"observable",{get:function get(){return this._observable;},enumerable:!0,configurable:!0}),e.prototype.error=function(e,t){if((r=t)&&void 0!==r.target&&void 0!==r.target.error){var n=t.target.error;t=Object(I.a)("transaction",g.c.WriteToStoreFailed,n&&n.message||"",void 0,Object(I.b)(n));}var r;this.checkStoreName(e);var i=this.storeObservables[e].subscriptionObservers;i&&i.length&&i.forEach(function(e){e.error(t);}),this.storeObservables[e].lastError=t,this.storeObservables[e].isDone=!0,Object(o.forEach)(this._subscriptionObservers,function(e){return e.error(t);});},e.convertObservableToPromise=function(e,t){return new Promise(function(n,r){e.subscribe({next:function next(e){e===t&&n();},error:function error(e){r(e);},complete:function complete(){n();}});});},e.prototype.replayEventsForNewSubscriber=function(e,t){Object(o.forEach)(this.storeObservables[e].nextStatesSeen,function(e){t.next(e);}),this.storeObservables[e].lastError&&t.error(this.storeObservables[e].lastError),this.storeObservables[e].isDone&&t.complete();},e.prototype.complete=function(e){this.storeObservables[e].isDone=!0;var t=this.storeObservables[e].subscriptionObservers;t&&t.length&&t.forEach(function(e){e.complete();});var n=!0;for(var r in this.storeObservables){this.storeObservables[r]&&(n=n&&this.storeObservables[r].isDone&&!this.storeObservables[r].lastError);}n&&Object(o.forEach)(this._subscriptionObservers,function(e){return e.complete();});},e.prototype.checkStoreName=function(e){if(!e||!this.storeObservables[e])throw TypeError("Store name not found in transactions. Name: "+e);},e;}();!function(e){e.MemoryCommitted="MEMORY_COMMITTED",e.DiskCommitted="DISK_COMMITTED";}(Cn||(Cn={}));var _n,Tn,Mn;!function(e){e[e.inMemory=0]="inMemory",e[e.indexedDB=1]="indexedDB",e[e.Network=2]="Network";}(_n||(_n={})),function(e){e[e.InsideSyncWindow=0]="InsideSyncWindow",e[e.OutsideSyncWindow=1]="OutsideSyncWindow";}(Tn||(Tn={})),function(e){e[e.MessageId=1]="MessageId",e[e.ReplyChainId=2]="ReplyChainId",e[e.TimeRange=3]="TimeRange",e[e.ClientLies=4]="ClientLies";}(Mn||(Mn={}));var An=function An(e){if(["NewMessage","MessageUpdate"].indexOf(e.resourceType)>-1){var t=e.resource;return!!t.messagetype&&(-1!==t.messagetype.indexOf("Control/")||t.messagetype===v.c.MemberConsumptionHorizonUpdate);}return"CustomUserProperties"===e.resourceType;},wn=function wn(e){return e;},In={Query:{graphqlStatus:function graphqlStatus(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,Promise.resolve({status:"success"})];});});},conversations:function conversations(e,t,n){var r=n.managers,i=n.loggingContext;return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return[4,r.conversationManager.getConversations(void 0,i)];case 1:return[2,e.sent()];}});});},legacyMessages:function legacyMessages(e,t,n){var r=t.convId,i=t.count,s=t.cursor,c=t.deeplinkMessageId,u=t.correlationId,d=t.includeLatestData,p=n.managers,g=n.workerBootstrapServices,m=n.loggingContext;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,h,v;return Object(a.__generator)(this,function(a){switch(a.label){case 0:e={conversationId:r,count:i,token:s,deeplinkMessageId:c,correlationId:u,includeLatestData:d},(t=g.newScenario(l.a.ReplyChainManagerGetReplyChains)).appendEventData({correlationId:u,message:c?"found_deeplink":"no_deeplink"}),a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,p.replyChainManager.getReplyChains(e,t,m)];case 2:return n=a.sent(),h=Object(o.flatMap)(n.replyChains,function(e){return Object(o.values)(e.messageMap);}),t.stop(),[2,{legacyMessages:Object(o.map)(h,function(e){return e.toLegacySchema();}),cursor:n.token,deeplinkReplyChainId:n.deeplinkReplyChainId,isLatestDataPending:n.isLatestDataPending,errorCode:n.errorCode,telemetryData:Dn(n.telemetryData)}];case 3:return v=a.sent(),t.fail({errors:v&&v.message}),[2,Promise.reject(v)];case 4:return Object(f.f)(r)||p.conversationManager.markConversationAsActive(r),[7];case 5:return[2];}});});},legacyMessagesByKeys:function legacyMessagesByKeys(e,t,n){var r=t.convId,i=t.keys,s=t.keyType,c=t.correlationId,u=t.includeLatestData,d=n.managers,p=n.workerBootstrapServices,g=n.loggingContext;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,m,h;return Object(a.__generator)(this,function(a){switch(a.label){case 0:e={conversationId:r,keys:i,keyType:s,correlationId:c,includeLatestData:u},(t=p.newScenario(l.a.ReplyChainManagerGetReplyChainsByKeys)).appendEventData({correlationId:c}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,d.replyChainManager.getReplyChainsByKeys(e,t,g)];case 2:return n=a.sent(),m=Object(o.flatMap)(n.replyChains,function(e){return Object(o.values)(e.messageMap);}),t.stop(),[2,{legacyMessages:Object(o.map)(m,function(e){return e.toLegacySchema();}),telemetryData:Dn(n.telemetryData),isLatestDataPending:n.isLatestDataPending,errorCode:n.errorCode}];case 3:return h=a.sent(),t.fail({errors:h&&h.message}),[2,Promise.reject(h)];case 4:return[2];}});});}},Mutation:{putConversations:function putConversations(e,t,n){var r=t.conversations,i=n.managers,s=n.workerBootstrapServices,c=n.loggingContext;return Object(a.__awaiter)(this,void 0,Promise,function(){var e,t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e=s.newScenario(l.a.PutConversationsResolver),!r||!r.length)return e.fail({message:"conversations param not provided"}),[2,Pn("PutConversations - conversations param not provided",c,s.logger)];t=Object(o.forEach)(r,function(e){e.source=y.a.ResolverPutConversation;}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,i.conversationManager.putConversations(t,y.a.ResolverPutConversation,e,c)];case 2:return a.sent(),e.stop(),[2,!0];case 3:return n=a.sent(),e.fail({message:n&&n.message}),[2,Pn("PutConversations - errored out while putting conversations in the manager "+(n&&n.message),c,s.logger)];case 4:return[2];}});});},putLegacyMessages:function putLegacyMessages(e,t,n){var r=t.messages,i=t.correlationId,o=n.managers,s=n.workerBootstrapServices,c=n.loggingContext;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n;return Object(a.__generator)(this,function(a){switch(a.label){case 0:e=s.newScenario(l.a.PutLegacyMessagesResolver),i&&e.appendEventData({correlationId:i}),t=yn.fromSkypeMessages(r,y.c.Local),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,o.replyChainManager.handleSyncedReplyChains(t,e,c,void 0)];case 2:return a.sent(),e.stop(),[2,!0];case 3:return n=a.sent(),e.fail({message:n&&n.message}),[2,Pn("PutLegacyMessages - errored out while putting messages in the manager "+(n&&n.message),c,s.logger)];case 4:return[2];}});});},resolveEditClientLie:function resolveEditClientLie(e,t,n){var r=t.message,i=t.shouldResolve,o=t.correlationId,s=n.managers,c=n.workerBootstrapServices,u=n.loggingContext;return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,d;return Object(a.__generator)(this,function(a){switch(a.label){case 0:e=yn.fromSkypeMessages([r],y.c.Local)[0],t=c.newScenario(l.a.ResolveEditClientLieResolver),o&&t.appendEventData({correlationId:o}),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,s.replyChainManager.resolveOrRevertEditClientLie(e,i,t,u)];case 2:return n=a.sent(),t.stop(),[2,n];case 3:return d=a.sent(),t.fail({message:d&&d.message}),[2,Pn("resolveEditClientLie - errored out while trying to resolve client lie in the manager: "+(d&&d.message),u,c.logger)];case 4:return[2];}});});},removeConversations:function removeConversations(e,t,n){var r=t.conversationIds,i=n.managers,s=n.workerBootstrapServices,c=n.loggingContext;return Object(a.__awaiter)(this,void 0,Promise,function(){var e,t;return Object(a.__generator)(this,function(n){switch(n.label){case 0:if(!r||!r.length)return[2,Pn("removeConversations - conversationIds param not provided",c,s.logger)];n.label=1;case 1:return n.trys.push([1,3,,4]),e=Object(o.map)(r,function(e){return function(e,t,n){return Object(a.__awaiter)(this,void 0,Promise,function(){var r,i;return Object(a.__generator)(this,function(a){if(!e)throw new TypeError("SyncUtilities - missing conversationId to delete");return r=new On([{name:"conversations",dependentOn:"syncstates"},{name:"syncstates"}]),i=On.convertObservableToPromise(r.observable,Cn.MemoryCommitted),n.syncStateManager.deleteConversationSyncState(e,!1,r,t),n.conversationManager.removeConversations([e],r,t),[2,i];});});}(e,c,{conversationManager:i.conversationManager,syncStateManager:i.syncStateManager});}),[4,Promise.all(e)];case 2:return n.sent(),[2,!0];case 3:return[2,Pn("RemoveConversations - errored out while removing conversations: "+((t=n.sent())&&t.message),c,s.logger)];case 4:return[2];}});});}},Subscription:{conversationUpdateEvent:{subscribe:function subscribe(e,t,n){var r=n.managers,i=n.workerBootstrapServices;return Object(a.__asyncGenerator)(this,arguments,function(){var e,t,n,o,c,l,u,p;return Object(a.__generator)(this,function(g){switch(g.label){case 0:e=new s(function(e){r.conversationManager.subscribe(function(t){e.next(t);});}),g.label=1;case 1:g.trys.push([1,8,9,14]),t=Object(a.__asyncValues)(d(e,1e3,i.newScenario,"conversationUpdateEvent")),g.label=2;case 2:return[4,Object(a.__await)(t.next())];case 3:return(n=g.sent()).done?[3,7]:(o=n.value,c={conversationUpdateEvent:o},[4,Object(a.__await)(c)]);case 4:return[4,g.sent()];case 5:g.sent(),g.label=6;case 6:return[3,2];case 7:return[3,14];case 8:return l=g.sent(),u={error:l},[3,14];case 9:return g.trys.push([9,,12,13]),n&&!n.done&&(p=t.return)?[4,Object(a.__await)(p.call(t))]:[3,11];case 10:g.sent(),g.label=11;case 11:return[3,13];case 12:if(u)throw u.error;return[7];case 13:return[7];case 14:return[2];}});});}},legacyReplyChainUpdateEvent:{subscribe:function subscribe(e,t,n){var r=n.managers,i=n.workerBootstrapServices;return Object(a.__asyncGenerator)(this,arguments,function(){var e,t,n,o,c,l,u,p;return Object(a.__generator)(this,function(g){switch(g.label){case 0:e=new s(function(e){r.replyChainManager.subscribeToFilteredUpdates(function(t){e.next(t);});}),g.label=1;case 1:g.trys.push([1,8,9,14]),t=Object(a.__asyncValues)(d(e,1e3,i.newScenario,"legacyReplyChainUpdateEvent")),g.label=2;case 2:return[4,Object(a.__await)(t.next())];case 3:return(n=g.sent()).done?[3,7]:(o=n.value,c={legacyReplyChainUpdateEvent:{replyChain:o.replyChain.toLegacySchema(),updatedMessageIds:o.updatedMessageIds}},[4,Object(a.__await)(c)]);case 4:return[4,g.sent()];case 5:g.sent(),g.label=6;case 6:return[3,2];case 7:return[3,14];case 8:return l=g.sent(),u={error:l},[3,14];case 9:return g.trys.push([9,,12,13]),n&&!n.done&&(p=t.return)?[4,Object(a.__await)(p.call(t))]:[3,11];case 10:g.sent(),g.label=11;case 11:return[3,13];case 12:if(u)throw u.error;return[7];case 13:return[7];case 14:return[2];}});});}},legacyChatServiceEvent:{subscribe:function subscribe(e,t,n){var r=n.longPollEventPublisher,i=n.workerBootstrapServices;return Object(a.__asyncGenerator)(this,arguments,function(){var e,t,n,o,c,l,u,p,g;return Object(a.__generator)(this,function(m){switch(m.label){case 0:e=new s(function(e){r.subscribe(e,function(e){return An(e);});}),t=d(e,1e3,i.newScenario,"legacyChatServiceEvent"),m.label=1;case 1:m.trys.push([1,8,9,14]),n=Object(a.__asyncValues)(t),m.label=2;case 2:return[4,Object(a.__await)(n.next())];case 3:return(o=m.sent()).done?[3,7]:(c=o.value,(l=Object(a.__assign)({},c)).resource=JSON.stringify(l.resource),[4,Object(a.__await)({legacyChatServiceEvent:l})]);case 4:return[4,m.sent()];case 5:m.sent(),m.label=6;case 6:return[3,2];case 7:return[3,14];case 8:return u=m.sent(),p={error:u},[3,14];case 9:return m.trys.push([9,,12,13]),o&&!o.done&&(g=n.return)?[4,Object(a.__await)(g.call(n))]:[3,11];case 10:m.sent(),m.label=11;case 11:return[3,13];case 12:if(p)throw p.error;return[7];case 13:return[7];case 14:return[2];}});});}}}};function Pn(e,t,n){return t.component="ChatLegacyResolvers",n.error(e,t,g.c.InvalidInput),Promise.reject(e);}function jn(e){switch(e){case _n.inMemory:return r.DataSource.inMemory;case _n.indexedDB:return r.DataSource.indexedDB;case _n.Network:return r.DataSource.network;default:return null;}}function Dn(e){return{dataSource:jn(e.dataSource),isDBPrefetchRunning:e.isDBPrefetchRunning};}var En=n("XPgi");n.d(t,"resolvers",function(){return Gt;}),n.d(t,"context",function(){return dn;}),n.d(t,"IContext",function(){return hn.IContext;}),n.d(t,"chatLegacyResolvers",function(){return In;}),n.d(t,"legacyChatContext",function(){return wn;}),n.d(t,"ILegacyChatContext",function(){return En.IContext;});}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/data-resolvers-chat-93b9bb40ee5a52f6.js.map